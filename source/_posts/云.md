---
title: 云
url: cloud
date: 2022-03-11 10:12:00
description: cloud
categories: Computer Science
tags: [System]
password: initiate
---

云这个概念已经很多年了, 随着数据量暴增以及计算需求持续增长, 云的发展前景不可估量. 云服务涉及到很多概念: 计算, 存储, 安全, 网络. 每个概念又是非常庞大的体系, 本文旨在从宏观角度看看云的各种组件.

由于单机的存储容量和计算能力是非常有限的, 因此分布式系统成为了云平台的解决方案. 简单来讲, 需要将数据分割为若干小文件存储在不同的机器中, 同时记录文件与机器之间的映射关系. 计算时, 每台机器只负责处理单个文件, 最终将所有机器的计算结果合并. 这便是MapReduce的核心思想.

围绕上述问题, 又会衍生出若干具体的技术细节. 

## 文件应该存到哪台机器
文件与其存储位置的映射是基本问题, 该问题目前有2种主流解决方案.

 1. 使用控制服务器NameNode进行统一调度, 例如HDFS和GFS
 2. 客户端自行计算存储位置, 涉及hash一致性问题

由于不同node的能力不同, 因此可以设置权重使得能者多劳, 更大的node分配更多的partition, 保证partition分配的均衡.

为了保证安全性, 需要引入replica. 通常需要有3份冗余副本, 避免出现数据单点. 另外, 还要通过分区容错zone, 即对机器的物理隔离, replica不能放在同一个zone.

## 

第二个问题：多个控制服务谁是leader slave 分布式一致性协调选主
 1. 基于现有的分布式协调系统
 2. 基于Paxos Raft算法

第三个问题：文件直接映射到物理主机，迁移时数据IO都集中在2台主机，效率低
 1. 虚拟主机

四：文件太大导致存不下
 1. 分块存储

五：数据可靠性（不丢）数据可用性（可访问） 某台服务器坏了咋办 数据丢了 无法访问
 1. 冗余技术：纯副本或纠删码，纠删码恢复数据，避免浪费太多存储空间
 2. 副本写入方式：直接复制、链式复制
 3. 如何保证副本数据同步：一致性策略：强一致性模型、最终一致性模型 CAP权衡

六：节省空间：
 1. 压缩技术
 2. 避免存储重复文件：重删技术

七：集群彻底瘫痪
 1. 备份技术：拷贝到其他存储系统而非当前，拷贝到当前是副本技术 全量备份、增量备份
 2. 万一没有实时备份，集群挂了：容灾策略：异地同步技术

八：网络IO分配：QoS实现

九：版本控制：快照技术

## Spark
基于Scala开发，在内存中计算，提供了java/python/R等语言接口。

GFS -> HDFS 负责存储
MapReduce 负责计算分配
共同构成了Hadoop大数据批量处理结构

每个公司都需要自己的云, 尤其是一些比较敏感的客户信息, 更加需要建立自己的云
私有云: 花旗, 沃尔玛

硬件虚拟化 -> 不同的操作系统 -> 不同的服务器提供不同服务

cloud = cluster + grid

![在这里插入图片描述](https://img-blog.csdnimg.cn/030d0a8c7b694f8f82fa898a5bbb05fb.png)

Iaas可能负责一些维护迁移之类的工作, 弄不好成运维了, 硬件基本上是固定的
paas会涉及到系统编程
saas我理解就是应用程序开发了

## Reference
[云存储的底层关键技术有哪些](https://www.zhihu.com/question/25834847/answer/348271275)
