<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=2">
<meta name="theme-color" content="#222">
<meta name="generator" content="Hexo 6.0.0">
  <link rel="apple-touch-icon" sizes="180x180" href="/images/apple-touch-icon-next.png">
  <link rel="icon" type="image/png" sizes="32x32" href="/images/favicon.png">
  <link rel="icon" type="image/png" sizes="16x16" href="/images/favicon.png">
  <link rel="mask-icon" href="/images/logo.svg" color="#222">

<link rel="stylesheet" href="/css/main.css">


<link rel="stylesheet" href="/lib/font-awesome/css/all.min.css">

<script id="hexo-configurations">
    var NexT = window.NexT || {};
    var CONFIG = {"hostname":"eimadrigal.github.io","root":"/","scheme":"Gemini","version":"7.8.0","exturl":false,"sidebar":{"position":"left","display":"post","padding":18,"offset":12,"onmobile":false},"copycode":{"enable":false,"show_result":false,"style":null},"back2top":{"enable":true,"sidebar":false,"scrollpercent":false},"bookmark":{"enable":false,"color":"#222","save":"auto"},"fancybox":false,"mediumzoom":false,"lazyload":false,"pangu":false,"comments":{"style":"tabs","active":null,"storage":true,"lazyload":false,"nav":null},"algolia":{"hits":{"per_page":10},"labels":{"input_placeholder":"Search for Posts","hits_empty":"We didn't find any results for the search: ${query}","hits_stats":"${hits} results found in ${time} ms"}},"localsearch":{"enable":true,"trigger":"manual","top_n_per_article":1,"unescape":false,"preload":false},"motion":{"enable":true,"async":false,"transition":{"post_block":"fadeIn","post_header":"slideDownIn","post_body":"slideDownIn","coll_header":"slideLeftIn","sidebar":"slideUpIn"}},"path":"search.xml"};
  </script>

  <meta name="description" content="Hello World">
<meta property="og:type" content="website">
<meta property="og:title" content="EI Madrigal&#39;s Space">
<meta property="og:url" content="https://eimadrigal.github.io/page/2/index.html">
<meta property="og:site_name" content="EI Madrigal&#39;s Space">
<meta property="og:description" content="Hello World">
<meta property="og:locale" content="en_US">
<meta property="article:author" content="EIMadrigal">
<meta name="twitter:card" content="summary">

<link rel="canonical" href="https://eimadrigal.github.io/page/2/">


<script id="page-configurations">
  // https://hexo.io/docs/variables.html
  CONFIG.page = {
    sidebar: "",
    isHome : true,
    isPost : false,
    lang   : 'en'
  };
</script>

  <title>EI Madrigal's Space</title>
  






  <noscript>
  <style>
  .use-motion .brand,
  .use-motion .menu-item,
  .sidebar-inner,
  .use-motion .post-block,
  .use-motion .pagination,
  .use-motion .comments,
  .use-motion .post-header,
  .use-motion .post-body,
  .use-motion .collection-header { opacity: initial; }

  .use-motion .site-title,
  .use-motion .site-subtitle {
    opacity: initial;
    top: initial;
  }

  .use-motion .logo-line-before i { left: initial; }
  .use-motion .logo-line-after i { right: initial; }
  </style>
</noscript>

</head>

<body itemscope itemtype="http://schema.org/WebPage">
  <div class="container use-motion">
    <div class="headband"></div>

    <header class="header" itemscope itemtype="http://schema.org/WPHeader">
      <div class="header-inner"><div class="site-brand-container">
  <div class="site-nav-toggle">
    <div class="toggle" aria-label="Toggle navigation bar">
      <span class="toggle-line toggle-line-first"></span>
      <span class="toggle-line toggle-line-middle"></span>
      <span class="toggle-line toggle-line-last"></span>
    </div>
  </div>

  <div class="site-meta">

    <a href="/" class="brand" rel="start">
      <span class="logo-line-before"><i></i></span>
      <h1 class="site-title">EI Madrigal's Space</h1>
      <span class="logo-line-after"><i></i></span>
    </a>
  </div>

  <div class="site-nav-right">
    <div class="toggle popup-trigger">
        <i class="fa fa-search fa-fw fa-lg"></i>
    </div>
  </div>
</div>




<nav class="site-nav">
  <ul id="menu" class="main-menu menu">
        <li class="menu-item menu-item-home">

    <a href="/" rel="section"><i class="fa fa-home fa-fw"></i>Home</a>

  </li>
        <li class="menu-item menu-item-categories">

    <a href="/categories/" rel="section"><i class="fa fa-th fa-fw"></i>Categories</a>

  </li>
        <li class="menu-item menu-item-tags">

    <a href="/tags/" rel="section"><i class="fa fa-tags fa-fw"></i>Tags</a>

  </li>
        <li class="menu-item menu-item-archives">

    <a href="/archives/" rel="section"><i class="fa fa-archive fa-fw"></i>Archives</a>

  </li>
        <li class="menu-item menu-item-about">

    <a href="/about/" rel="section"><i class="fa fa-user fa-fw"></i>About</a>

  </li>
      <li class="menu-item menu-item-search">
        <a role="button" class="popup-trigger"><i class="fa fa-search fa-fw"></i>Search
        </a>
      </li>
  </ul>
</nav>



  <div class="search-pop-overlay">
    <div class="popup search-popup">
        <div class="search-header">
  <span class="search-icon">
    <i class="fa fa-search"></i>
  </span>
  <div class="search-input-container">
    <input autocomplete="off" autocapitalize="off"
           placeholder="Searching..." spellcheck="false"
           type="search" class="search-input">
  </div>
  <span class="popup-btn-close">
    <i class="fa fa-times-circle"></i>
  </span>
</div>
<div id="search-result">
  <div id="no-result">
    <i class="fa fa-spinner fa-pulse fa-5x fa-fw"></i>
  </div>
</div>

    </div>
  </div>

</div>
    </header>

    
  <div class="back-to-top">
    <i class="fa fa-arrow-up"></i>
    <span>0%</span>
  </div>


    <main class="main">
      <div class="main-inner">
        <div class="content-wrap">
          

          <div class="content index posts-expand">
            
      
  
  
  <article itemscope itemtype="http://schema.org/Article" class="post-block" lang="en">
    <link itemprop="mainEntityOfPage" href="https://eimadrigal.github.io/2021/09/11/%E4%BB%80%E4%B9%88%E6%98%AF%E6%B1%9F%E6%B9%96/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="image" content="/images/favicon.png">
      <meta itemprop="name" content="EIMadrigal">
      <meta itemprop="description" content="Hello World">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="EI Madrigal's Space">
    </span>
      <header class="post-header">
        <h2 class="post-title" itemprop="name headline">
          
            <a href="/2021/09/11/%E4%BB%80%E4%B9%88%E6%98%AF%E6%B1%9F%E6%B9%96/" class="post-title-link" itemprop="url">ä»€ä¹ˆæ˜¯æ±Ÿæ¹–</a>
        </h2>

        <div class="post-meta">

		  
            <span class="post-meta-item">
              <span class="post-meta-item-icon">
                <i class="far fa-calendar"></i>
              </span>
              <span class="post-meta-item-text">Posted on</span>

              <time title="Created: 2021-09-11 15:24:00" itemprop="dateCreated datePublished" datetime="2021-09-11T15:24:00+08:00">2021-09-11</time>
            </span>
            <span class="post-meta-item">
              <span class="post-meta-item-icon">
                <i class="far fa-folder"></i>
              </span>
              <span class="post-meta-item-text">In</span>
                <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
                  <a href="/categories/Life/" itemprop="url" rel="index"><span itemprop="name">Life</span></a>
                </span>
            </span>

          

        </div>
      </header>

    
    
    
    <div class="post-body" itemprop="articleBody">

      
          <p>ç¢ç¢å¿µ</p>
          <!--noindex-->
            <div class="post-button">
              <a class="btn" href="/2021/09/11/%E4%BB%80%E4%B9%88%E6%98%AF%E6%B1%9F%E6%B9%96/">
                Read more &raquo;
              </a>
            </div>
          <!--/noindex-->
        
      
    </div>

    
    
    
      <footer class="post-footer">
        <div class="post-eof"></div>
      </footer>
  </article>
  
  
  

      
  
  
  <article itemscope itemtype="http://schema.org/Article" class="post-block" lang="en">
    <link itemprop="mainEntityOfPage" href="https://eimadrigal.github.io/2021/08/30/How%20to%20Make%20Plans/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="image" content="/images/favicon.png">
      <meta itemprop="name" content="EIMadrigal">
      <meta itemprop="description" content="Hello World">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="EI Madrigal's Space">
    </span>
      <header class="post-header">
        <h2 class="post-title" itemprop="name headline">
          
            <a href="/2021/08/30/How%20to%20Make%20Plans/" class="post-title-link" itemprop="url">How to Make Plans</a>
        </h2>

        <div class="post-meta">

		  
            <span class="post-meta-item">
              <span class="post-meta-item-icon">
                <i class="far fa-calendar"></i>
              </span>
              <span class="post-meta-item-text">Posted on</span>

              <time title="Created: 2021-08-30 15:09:00" itemprop="dateCreated datePublished" datetime="2021-08-30T15:09:00+08:00">2021-08-30</time>
            </span>

          

        </div>
      </header>

    
    
    
    <div class="post-body" itemprop="articleBody">

      
          <p>å¦‚ä½•å¹³è¡¡å¥½ç§‘ç ”ã€è‡ªå­¦ã€ç”Ÿæ´»ï¼Ÿè¿™æ˜¯ä¸€ä¸ªéå¸¸é‡è¦çš„é—®é¢˜ï¼Œå…³ä¹æœªæ¥å‘å±•å’Œç”Ÿæ´»è´¨é‡ï¼Œå¹¶ä¸”éšç€å¹´é¾„å¢é•¿è¿™ä¸ªé—®é¢˜ä¼šå˜å¾—æ›´åŠ ä¸¥é‡ï¼Œå› ä¸ºæˆ‘ä»¬å°†è¦é¢ä¸´çš„ä¸–ç•Œä¼šæ›´åŠ çº·ç¹å¤æ‚ã€‚</p>
<p>è¦å¤„ç†å¥½è¿™ä¸ªé—®é¢˜å¹¶ä¸å®¹æ˜“ï¼Œç”šè‡³æœ‰äº›ç„å­¦ã€æœ‰äº›è‰ºæœ¯ã€‚æˆ‘ä¸ªäººè§‰å¾—è§£å†³è¿™ä¸ªé—®é¢˜çš„å…³é”®åœ¨äºè®¡åˆ’ï¼šåˆ¶å®šåˆç†çš„ã€å¯è¡Œçš„ã€æœ‰ä¾§é‡æ€§çš„ã€ä¸é‚£ä¹ˆæ­»æ¿ã€ä¹Ÿä¸é‚£ä¹ˆæ¾æ•£éšæ„çš„è®¡åˆ’ï¼Œè¿™å…¶ä¸­åŒ…æ‹¬é•¿æœŸè®¡åˆ’ã€ä¸­æœŸè®¡åˆ’å’ŒçŸ­æœŸè®¡åˆ’ï¼Œå¹¶ä¸”è¿˜è¦å­¦ä¼šå·§å¦™åˆ©ç”¨æ—¶é—´ã€‚</p>
<p>æˆ‘è‡ªå·±å°è¯•è¿‡å„ç§å„æ ·çš„è®¡åˆ’ï¼ŒåŒ…æ‹¬ä½†ä¸é™äºæŒ‰ç…§æ—¶é—´æ®µä¸¥æ ¼é™å®šä»»åŠ¡ã€æŒ‰ç…§ä»»åŠ¡è¿›å±•æ¾æ•£å‹ã€TODO Listç­‰ï¼ŒåŸºæœ¬éƒ½æ˜¯åšæŒä¸åˆ°2ç¤¼æ‹œå°±åºŸå¼ƒäº†ï¼Œè€Œä¸”ä¹Ÿæ²¡æœ‰è´¯å½»é•¿æœŸå’Œä¸­æœŸè®¡åˆ’ã€‚ <img src="https://img2020.cnblogs.com/blog/1260581/202112/1260581-20211223092219887-1893756805.png" alt="image" /></p>
<p>å¦‚æœçº¯ç²¹æŒ‰ç…§follow your heartå»æ’åºï¼Œé‚£ä¹ˆæ¯«æ— ç–‘é—®æ˜¯ç”Ÿæ´»&gt;è‡ªå­¦&gt;ç§‘ç ”ï¼Œä½†æ˜¯é—®é¢˜åœ¨äºéœ€è¦ä¿è¯ç§‘ç ”çš„æœ€ä½é™åº¦ï¼ˆå®ä¹ åŠæ¯•ä¸šï¼‰ï¼Œæ‰€ä»¥è®¡åˆ’åº”è¯¥æ€ä¹ˆå®šå‘¢ï¼Ÿ</p>
<ol type="1">
<li>é•¿æœŸè®¡åˆ’ï¼ˆ2021.7~2025.7ï¼‰ï¼šæ¯•ä¸šå·¥ä½œä¸¤å¹´ã€‚</li>
<li>ä¸­æœŸè®¡åˆ’ï¼ˆ2021.7~2023.7ï¼‰ï¼š</li>
<li>çŸ­æœŸè®¡åˆ’ï¼ˆæ¯æœˆæ¯å‘¨ï¼‰ï¼š</li>
</ol>
<p>æ ¸å¿ƒé—®é¢˜åœ¨äºï¼šè®¡åˆ’çš„ç›®çš„å¹¶ä¸åœ¨äº100%å®Œæˆï¼Œè¿™å¬èµ·æ¥å¯èƒ½æœ‰äº›è’è°¬ï¼Œè®¡åˆ’çš„çœŸæ­£ç›®çš„åœ¨äºä½¿ä½ æœ‰ä¸€ä¸ªä¸ºä¹‹åŠªåŠ›çš„ä¸œè¥¿ï¼Œå…¨èº«å¿ƒåœ°æŠ•å…¥åˆ°è¿™ä¸ªè¿‡ç¨‹ä¸­ï¼Œè‡ªç„¶è€Œç„¶æœ€åçš„ç»“æœä¹Ÿä¸ä¼šå¤ªå·®åŠ²ã€‚æ‰€ä»¥TODO Listä¸­çš„äº‹é¡¹æ²¡æœ‰å…¨éƒ¨åˆ’æ‰å¹¶ä¸å¯æ€•ï¼Œå®Œæˆ70%~80%è¶³çŸ£ã€‚å‰©ä¸‹æœªå®Œæˆçš„éƒ¨åˆ†è§†é‡è¦ç¨‹åº¦ä½œä¸ºä¸‹ä¸€é˜¶æ®µçš„é¦–å½“å…¶å†²çš„äº‹é¡¹ã€‚</p>
<p>è¾¾æˆç›®æ ‡æœ¬èº«å¹¶ä¸ä¼šæé«˜å¹¸ç¦æ°´å¹³çš„baselineï¼Œåªæ˜¯è®©è‡ªå·±future-oriented</p>
<h2 id="from-2021.11.23-to-2022.12.31">From 2021.11.23 To 2022.12.31</h2>
<p><strong>è¿™æ®µæ—¶é—´éå¸¸éå¸¸å…³é”®ï¼Œä¼šå†³å®šç¬¬ä¸€ä»½å·¥ä½œçš„å»å‘ï¼ï¼ï¼ç»å¯¹ä¸èƒ½æ¯å¤©æ¯ä¸ªå°æ—¶æµ‘æµ‘å™©å™©</strong></p>
<p>æœ¬è®¡åˆ’åŒ…æ‹¬é˜¶æ®µæ€§ç›®æ ‡å’ŒçŸ­æœŸè®¡åˆ’ä¸¤éƒ¨åˆ†ï¼Œä»åç«¯å¼€å‘ï¼ˆç³»ç»Ÿç¼–ç¨‹/äº‘è®¡ç®—ï¼‰çš„å²—ä½éœ€æ±‚å‡ºå‘è®¾è®¡ç›®æ ‡ï¼š</p>
<p>é˜¶æ®µæ€§ç›®æ ‡ä¸»è¦æ˜¯åœ¨ä»€ä¹ˆæ—¶é—´èŠ‚ç‚¹å®Œæˆä»€ä¹ˆäº‹æƒ…ï¼ŒçŸ­æœŸè®¡åˆ’ä¼šå…·ä½“åˆ°æ¯å¤©ç”šè‡³æ¯ä¸ªå°æ—¶çš„å®‰æ’ã€‚</p>

      
    </div>

    
    
    
      <footer class="post-footer">
        <div class="post-eof"></div>
      </footer>
  </article>
  
  
  

      
  
  
  <article itemscope itemtype="http://schema.org/Article" class="post-block" lang="en">
    <link itemprop="mainEntityOfPage" href="https://eimadrigal.github.io/2021/07/28/Inspiring%20Quotes/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="image" content="/images/favicon.png">
      <meta itemprop="name" content="EIMadrigal">
      <meta itemprop="description" content="Hello World">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="EI Madrigal's Space">
    </span>
      <header class="post-header">
        <h2 class="post-title" itemprop="name headline">
          
            <a href="/2021/07/28/Inspiring%20Quotes/" class="post-title-link" itemprop="url">Inspiring Quotes</a>
        </h2>

        <div class="post-meta">

		  
            <span class="post-meta-item">
              <span class="post-meta-item-icon">
                <i class="far fa-calendar"></i>
              </span>
              <span class="post-meta-item-text">Posted on</span>

              <time title="Created: 2021-07-28 02:57:00" itemprop="dateCreated datePublished" datetime="2021-07-28T02:57:00+08:00">2021-07-28</time>
            </span>

          

        </div>
      </header>

    
    
    
    <div class="post-body" itemprop="articleBody">

      
          <ol type="1">
<li>è¿˜å·®å¾—è¿œå‘¢ï¼ -ddd æ·±å¤œçœ‹åˆ°dddå¯¹2020å¹´åä¸ºè½¯ä»¶æ¯”èµ›çš„ç²¾å‡†<a target="_blank" rel="noopener" href="https://github.com/justarandomstring/2020-Huawei-Code-Craft">åˆ†æ</a>ï¼Œæ·±æ„Ÿè‡ªå·±å¹³æ—¥å®åœ¨å¤ªè¿‡è½»æ¾ã€‚</li>
<li>å¤©èµ‹æ¸¸æˆï¼Œé¥ä¸å¯åŠã€‚ ä¸€ä½è®¡ç®—æœºåŒå­¦çš„ä¸ªæ€§ç­¾åï¼Œæ·±æ„Ÿè‡ªå·±æ—©å·²ä¸å¯èƒ½æˆä¸ºæœ€é¡¶å°–çš„é‚£æ‰¹äººï¼Œå€Ÿæ­¤æ¥å®½æ…°é‡åˆ°éº»çƒ¦æ—¶çš„çª˜å¢ƒã€‚</li>
<li>æ‰€æœ‰çš„ä¼˜è¶Šæ„Ÿéƒ½æ˜¯å› ä¸ºæ²¡æœ‰è§è¯†ã€‚</li>
<li>æ·±å¤œé‡Œç¢°æ¯ï¼Œéƒ½æ˜¯æ¢¦ç ´ç¢çš„å£°éŸ³ã€‚</li>
<li>I'm tired of all those boring comparisons.</li>
<li>Missing your Vanilla Sky.</li>
<li>æ¶ˆå¤±åœ¨äººæµ·ã€‚</li>
</ol>

      
    </div>

    
    
    
      <footer class="post-footer">
        <div class="post-eof"></div>
      </footer>
  </article>
  
  
  

      
  
  
  <article itemscope itemtype="http://schema.org/Article" class="post-block" lang="en">
    <link itemprop="mainEntityOfPage" href="https://eimadrigal.github.io/2021/07/26/767%20Reorganize%20String/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="image" content="/images/favicon.png">
      <meta itemprop="name" content="EIMadrigal">
      <meta itemprop="description" content="Hello World">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="EI Madrigal's Space">
    </span>
      <header class="post-header">
        <h2 class="post-title" itemprop="name headline">
          
            <a href="/2021/07/26/767%20Reorganize%20String/" class="post-title-link" itemprop="url">767 Reorganize String</a>
        </h2>

        <div class="post-meta">

		  
            <span class="post-meta-item">
              <span class="post-meta-item-icon">
                <i class="far fa-calendar"></i>
              </span>
              <span class="post-meta-item-text">Posted on</span>

              <time title="Created: 2021-07-26 07:21:00" itemprop="dateCreated datePublished" datetime="2021-07-26T07:21:00+08:00">2021-07-26</time>
            </span>

          

        </div>
      </header>

    
    
    
    <div class="post-body" itemprop="articleBody">

      
          <p><a target="_blank" rel="noopener" href="https://leetcode.com/problems/reorganize-string/" title="é¢˜ç›®é“¾æ¥">é¢˜ç›®é“¾æ¥</a> ## é¢˜æ„ ç»™å®šå­—ç¬¦ä¸²ï¼Œé‡æ’å…¶ä¸­çš„å­—ç¬¦ä½¿å¾—ä»»æ„ä¸¤ä¸ªç›¸é‚»ä½ç½®çš„å­—æ¯ä¸åŒã€‚ æ ·ä¾‹ï¼šs="aab"ï¼Œè¾“å‡º"aba" ## åˆ†æ æœ€å¼€å§‹çš„æƒ³æ³•æ˜¯è´ªå¿ƒ+åŒæŒ‡é’ˆï¼ŒæŒ‡é’ˆiä»å‰å‘åéå†ï¼ŒæŒ‡é’ˆjä»i+1å¼€å§‹ï¼Œå¦‚æœs[i]==s[j]ï¼Œjä¸æ–­å‘åéå†æ‰¾åˆ°ç¬¬ä¸€ä¸ªä¸s[i]ä¸åŒçš„å­—æ¯s[k]ï¼Œå°†s[k]ä¸s[j]äº¤æ¢ã€‚WAåœ¨äº†"baaba"ï¼ŒæœŸå¾…"ababa"ï¼Œè¾“å‡º""ï¼Œæ‰€ä»¥è¿™ç§è´ªå¿ƒç­–ç•¥æ˜¾ç„¶æ˜¯é”™çš„ã€‚</p>
<p>æ¥ç€å°±æƒ³åˆ°éœ€è¦è€ƒè™‘å­—ç¬¦çš„å‡ºç°é¢‘ç‡ï¼Œå…ˆæŒ‰é¢‘ç‡é«˜ä½æ’åºå†å»æŒ‰ç…§ä¸Šè¿°è´ªå¿ƒï¼ŒWAåœ¨äº†"aabbcc"ï¼ŒæœŸå¾…"abacbc"ï¼Œè¾“å‡º""ï¼Œå¾ˆæ˜¾ç„¶è¿™ç§è´ªå¿ƒç­–ç•¥æœ¬èº«å°±æ˜¯é”™çš„ã€‚</p>
<p>æ¥ç€å°±æƒ³åˆ°å…ˆå®‰æ’å‡ºç°æ¬¡æ•°æœ€å¤šçš„ï¼Œå¦‚æœå½“å‰è¦å®‰æ’çš„ä¸å‰ä¸€ä¸ªå­—ç¬¦ç›¸åŒï¼Œå°±é€‰æ‹©å‡ºç°æ¬¡æ•°ç¬¬äºŒå¤šçš„ï¼Œè¿™æ ·äº¤æ›¿ä¸‹å»ï¼Œå¯ä»¥å†™å‡ºå¦‚ä¸‹ä»£ç ï¼š <figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br></pre></td><td class="code"><pre><span class="line">class Solution:</span><br><span class="line">    def reorganizeString(self, s: str) -&gt; str:</span><br><span class="line">        if len(s) == 1:</span><br><span class="line">            return s</span><br><span class="line"></span><br><span class="line">        from collections import Counter</span><br><span class="line">        dic = Counter(s)</span><br><span class="line"></span><br><span class="line">        ans = &quot;&quot;</span><br><span class="line">        prev = &quot;&quot;</span><br><span class="line">        for i in range(0, len(s)):</span><br><span class="line">            cnts = list(dic.items())</span><br><span class="line">            cnts = sorted(cnts, key=lambda x:x[1], reverse=True)</span><br><span class="line">            if prev == cnts[0][0]:</span><br><span class="line">                if len(cnts) &lt;= 1 or cnts[1][1] == 0:</span><br><span class="line">                    return &quot;&quot;</span><br><span class="line">                ans += cnts[1][0]</span><br><span class="line">                dic[cnts[1][0]] -= 1</span><br><span class="line">                prev = cnts[1][0]</span><br><span class="line">            else:</span><br><span class="line">                ans += cnts[0][0]</span><br><span class="line">                dic[cnts[0][0]] -= 1</span><br><span class="line">                prev = cnts[0][0]</span><br><span class="line">        return ans</span><br><span class="line"></span><br></pre></td></tr></table></figure> æ—¶é—´å¤æ‚åº¦<span class="math inline">\(O(n^2lgn)\)</span>ï¼Œç©ºé—´<span class="math inline">\(O(n)\)</span>ã€‚</p>
<p>å› ä¸ºæ¶‰åŠåˆ°å‡ºç°æ¬¡æ•°æœ€å¤šçš„é—®é¢˜ï¼Œå¯ä»¥è€ƒè™‘max heapã€‚æ¯æ¬¡è¿­ä»£æ—¶ï¼Œä»å †é‡Œå¼¹å‡ºå †é¡¶å…ƒç´ ï¼ˆæ„å‘³ç€ä¸‹æ¬¡è¿­ä»£è¯¥å…ƒç´ ä¸ä¼šè€ƒè™‘ï¼‰åŠ å…¥resï¼Œå¦‚æœä¸Šä¸€æ¬¡è¿­ä»£åŠ å…¥resçš„å…ƒç´ è¿˜æœ‰å‰©ä½™ï¼Œå°±å°†å…¶é‡æ–°åŠ å…¥heapï¼Œæ„å‘³ç€ä¸‹æ¬¡è¿­ä»£éœ€è¦è€ƒè™‘è¯¥å…ƒç´ ã€‚ <figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line">class Solution:</span><br><span class="line">    def reorganizeString(self, s: str) -&gt; str:</span><br><span class="line">        ans, cnt = [], Counter(s)  # decent order</span><br><span class="line">        max_heap = [(-value, key) for key, value in cnt.items()]</span><br><span class="line">        heapq.heapify(max_heap)</span><br><span class="line">        prev_ch, prev_cnt = &#x27;&#x27;, 0</span><br><span class="line">        while max_heap:</span><br><span class="line">            cnt, ch = heapq.heappop(max_heap)</span><br><span class="line">            ans.append(ch)</span><br><span class="line">            if prev_cnt &lt; 0:</span><br><span class="line">                heapq.heappush(max_heap, (prev_cnt, prev_ch))</span><br><span class="line">            cnt += 1</span><br><span class="line">            prev_ch, prev_cnt = ch, cnt</span><br><span class="line">        if len(s) != len(ans):</span><br><span class="line">            return &quot;&quot;</span><br><span class="line">        return &#x27;&#x27;.join(ans)</span><br></pre></td></tr></table></figure> æ—¶é—´å¤æ‚åº¦<span class="math inline">\(O(n)\)</span>ï¼Œç©ºé—´<span class="math inline">\(O(n)\)</span>ã€‚</p>

      
    </div>

    
    
    
      <footer class="post-footer">
        <div class="post-eof"></div>
      </footer>
  </article>
  
  
  

      
  
  
  <article itemscope itemtype="http://schema.org/Article" class="post-block" lang="en">
    <link itemprop="mainEntityOfPage" href="https://eimadrigal.github.io/2021/07/21/CS231n%20Assignment%20#1/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="image" content="/images/favicon.png">
      <meta itemprop="name" content="EIMadrigal">
      <meta itemprop="description" content="Hello World">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="EI Madrigal's Space">
    </span>
      <header class="post-header">
        <h2 class="post-title" itemprop="name headline">
          
            <a href="/2021/07/21/CS231n%20Assignment%20#1/" class="post-title-link" itemprop="url">CS231n Assignment</a>
        </h2>

        <div class="post-meta">

		  
            <span class="post-meta-item">
              <span class="post-meta-item-icon">
                <i class="far fa-calendar"></i>
              </span>
              <span class="post-meta-item-text">Posted on</span>

              <time title="Created: 2021-07-21 05:29:00" itemprop="dateCreated datePublished" datetime="2021-07-21T05:29:00+08:00">2021-07-21</time>
            </span>

          

        </div>
      </header>

    
    
    
    <div class="post-body" itemprop="articleBody">

      
          <p>å…ˆå¹ä¸€æ³¢Google Colabï¼Œæ‰€æœ‰æ“ä½œéƒ½å¯åœ¨äº‘ä¸Šè¿›è¡Œï¼Œè¿˜èƒ½ç™½å«–ğŸ•å®¶çš„GPUï¼›å†å¹ä¸€ä¸‹Stanfordçš„éª¨æ¶ä»£ç ï¼ŒçœŸçš„æ˜¯å¹²å‡€æ•´æ´ä¼˜ç¾ï¼Œå ªç§°å…¸èŒƒã€‚ <a target="_blank" rel="noopener" href="https://github.com/EIMadrigal/CS231n">My Code</a> ## kNN æœ€å¹¼ç¨šçš„æœºå™¨å­¦ä¹ ç®—æ³•ã€‚</p>
<ol type="1">
<li>è®¡ç®—æµ‹è¯•é›†å’Œè®­ç»ƒé›†çš„è·ç¦» è®­ç»ƒé›†<code>X_train</code>çš„shapeä¸º<span class="math inline">\((N, D)\)</span>ï¼Œ<code>y_train</code>çš„shapeä¸º<span class="math inline">\((N,)\)</span>ï¼Œ<code>y[i]</code>å–å€¼èŒƒå›´<span class="math inline">\([0,C-1]\)</span> æµ‹è¯•é›†<code>X_test</code>çš„shapeä¸º<span class="math inline">\((M, D)\)</span>ï¼Œæœ€ç»ˆçš„distance matrixçš„shapeä¸º<span class="math inline">\((M,N)\)</span> å£°æ˜ï¼šä¸èƒ½ä½¿ç”¨ç±»ä¼¼äº<code>np.linalg.norm()</code>è¿™ç§ä¸œè¥¿ä½œå¼Šã€‚ é¦–å…ˆæ¥çœ‹çœ‹2é‡å¾ªç¯ï¼šç¬¬ä¸€é‡éå†æµ‹è¯•é›†ï¼Œç¬¬äºŒé‡éå†è®­ç»ƒé›†ï¼Œå½“ç„¶å¦‚æœä½ æ„¿æ„ï¼Œè¿˜å¯ä»¥ç”¨ç¬¬ä¸‰é‡éå†dimensionå»ç´¯åŠ è·ç¦»ï¼› å†æ¥çœ‹çœ‹åªéå†æµ‹è¯•é›†çš„å•å±‚å¾ªç¯ï¼šå¯¹äºæ¯ä¸ªæµ‹è¯•æ ·ä¾‹<code>X[i]</code>ï¼Œå‡å»<code>X_train</code>ï¼Œé€šè¿‡å¹¿æ’­æœºåˆ¶å¾—åˆ°ä¸€ä¸ª<span class="math inline">\((N, D)\)</span>çš„å·®çŸ©é˜µï¼Œåšelement-wiseçš„å¹³æ–¹ï¼ŒæŒ‰åˆ—ç›¸åŠ å¾—åˆ°<span class="math inline">\((N,)\)</span>ï¼Œè¡¨ç¤ºæµ‹è¯•æ ·ä¾‹<code>X[i]</code>ä¸æ¯ä¸ªè®­ç»ƒæ ·ä¾‹çš„è·ç¦»ï¼Œä½œä¸ºè·ç¦»çŸ©é˜µçš„ç¬¬<span class="math inline">\(i\)</span>è¡Œï¼› æœ€åæ¥çœ‹çœ‹full-vectorizedçš„ç‰ˆæœ¬ï¼Œæ•°å­¦æ¨å¯¼è§<a target="_blank" rel="noopener" href="https://zhuanlan.zhihu.com/p/146076139">NumPyä¹‹è®¡ç®—ä¸¤ä¸ªçŸ©é˜µçš„æˆå¯¹å¹³æ–¹æ¬§æ°è·ç¦»</a>ï¼Œåƒé¥±æ²¡äº‹å¹²çš„åŒå­¦å¯ä»¥è‡ªå·±æ¨æ¨ï¼Œæˆ‘æ•°å­¦å¤ªå·®å°±æºœäº†ã€‚</li>
<li>æ ¹æ®è·ç¦»çŸ©é˜µé¢„æµ‹æµ‹è¯•é›†çš„æ ‡ç­¾ å¯¹äºæ¯ä¸ªæµ‹è¯•æ ·ä¾‹<code>X[i]</code>ï¼Œé€‰kä¸ªè·ç¦»æœ€å°çš„è®­ç»ƒæ ·ä¾‹ï¼Œå°†å…¶labelï¼ˆä»<code>y_train</code>è·å¾—ï¼‰å­˜å…¥<code>cloest_y</code>ä¸­ï¼ŒæŠ•ç¥¨å†³å®šæœ€ç»ˆçš„é¢„æµ‹æ ‡ç­¾ã€‚ å…ˆç”¨<code>idx=np.argsort(dists[i])[:k]</code>å–å‡ºå‰kä¸ªè®­ç»ƒæ ·ä¾‹çš„indexï¼Œå†ç”¨<code>y_train[idx]</code>å¾—åˆ°å¯¹åº”çš„kä¸ªlabelï¼Œæœ€åç”¨<code>np.argmax(np.bincount(cloest_y))</code>å¾—åˆ°æœ€ç»ˆçš„é¢„æµ‹labelã€‚</li>
</ol>
<p>kNNæ•ˆæœå½“ç„¶æ¯”è¾ƒæ‹‰å®äº†ï¼Œåœ¨CIFAR-10çš„å­é›†ä¸Šåˆ†ç±»æ­£ç¡®ç‡å¤§æ¦‚åœ¨27%å·¦å³ã€‚æ¯”è¾ƒä»¤æˆ‘éœ‡æƒŠçš„æ˜¯ä¸‰ä¸ªè®¡ç®—è·ç¦»å‡½æ•°è€—è´¹çš„æ—¶é—´ï¼Œ2é‡å¾ªç¯57sï¼Œå•å±‚å¾ªç¯41sï¼Œfully-vectorizedåªæœ‰0.57sï¼Œç«Ÿç„¶<strong>é™ä½äº†100å€</strong>ï¼Œå†™å‡ºé«˜æ•ˆçš„ä»£ç å¯¹äºç¨‹åºæ€§èƒ½æœ‰ç€è‡³å…³é‡è¦çš„å½±å“ï¼Œåæ€ä¸‹è‡ªå·±å†™å‡ºçš„junk codeï¼Œä¸ç”±å¾—ç•™ä¸‹äº†ä¼¤å¿ƒçš„æ³ªæ°´...</p>
<p>æœ€åå°±æ˜¯ç”¨cross-validationç¡®å®šè¶…å‚kçš„å–å€¼ï¼Œå°±ç•¥è¿‡äº†å“ˆã€‚ ## Linear Multiclass SVM é¦–å…ˆè¦ä¸ºå¤šåˆ†ç±»SVMå†™ä¸€ä¸ªæŸå¤±å‡½æ•°ï¼Œè€è§„çŸ©è¿˜æ˜¯å…ˆå†™ä¸€ä¸ªnaiveç‰ˆæœ¬<code>svm_loss_naive(W, X, y, reg)</code>ï¼š æƒé‡çŸ©é˜µWï¼š<span class="math inline">\((D, C)\)</span> minibatchè¾“å…¥Xï¼š<span class="math inline">\((N, D)\)</span> æ ‡ç­¾yï¼š<span class="math inline">\((N,)\)</span>ï¼Œ<code>y[i]=c</code>è¡¨ç¤º<code>X[i]</code>çš„æ ‡ç­¾æ˜¯cï¼Œ<span class="math inline">\(0 \leq c&lt;c\)</span> <span class="math display">\[l=&quot;\frac{1}{N}&quot; \]</span>l_i="_{j" +="" -="" )="" ),s_j="f(x_i," ="" ="" _i="" <em>k<em>l="" </em>{j="" f(x_i;="" lossä¸ºï¼š="" losså’Œæ­£åˆ™é¡¹ä¸¤éƒ¨åˆ†ï¼Œå¯¹äºç¬¬<span class="math inline">\(i\)</span>ä¸ªè®­ç»ƒæ ·æœ¬ï¼Œdata="" lossæ˜¯è¿™ä¹ˆå®šä¹‰çš„ï¼š="" machine="" multiclass="" s_j="" s</em>{y_i}="" support="" vector="" w)_j="" w)_j<span class="math display">\[=&quot;&quot; w)_{y_i}=&quot;&quot; w_{k,l}^2\]</span>="" y_i}="" ä»€ä¹ˆæ„æ€å‘¢ï¼Ÿ<span class="math inline">\(s\)</span>æ˜¯ç¬¬<span class="math inline">\(i\)</span>ä¸ªè®­ç»ƒæ ·æœ¬çš„å¾—åˆ†å‘é‡<span class="math inline">\((c,)\)</span>ï¼Œ<span class="math inline">\(s_{y_i}\)</span>è¡¨ç¤ºæ­£ç¡®æ ‡ç­¾çš„å¾—åˆ†ï¼Œ<span class="math inline">\(s_j\)</span>è¡¨ç¤ºå…¶ä»–ç±»çš„å¾—åˆ†ã€‚ä¸å¦¨çœ‹çœ‹ä»€ä¹ˆæ—¶å€™æŸå¤±ä¸º0å‘¢ï¼Ÿç¨ä½œå˜å½¢å³æœ‰ï¼šå½“<span class="math inline">\(s_{y_i}-s_j=&quot;&quot; çœ‹ç€æœ‰ç‚¹å¤æ‚å“¦ï¼ä¸»è¦æœ‰data=&quot;&quot; è¿”å›æµ®ç‚¹æ•°`loss`å’Œè§£ææ¢¯åº¦`dw`=&quot;&quot;&gt;\Delta\)</span>æ—¶ï¼Œç¬¬<span class="math inline">\(j\)</span>ç±»æŸå¤±ä¸º0ï¼Œè¯´äººè¯å°±æ˜¯åªæœ‰å½“æ­£ç¡®ç±»çš„å¾—åˆ†å‡å»å…¶ä»–ç±»çš„å¾—åˆ†å¤§äºæŸä¸ªé—´éš”<span class="math inline">\(\Delta\)</span>æ—¶æ‰ä¸ä¼šç´¯ç§¯æŸå¤±ï¼Œå¦åˆ™å°±ç´¯åŠ æŸå¤±ï¼ˆå¿…ç„¶ä¸ºæ­£æ•°ï¼‰ï¼Œè¿™å°±æ˜¯å¤§åé¼é¼çš„<strong>Hinge Loss</strong>ã€‚</p>
<p>å¦‚æœ<span class="math inline">\(f\)</span>ç”¨çš„æ˜¯linear score functionï¼Œè¿›ä¸€æ­¥æœ‰ï¼š <span class="math display">\[L_i = \sum_{j\neq y_i} \max(0, w_j^T x_i - w_{y_i}^T x_i + \Delta)\]</span> å…¶ä¸­ï¼Œ<span class="math inline">\(w_j\)</span>è¡¨ç¤ºWçš„ç¬¬<span class="math inline">\(j\)</span>åˆ—ã€‚ è‡³æ­¤ï¼Œnaiveç‰ˆæœ¬çš„<code>loss</code>å®ç°å°±ä¸å¿…åºŸè¯äº†ã€‚æ¥ç€æ¥æ±‚<code>dW</code>ï¼Œè€è§„çŸ©ï¼Œè¿˜æ˜¯å…ˆç ”ç©¶å•ä¸ªæ ·æœ¬ã€‚</p>
<p>å¦‚æœä½ çš„æ•°å­¦è¿˜è¡Œï¼Œä¸‹é¢çš„æ¢¯åº¦æ¨å¯¼å¯ä»¥ç•¥è¿‡ï¼š <span class="math display">\[L_i = max(0,w_1^T x_i - w_{y_i}^T x_i + \Delta)+max(0,w_2^T x_i - w_{y_i}^T x_i + \Delta)+...+max(0,w_C^T x_i - w_{y_i}^T x_i + \Delta)\]</span> å…±æœ‰<span class="math inline">\(C-1\)</span>é¡¹ï¼Œå› ä¸º<span class="math inline">\(j=y_i\)</span>é‚£é¡¹ä¸ç®—ã€‚å¦ï¼Œåªæœ‰åœ¨<span class="math inline">\(w_j^T x_i - w_{y_i}^T x_i + \Delta&gt;0\)</span>æ—¶ç¬¬<span class="math inline">\(j\)</span>é¡¹çš„æ¢¯åº¦ä¸ä¸º0ã€‚</p>
<ol type="1">
<li>å¯¹<span class="math inline">\(w_{y_i}\)</span>çš„æ¢¯åº¦ æ¯é¡¹éƒ½æœ‰ï¼Œå¹¶ä¸”éƒ½æ˜¯0æˆ–<span class="math inline">\(-x_i\)</span>ï¼Œå› æ­¤åªè¦çœ‹å‡ é¡¹å¤§äº0ï¼Œæ¢¯åº¦å°±æ˜¯å‡ å€çš„<span class="math inline">\(-x_i\)</span>ï¼Œæ­£å¼ç‚¹å°±æ˜¯ï¼š <span class="math display">\[\nabla_{w_{y_i}} L_i = - \left( \sum_{j\neq y_i} \mathbb{1}(w_j^Tx_i - w_{y_i}^Tx_i + \Delta &gt; 0) \right) x_i\]</span></li>
<li>å¯¹<span class="math inline">\(w_j\)</span>çš„æ¢¯åº¦ åªæœ‰ç¬¬<span class="math inline">\(j\)</span>é¡¹æœ‰ï¼Œ0æˆ–<span class="math inline">\(x_i\)</span>ï¼Œæ­£å¼ç‚¹å°±æ˜¯ï¼š <span class="math display">\[\nabla_{w_j} L_i = \mathbb{1}(w_j^Tx_i - w_{y_i}^Tx_i + \Delta &gt; 0) x_i\]</span></li>
</ol>
<p>naiveç‰ˆæœ¬çš„<code>dW[:,j]</code>å’Œ<code>dW[:,y[i]]</code>å°±2é‡å¾ªç¯æŒ‰éƒ¨å°±ç­æ›´æ–°å³å¯ï¼Œåˆ«å¿˜äº†é™¤ä»¥<span class="math inline">\(N\)</span>å’Œæ­£åˆ™é¡¹æ¢¯åº¦ã€‚</p>
<p>æ¥ç€æ¥å®ç°<code>svm_loss_vectorized(W, X, y, reg)</code>ï¼š</p>
<ol type="1">
<li>loss é¦–å…ˆæ±‚å¾—æ•´ä¸ªè®­ç»ƒé›†çš„å¾—åˆ†çŸ©é˜µ<code>scores</code>ï¼Œshapeä¸º<span class="math inline">\((N,C)\)</span>ï¼Œæ¯ä¸€è¡Œè¡¨ç¤ºä¸€ä¸ªæ ·ä¾‹çš„å¾—åˆ†ã€‚æ­£ç¡®ç±»å¾—åˆ†å‘é‡<code>correct_class_score</code>å¯ç”¨<code>scores[np.arange(num_train), y]</code>å¾—åˆ°ï¼Œshapeä¸º<span class="math inline">\((N,)\)</span>ï¼Œæ³¨æ„è¿™é‡Œä¸èƒ½ç”¨<code>scores[:, y]</code>ï¼Œç®€å•è¯•éªŒä¸‹ï¼š</li>
</ol>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">X = np.array([[<span class="number">1</span>,<span class="number">2</span>,<span class="number">3</span>],[<span class="number">3</span>,<span class="number">4</span>,<span class="number">5</span>]])</span><br><span class="line">y = np.array([<span class="number">2</span>, <span class="number">1</span>])</span><br><span class="line"><span class="built_in">print</span>(X[np.arange(<span class="number">2</span>), y])  <span class="comment"># [3,4]</span></span><br><span class="line"><span class="built_in">print</span>(X[:, y])  <span class="comment"># [[3,2],[5,4]]</span></span><br></pre></td></tr></table></figure>
<p>ä¸‹æ¥åˆ°äº†æœ€å…³é”®çš„<code>margins</code>çŸ©é˜µï¼Œè¯¥çŸ©é˜µå’Œ<code>scores</code>çŸ©é˜µshapeç›¸åŒ<span class="math inline">\((N,C)\)</span>ï¼Œç¬¬<span class="math inline">\(i\)</span>è¡Œè¡¨ç¤ºç¬¬<span class="math inline">\(i\)</span>ä¸ªè®­ç»ƒæ ·æœ¬çš„marginå³<span class="math inline">\(max(0,s_j - s_{y_i} + \Delta)\)</span>ï¼Œåœ¨æ¯ä¸€è¡Œç¬¬<span class="math inline">\(y_i\)</span>ä¸ªä½ç½®ä¸Šåº”å½“è®¾ç½®ä¸º0ï¼Œå…¶ä½™ä½ç½®æŒ‰ç…§å…¬å¼å³å¯ï¼š</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">margins = np.maximum(<span class="number">0</span>, scores - correct_class_score[:, np.newaxis] + <span class="number">1</span>)</span><br><span class="line">margins[np.arange(num_train), y] = <span class="number">0</span></span><br></pre></td></tr></table></figure>
<p>éœ€è¦æ³¨æ„ï¼š<code>correct_class_score</code>æ˜¯ä¸€ä¸ª<span class="math inline">\((N,)\)</span>çš„å‘é‡ï¼Œå¦‚æœç›´æ¥<code>scores-correct_class_score</code>å°±ä¼šæŠ¥é”™ï¼Œå¹¿æ’­æœºåˆ¶ä»æœ€åä¸€ä¸ªç»´åº¦å¼€å§‹æ¯”å¯¹ï¼Œåªæœ‰ç›¸ç­‰æˆ–è€…å…¶ä¸­æŸä¸ªä¸º1æ‰è¡Œï¼Œå› æ­¤ç”¨<code>np.newaxis</code>å°†<code>correct_class_score</code>çš„shapeå˜ä¸º<span class="math inline">\((N,1)\)</span>ï¼›è¿˜æœ‰å°±æ˜¯<code>np.max()</code>å’Œ<code>np.maximum()</code>çš„åŒºåˆ«ï¼Œ<code>np.max()</code>å’Œ<code>np.amax(a, axis=None, ...)</code>ç­‰ä»·ï¼Œè¿”å›æ•°ç»„çš„æœ€å¤§å€¼ï¼Œ<code>np.maximum(x1, x2, out=None, ...)</code>è¿”å›element-wiseçš„è¾ƒå¤§å€¼ã€‚</p>
<ol start="2" type="1">
<li>æ¢¯åº¦ è¿™é‡Œä¹Ÿç¨å¾®æœ‰ç‚¹trickyï¼Œæ ¹æ®naiveç‰ˆæœ¬å¯¹æ¢¯åº¦çš„è®¨è®ºï¼šå¯¹<span class="math inline">\(w_j\)</span>çš„æ¢¯åº¦éœ€è¦çŸ¥é“marginçš„æ­£è´Ÿï¼Œå¯¹<span class="math inline">\(w_{y_i}\)</span>çš„æ¢¯åº¦éœ€è¦çŸ¥é“<strong>æœ‰å‡ é¡¹å¤§äº0</strong>ã€‚æ€ä¹ˆå€ŸåŠ©<code>margins</code>çŸ©é˜µç»Ÿè®¡æ¯ä¸€è¡Œå¤§äº0çš„é¡¹æ•°å‘¢ï¼Ÿæ— èŠçš„ç¨‹åºå‘˜å…ˆå°†çŸ©é˜µä¸­å¤§äº0çš„é¡¹éƒ½è®¾ä¸º1ï¼Œç„¶åæŒ‰åˆ—ç›¸åŠ å³å¯ï¼š</li>
</ol>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">margins[margins &gt; <span class="number">0</span>] = <span class="number">1.0</span></span><br><span class="line">num_to_loss = np.<span class="built_in">sum</span>(margins, axis=<span class="number">1</span>)  <span class="comment"># (N,)</span></span><br><span class="line">margins[np.arange(num_train, y)] = -num_to_loss</span><br></pre></td></tr></table></figure>
<p>å¯¹å•ä¸ªæ ·æœ¬<span class="math inline">\(i\)</span>æ¥è¯´ï¼Œå…¶å¯¹<code>dW</code>çš„è´¡çŒ®è¦ä¹ˆæ˜¯åœ¨ç¬¬<span class="math inline">\(j\)</span>åˆ—ï¼ˆå³ç¬¬<span class="math inline">\(j\)</span>ä¸ªç±»ï¼‰åŠ ä¸Š<span class="math inline">\(x_i\)</span>ï¼Œè¦ä¹ˆåœ¨ç¬¬<span class="math inline">\(y_i\)</span>åˆ—åŠ ä¸Š<span class="math inline">\(-kx_i\)</span>ï¼Œ<span class="math inline">\(k\)</span>ä¸º<code>margins[i]</code>ä¸­å¤§äº0çš„å…ƒç´ ä¸ªæ•°ï¼Œå³<code>num_to_loss[i]</code>ï¼Œæ•´ä¸ªè®­ç»ƒé›†å¯¹<code>dW</code>çš„æ›´æ–°å³æ˜¯åœ¨ç´¯åŠ å•ä¸ªæ ·æœ¬å¯¹<code>dW</code>æ¯ä¸€åˆ—ï¼ˆæ¯ä¸ªç±»ï¼‰çš„å½±å“ã€‚å¯¹ç¬¬<span class="math inline">\(j\)</span>åˆ—ï¼Œå…¶æ›´æ–°å³ä¸ºæ¯ä¸ªè®­ç»ƒæ ·æœ¬å¯¹è¯¥ç±»è´¡çŒ®çš„çº¿æ€§ç»„åˆï¼Œç»„åˆç³»æ•°å–å†³äºè¯¥æ ·æœ¬çš„æ ‡ç­¾ä»¥åŠæ˜¯å¦æ»¡è¶³æŒ‡ç¤ºå‡½æ•°ï¼Œå³ä¸º<code>margins</code>çš„ç¬¬<span class="math inline">\(j\)</span>åˆ—ï¼Œå–å€¼èŒƒå›´<span class="math inline">\(\{0,1,-k\}\)</span>ï¼Œ0è¡¨ç¤ºè¯¥æ ·æœ¬å¯¹ç¬¬<span class="math inline">\(j\)</span>ä¸ªç±»çš„æ¢¯åº¦æ²¡æœ‰è´¡çŒ®ï¼ˆè¯¥æ ·æœ¬æ ‡ç­¾ä¸æ˜¯<span class="math inline">\(j\)</span>ä¸”ä¸æ»¡è¶³æŒ‡ç¤ºå‡½æ•°ï¼‰ï¼Œ1è¡¨ç¤ºè´¡çŒ®äº†<span class="math inline">\(x_i\)</span>ï¼ˆè¯¥æ ·æœ¬æ ‡ç­¾ä¸æ˜¯<span class="math inline">\(j\)</span>ä¸”æ»¡è¶³æŒ‡ç¤ºå‡½æ•°ï¼‰ï¼Œ<span class="math inline">\(-k\)</span>è¡¨ç¤ºè´¡çŒ®äº†<span class="math inline">\(-kx_i\)</span>ï¼ˆè¯¥æ ·æœ¬çš„æ ‡ç­¾å°±æ˜¯<span class="math inline">\(j\)</span>ï¼‰ï¼Œå› æ­¤ï¼š</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">dW = np.dot(X.T, margins) / num_train + <span class="number">2</span> * reg * W</span><br></pre></td></tr></table></figure>
<p>å¯ä»¥ä»çŸ©é˜µç»´åº¦ç›¸å®¹çš„è§’åº¦éªŒè¯ã€‚ ## Softmax å…ˆç”¨å¾ªç¯å®ç°ä¸€ä¸ª<code>softmax_loss_naive(W, X, y, reg)</code>ï¼Œè¾“å…¥çš„shapeå’ŒSVMç›¸åŒã€‚ softmaxåˆ†ç±»å™¨ä¸å†å°†<span class="math inline">\(f(x_i;W)\)</span>çœ‹åšæ¯ä¸ªç±»çš„å¾—åˆ†ï¼Œè€Œæ˜¯å¸Œæœ›è¾“å‡ºnormalized class probabilitiesï¼Œæœ€ç»ˆé€‰ä¸€ä¸ªæ¦‚ç‡æœ€å¤§çš„ç±»ä½œä¸ºé¢„æµ‹ï¼Œ<strong>softmaxå‡½æ•°</strong>å°±èƒ½å°†<span class="math inline">\(f(x_i;W)\)</span>æ˜ å°„åˆ°<span class="math inline">\([0,1]\)</span>ä¸”æ»¡è¶³æ¦‚ç‡çš„æ€§è´¨ï¼š <span class="math display">\[P(y_i \mid x_i; W) = \frac{e^{f_{y_i}}}{\sum_j e^{f_j} }\]</span> ä»é¢„æµ‹å‡½æ•°å¯ä»¥çœ‹åˆ°ï¼šsoftmaxæ˜¯æŠŠ<span class="math inline">\(f(x_i;W)\)</span>çœ‹ä½œunnormalized log probabilitiesï¼Œå› æ­¤å¯¹<span class="math inline">\(f(x_i;W)\)</span>å…ˆæŒ‡æ•°å†å½’ä¸€åŒ–å¾—åˆ°æ¯ä¸ªç±»çš„æ¦‚ç‡ã€‚</p>
<p>å†æ¥çœ‹softmaxçš„æŸå¤±å‡½æ•°ï¼š <span class="math display">\[L_i = -\log\left(\frac{e^{f_{y_i}}}{ \sum_j e^{f_j} }\right) \hspace{0.1in} \text{or equivalently} \hspace{0.1in} L_i = -f_{y_i} + \log\sum_j e^{f_j}\]</span> ä»ç›´è§‰ä¸Šè¯´ï¼šå±äºæ­£ç¡®ç±»<span class="math inline">\(y_i\)</span>çš„æ¦‚ç‡ï¼ˆæ‹¬å·é‡Œçš„åˆ†å¼ï¼‰è¶Šé«˜ï¼ŒæŸå¤±åº”è¯¥è¶Šå°ï¼Œè¿™å°±æ˜¯å¤§åé¼é¼çš„<strong>cross-entropy loss</strong>ï¼Œè¡¡é‡äº†çœŸå®åˆ†å¸ƒ<span class="math inline">\(p\)</span>å’Œé¢„æµ‹åˆ†å¸ƒ<span class="math inline">\(q\)</span>ä¹‹é—´çš„å·®è·ï¼š <span class="math display">\[H(p,q) = - \sum_x p(x) \log q(x)= H(p) + D_{KL}(p||q)\]</span> å…·ä½“åˆ°softmaxï¼š <span class="math display">\[q=\frac{e^{f_{y_i}}}{ \sum_j e^{f_j} },p = [0, \ldots 1, \ldots, 0]\]</span> å…¶ä¸­ï¼Œ<span class="math inline">\(p\)</span>åœ¨ç¬¬<span class="math inline">\(y_i\)</span>ä¸ªä½ç½®ä¸Šä¸º1ã€‚ ç”±äº<span class="math inline">\(H(p)=0\)</span>ï¼Œå› æ­¤å…¶å®æ˜¯åœ¨æœ€å°åŒ–<span class="math inline">\(p\)</span>å’Œ<span class="math inline">\(q\)</span>çš„KLæ•£åº¦ï¼Œå³å¸Œæœ›é¢„æµ‹ç»“æœ<span class="math inline">\(q\)</span>å°½é‡å‘<span class="math inline">\(p\)</span>é è¿‘ã€‚</p>
<p>ä»æ¦‚ç‡çš„è§’åº¦å‡ºå‘çœ‹æŸå¤±å‡½æ•°ï¼Œæˆ‘ä»¬æ˜¯åœ¨æœ€å°åŒ–æ­£ç¡®ç±»<span class="math inline">\(y_i\)</span>çš„è´Ÿå¯¹æ•°ä¼¼ç„¶ï¼Œæœ¬è´¨ä¸Šå°±æ˜¯åœ¨åšä¸€ä¸ªæå¤§ä¼¼ç„¶ä¼°è®¡ã€‚</p>
<p>çœ‹å®Œç†è®ºï¼Œè¿˜è¦è€ƒè™‘ä¸€äº›ç°å®é—®é¢˜ã€‚æ¯”å¦‚æ•°å€¼ç¨³å®šæ€§ï¼Œç”±äºæŒ‡æ•°çš„åŸå› å¯èƒ½ä¼šå¯¼è‡´overflowæˆ–è€…underflowï¼Œå› æ­¤åšä¸€ä¸ªç®€å•çš„ç­‰ä»·å˜æ¢ï¼š <span class="math display">\[\frac{e^{f_{y_i}}}{\sum_j e^{f_j}}
= \frac{Ce^{f_{y_i}}}{C\sum_j e^{f_j}}
= \frac{e^{f_{y_i} + \log C}}{\sum_j e^{f_j + \log C}}\]</span> ä¸€èˆ¬é€‰<span class="math inline">\(\log C = -\max_j f_j\)</span>ï¼Œè¿™ä¸ªå˜æ¢ä¸ä¼šæ”¹å˜é¢„æµ‹å‡½æ•°æˆ–è€…æŸå¤±å‡½æ•°ï¼Œåªæ˜¯å°†å¾—åˆ†åšäº†å¹³ç§»ã€‚</p>
<p>è‡³æ­¤ï¼Œnaiveç‰ˆæœ¬çš„losså°±åŸºæœ¬æœ‰äº†ï¼Œæ¥ç€çœ‹çœ‹æ¢¯åº¦å’‹æ±‚ã€‚å…ˆç¨ç¨å±•å¼€åº·åº·ï¼š <span class="math display">\[L_i=-f_{y_i} + \log\sum_j e^{f_j}=-w_{y_i}^Tx_i+log\sum_je^{w_j^Tx_i}\]</span> å…¶ä¸­ï¼Œ<span class="math inline">\(w_j\)</span>è¡¨ç¤ºWçš„ç¬¬<span class="math inline">\(j\)</span>åˆ—ã€‚ ç„¶åä½¿ç”¨æˆ‘ä»¬çš„å°å­¦æ•°å­¦çŸ¥è¯†å»æ±‚åå¯¼ï¼š <span class="math display">\[\nabla_{w_{y_i}} L_i =(\frac{e^{f_{y_i}}}{ \sum_j e^{f_j}}-1)x_i \\
\nabla_{w_j} L_i = \frac{e^{f_{j}}}{ \sum_j e^{f_j}}x_i\]</span> è®°<code>p = np.exp(scores) / np.sum(np.exp(scores))</code>ï¼Œshapeä¸º<span class="math inline">\((C,)\)</span>ï¼Œè¡¨ç¤ºæ ·æœ¬<span class="math inline">\(i\)</span>å±äºæ¯ä¸ªç±»çš„æ¦‚ç‡ã€‚ æ‰€ä»¥<code>dW</code>çš„ç¬¬<code>y[i]</code>åˆ—æ›´æ–°å³ä¸º<code>(p[y[i]] - 1) * X[i]</code>ï¼Œå…¶ä»–åˆ—æ›´æ–°ä¸º<code>p[j] * X[i]</code>ã€‚</p>
<p>æ¥ç€çœ‹ä¸‹vectorizedç‰ˆæœ¬ï¼Œ<code>scores</code>çš„shapeå˜ä¸ºäº†<span class="math inline">\((N,C)\)</span>ï¼Œé¦–å…ˆå¤„ç†æ•°å€¼ç¨³å®šæ€§é—®é¢˜ï¼Œæ¯ä¸€è¡Œéƒ½å‡å»è¯¥è¡Œçš„æœ€å¤§å€¼ï¼ˆæ³¨æ„<code>keepdim=True</code>ï¼‰ï¼›æ¥ç€æ±‚å‡ºæ¦‚ç‡çŸ©é˜µ<code>p</code>ï¼Œshapeä¸<code>scores</code>ç›¸åŒï¼Œé‚£ä¹ˆlossä¸ºï¼š <code>loss = np.sum(-np.log(p[np.arange(X.shape[0]), y])) / X.shape[0]</code> ä¸SVMç±»ä¼¼ï¼Œ<code>dW</code>çš„æ¯ä¸€åˆ—ï¼ˆæ¯ä¸ªç±»ï¼‰æ˜¯ç”±æ¯ä¸ªè®­ç»ƒæ ·æœ¬å½±å“çš„çº¿æ€§ç»„åˆå†³å®šçš„ï¼Œç»„åˆç³»æ•°å–å†³äºè¯¥è®­ç»ƒæ ·ä¾‹çš„æ ‡ç­¾ï¼Œæ¯”å¦‚å¯¹äº<code>dW</code>çš„ç¬¬<span class="math inline">\(j\)</span>ä¸ªç±»æ¥è¯´ï¼Œå¦‚æœæŸä¸ªæ ·ä¾‹çš„æ ‡ç­¾æ°å¥½æ˜¯<span class="math inline">\(j\)</span>ï¼Œé‚£ä¹ˆå…¶å¯¹æ¢¯åº¦çš„è´¡çŒ®å°±æ˜¯<code>p[j]-1</code>ï¼Œå¦åˆ™ç³»æ•°å°±æ˜¯<code>p[j]</code>ã€‚å› æ­¤åªè¦å°†æ¦‚ç‡çŸ©é˜µ<code>p</code>ä¸­æ‰€æœ‰æ­£ç¡®æ ‡ç­¾çš„å€¼å‡1å³å¾—åˆ°ç³»æ•°çŸ©é˜µï¼Œè¿›è€Œå¾—åˆ°<code>dW</code>ï¼š</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">p[np.arange(X.shape[<span class="number">0</span>]), y] = p[np.arange(X.shape[<span class="number">0</span>]), y] - <span class="number">1</span></span><br><span class="line">dW = np.dot(X.T, p)</span><br></pre></td></tr></table></figure>
<p>åŒæ ·å¯ä»¥ç”¨ç»´åº¦ç›¸å®¹å»checkã€‚ ## Neural Network è¿™æ˜¯ä¸€ä¸ªä¸¤å±‚çš„å…¨è¿æ¥ç¥ç»ç½‘ç»œï¼Œæ¶æ„å¦‚ä¸‹ï¼š è¾“å…¥<span class="math inline">\((N,D)\)</span>-&gt;å…¨è¿æ¥å±‚1-&gt;ReLU-&gt;å…¨è¿æ¥å±‚2ï¼ˆè¾“å‡ºæ¯ä¸ªç±»çš„å¾—åˆ†ï¼‰-&gt;softmax å‚æ•°ä»¬çš„shapeä¸ºï¼š<span class="math inline">\(X(N,D),W1(D,H),b1(H,),W2(H,C),b2(C,)\)</span></p>
<p>ç¬¬ä¸€æ­¥Forward Passï¼Œæ ¹æ®è¾“å…¥Xå’Œæƒå€¼Wè®¡ç®—<span class="math inline">\(scores(N,C)\)</span>ï¼Œç„¶åè®¡ç®—softmax lossï¼› ç¬¬äºŒæ­¥Backward Passï¼Œéœ€è¦è®¡ç®—losså¯¹äºå‚æ•°ä»¬çš„æ¢¯åº¦ï¼Œæ ¹æ®ç½‘ç»œç»“æ„ï¼š <span class="math display">\[h=XW1+b1\\
o=ReLU(h)\\
s=oW2+b2\\
L=\sum_i(-s_{y_i}+log\sum_j e^{s_j})\]</span> æ ¹æ®é“¾å¼æ³•åˆ™+ç»´åº¦ç›¸å®¹ï¼š <span class="math display">\[\nabla_{w_2} L =o^T \nabla_{s} L\\
\nabla_{b_2} L =(\nabla_{s} L)^T(\nabla_{b_2} s)=(C,N)(N,1)=(C,N)(all\ 1\ col)\\
\nabla_{w_1} L =X^T \nabla_{s} L\nabla_{h} s\\
\nabla_{b_1} L =\nabla_{h} s (\nabla_{s} L)^T\nabla_{b_1} h=(H,C)(C,N)(N,1)=(H,C)(C,N)(all\ 1\ col)\]</span> å¯ä»¥çœ‹å‡ºï¼šå…³é”®åœ¨äºæ±‚å‡º<span class="math inline">\(\nabla_{s} L\)</span>ï¼Œåœ¨å¯¹softmaxçš„è®¨è®ºä¸­å¯çŸ¥ï¼Œå¯¹äºç¬¬<span class="math inline">\(y_i\)</span>åˆ—å¯¼æ•°ä¸º<code>p[y[i]]-1</code>ï¼Œå¯¹å…¶ä»–åˆ—ä¸º<code>p[j]</code>ï¼Œå› æ­¤è¯¥åå¯¼ä¸ºï¼š</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">d2 = p</span><br><span class="line">d2[np.arange(X.shape[<span class="number">0</span>]), y] -= <span class="number">1</span></span><br></pre></td></tr></table></figure>
<p>å¦å¤–å¯¹äº<span class="math inline">\(W_1,b_1\)</span>ï¼Œè¿˜éœ€è¦<span class="math inline">\(\nabla_{h} s\)</span>ï¼šè¿™ç©æ„åœ¨<span class="math inline">\(h&gt;0\)</span>å°±æ˜¯<span class="math inline">\(W_2^T\)</span>ï¼Œå¦åˆ™å°±æ˜¯0ã€‚å› æ­¤<span class="math inline">\(\nabla_{s} L\nabla_{h} s\)</span>å¯ä»¥å†™ä¸ºï¼š</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">d1 = d2.dot(W2.T) * (h &gt; <span class="number">0</span>)</span><br></pre></td></tr></table></figure>
<h2 id="image-features">Image Features</h2>
<p>ä¹‹å‰çš„æ ·ä¾‹éƒ½æ˜¯ç›´æ¥ç”¨raw pixelï¼ŒåŠ ä¸Šéƒ½æ˜¯çº¿æ€§æ¨¡å‹ï¼Œæ•ˆæœæ‹‰è·¨å¤ªæ­£å¸¸äº†ã€‚è¿™é‡Œç”¨çš„äººå·¥featureåŒ…æ‹¬HOG(Histogram of Oriented Gradients)å’Œcolor histogramï¼ŒHOGæ•æ‰textureï¼ˆçº¹ç†å˜åŒ–ï¼Ÿï¼‰ä¿¡æ¯ï¼Œcolor histogramæ•æ‰é¢œè‰²ä¿¡æ¯ï¼Œä¸¤è€…äº’ç›¸è¾…åŠ©ã€‚&lt;/c$&gt;</p>

      
    </div>

    
    
    
      <footer class="post-footer">
        <div class="post-eof"></div>
      </footer>
  </article>
  
  
  

      
  
  
  <article itemscope itemtype="http://schema.org/Article" class="post-block" lang="en">
    <link itemprop="mainEntityOfPage" href="https://eimadrigal.github.io/2021/07/17/1171%20Remove%20Zero%20Sum%20Consecutive%20Nodes%20from%20Linked%20List/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="image" content="/images/favicon.png">
      <meta itemprop="name" content="EIMadrigal">
      <meta itemprop="description" content="Hello World">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="EI Madrigal's Space">
    </span>
      <header class="post-header">
        <h2 class="post-title" itemprop="name headline">
          
            <a href="/2021/07/17/1171%20Remove%20Zero%20Sum%20Consecutive%20Nodes%20from%20Linked%20List/" class="post-title-link" itemprop="url">1171 Remove Zero Sum Consecutive Nodes from Linked List</a>
        </h2>

        <div class="post-meta">

		  
            <span class="post-meta-item">
              <span class="post-meta-item-icon">
                <i class="far fa-calendar"></i>
              </span>
              <span class="post-meta-item-text">Posted on</span>

              <time title="Created: 2021-07-17 06:50:00" itemprop="dateCreated datePublished" datetime="2021-07-17T06:50:00+08:00">2021-07-17</time>
            </span>

          

        </div>
      </header>

    
    
    
    <div class="post-body" itemprop="articleBody">

      
          <p><a target="_blank" rel="noopener" href="https://leetcode.com/problems/remove-zero-sum-consecutive-nodes-from-linked-list/">é¢˜ç›®é“¾æ¥</a> ## é¢˜æ„ ç»™å®šä¸€ä¸ªå•é“¾è¡¨ï¼Œåˆ é™¤å’Œä¸º0çš„è¿ç»­ç»“ç‚¹åºåˆ—ï¼Œç›´åˆ°æœ€ç»ˆé“¾è¡¨ä¸­æ²¡æœ‰å’Œä¸º0çš„è¿ç»­ç»“ç‚¹åºåˆ—ã€‚ æ ·ä¾‹ï¼šhead = [1,2,3,-3,-2]ï¼Œè¾“å‡º[1] ## åˆ†æ ç”±äºé“¾è¡¨å¤´ç»“ç‚¹å¯èƒ½ä¼šè¢«åˆ é™¤ï¼Œå› æ­¤é¦–å…ˆåˆ›å»ºdummyç»“ç‚¹ã€‚ä¸€ä¸ªæ¯”è¾ƒç›´è§‚çš„æƒ³æ³•å°±æ˜¯è®°å½•å‰ç¼€å’Œï¼Œä¾æ¬¡éå†é“¾è¡¨ï¼Œé‡åˆ°å‡ºç°è¿‡çš„å‰ç¼€å’Œä¹Ÿå°±æ„å‘³ç€å‡ºç°äº†å’Œä¸º0çš„åºåˆ—ï¼Œå°±åˆ é™¤ä¸¤æ¬¡ç›¸åŒå‰ç¼€å’Œä¸­é—´çš„åºåˆ—ã€‚å› æ­¤éœ€è¦ä¸€ä¸ªhashtableè®°å½•å‰ç¼€å’Œå‡ºç°çš„ä½ç½®ï¼Œæ‰‹åŠ¨èµ°ä¸€ä¸ªç®€å•æ ·ä¾‹å§ï¼š dummyè®¾ä¸º<code>(0,head)</code>ï¼Œhashtableåˆå§‹åŒ…å«<code>&#123;0:dummy&#125;</code>ï¼Œé¿å…[1,-1]è¿™ç§æƒ…å†µã€‚</p>
<ol type="1">
<li><code>cur=p(1),sum=1,hash=&#123;0:dummy,1:p(1)&#125;</code></li>
<li><code>cur=p(2),sum=3,hash=&#123;0:dummy,1:p(1),3:p(2)&#125;</code></li>
<li><code>cur=p(3),sum=6,hash=&#123;0:dummy,1:p(1),3:p(2),6:p(3)&#125;</code></li>
<li><code>cur=p(-3),sum=3</code>ï¼šæ­¤æ—¶hashè¿”å›p(2)ï¼Œå› æ­¤å°±è®©p(2).nextæŒ‡å‘cur.nextï¼Œç›¸å½“äºåˆ é™¤äº†[3,-3]ï¼Œ<code>hash=&#123;0:dummy,1:p(1),3:p(2),6:p(3)&#125;</code></li>
<li><code>cur=p(-2),sum=1</code>ï¼šæ­¤æ—¶hashè¿”å›p(1)ï¼Œå› æ­¤è®©p(1).nextæŒ‡å‘cur.nextï¼Œç›¸å½“äºåˆ é™¤äº†[2,-2]ï¼Œ<code>hash=&#123;0:dummy,1:p(1),3:p(2),6:p(3)&#125;</code></li>
</ol>
<p>å¤§æ¦‚å¯ä»¥å†™å‡ºè¿™æ ·çš„ä»£ç ï¼š</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># Definition for singly-linked list.</span></span><br><span class="line"><span class="comment"># class ListNode:</span></span><br><span class="line"><span class="comment">#     def __init__(self, val=0, next=None):</span></span><br><span class="line"><span class="comment">#         self.val = val</span></span><br><span class="line"><span class="comment">#         self.next = next</span></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">Solution</span>:</span></span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">removeZeroSumSublists</span>(<span class="params">self, head: ListNode</span>) -&gt; ListNode:</span></span><br><span class="line">        dummy = ListNode(<span class="built_in">next</span>=head)</span><br><span class="line">        cur = head</span><br><span class="line">        prefix_sum = <span class="number">0</span></span><br><span class="line">        hashtable = &#123;<span class="number">0</span>:dummy&#125;</span><br><span class="line">        <span class="keyword">while</span> cur:</span><br><span class="line">            prefix_sum += cur.val</span><br><span class="line">            p = hashtable.get(prefix_sum)</span><br><span class="line">            <span class="keyword">if</span> p:</span><br><span class="line">                p.<span class="built_in">next</span> = cur.<span class="built_in">next</span></span><br><span class="line">            <span class="keyword">else</span>:</span><br><span class="line">                hashtable[prefix_sum] = cur</span><br><span class="line">            cur = cur.<span class="built_in">next</span></span><br><span class="line">        <span class="keyword">return</span> dummy.<span class="built_in">next</span></span><br></pre></td></tr></table></figure>
<p>äº¤ä¸Šå»WAäº†ï¼Œé—®é¢˜å‡ºåœ¨å“ªå‘¢ï¼Ÿ èµ°ä¸€éå‡ºé”™çš„æ ·ä¾‹ï¼šè¾“å…¥[1,3,2,-3,-2,5,5,-5,1]ï¼ŒæœŸå¾…[1,5,1]ï¼Œè¾“å‡º[1,5,5,-5,1]</p>
<ol type="1">
<li><code>cur=p(1),sum=1,hash=&#123;0:dummy,1:p(1)&#125;</code></li>
<li><code>cur=p(3),sum=4,hash=&#123;0:dummy,1:p(1),4:p(3)&#125;</code></li>
<li><code>cur=p(2),sum=6,hash=&#123;0:dummy,1:p(1),4:p(3),6:p(2)&#125;</code></li>
<li><code>cur=p(-3),sum=3,hash=&#123;0:dummy,1:p(1),4:p(3),6:p(2),3:p(-3)&#125;</code></li>
<li><code>cur=p(-2),sum=1</code>ï¼šæ­¤æ—¶hashè¿”å›p(1)ï¼Œè®©p(1).nextæŒ‡å‘p(-2).nextï¼Œé“¾è¡¨å˜ä¸ºäº†[1,5,5,-5,1]ï¼Œ<code>hash=&#123;0:dummy,1:p(1),4:p(3),6:p(2),3:p(-3)&#125;</code></li>
<li><code>cur=p(5),sum=6</code>ï¼šæ­¤æ—¶hashè¿”å›p(2)ï¼Œä½†æ­¤æ—¶p(2)å·²ç»åˆ é™¤ï¼Œå› æ­¤è®©p(2).nextæŒ‡å‘p(5).nextè‚¯å®šæ˜¯é”™çš„ã€‚</li>
</ol>
<p>è‡³æ­¤åº”è¯¥å¯ä»¥çœ‹å‡ºé—®é¢˜äº†ï¼šåœ¨åˆ é™¤æ”¹å˜é“¾è¡¨æŒ‡é’ˆçš„åŒæ—¶ï¼Œhashtableå¹¶æ²¡æœ‰åšç›¸åº”çš„åŒæ­¥åˆ æ‰å¯¹åº”çš„å…ƒç´ ï¼Œæ‰€ä»¥æ¯å½“å‡ºç°é‡å¤å‰ç¼€å’Œæ—¶åªè¦åˆ æ‰hashtableä¸­ä¸¤æ¬¡å‰ç¼€å’Œä¹‹é—´çš„é¡¹å³å¯ï¼Œå¯ä»¥å€ŸåŠ©<code>OrderedDict()</code>å®ç°ï¼ŒæŒ‰ç…§æ’å…¥é¡ºåºå³é“¾è¡¨é¡ºåºæœ‰åºï¼š</p>
<ol type="1">
<li><code>cur=p(-3),sum=3,hash=&#123;0:dummy,1:p(1),4:p(3),6:p(2),3:p(-3)&#125;</code></li>
<li><code>cur=p(-2),sum=1</code>ï¼šæ­¤æ—¶hash(1)è¿”å›p(1)ï¼Œåˆ é™¤åä¸º<code>hash=&#123;0:dummy,1:p(1)</code></li>
<li><code>cur=p(5),sum=6</code>ï¼šæ­¤æ—¶hashè¿”å›<code>None</code>ï¼Œç¬¦åˆé¢„æœŸï¼Œç»§ç»­è¿­ä»£å³å¯ã€‚</li>
</ol>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># Definition for singly-linked list.</span></span><br><span class="line"><span class="comment"># class ListNode:</span></span><br><span class="line"><span class="comment">#     def __init__(self, val=0, next=None):</span></span><br><span class="line"><span class="comment">#         self.val = val</span></span><br><span class="line"><span class="comment">#         self.next = next</span></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">Solution</span>:</span></span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">removeZeroSumSublists</span>(<span class="params">self, head: ListNode</span>) -&gt; ListNode:</span></span><br><span class="line">        dummy = ListNode(<span class="built_in">next</span>=head)</span><br><span class="line">        cur = head</span><br><span class="line">        prefix_sum = <span class="number">0</span></span><br><span class="line">        hashtable = OrderedDict(&#123;<span class="number">0</span>:dummy&#125;)</span><br><span class="line">        <span class="keyword">while</span> cur:</span><br><span class="line">            prefix_sum += cur.val</span><br><span class="line">            prev = hashtable.get(prefix_sum, cur)</span><br><span class="line">            <span class="keyword">while</span> prefix_sum <span class="keyword">in</span> hashtable:</span><br><span class="line">                hashtable.popitem()</span><br><span class="line">            hashtable[prefix_sum] = prev</span><br><span class="line">            prev.<span class="built_in">next</span> = cur = cur.<span class="built_in">next</span></span><br><span class="line">        <span class="keyword">return</span> dummy.<span class="built_in">next</span></span><br></pre></td></tr></table></figure>
<p>Two-passï¼š ä¸Šè¿°åšæ³•çš„hashtableè®°å½•çš„æ˜¯ç¬¬ä¸€æ¬¡å‡ºç°å‰ç¼€å’Œçš„ä½ç½®ã€‚ç°åœ¨æ¢ä¸€ç§æ€è·¯ï¼šé¦–å…ˆéå†ä¸€æ¬¡é“¾è¡¨ï¼Œhashtableè®°å½•<strong>æœ€åä¸€æ¬¡</strong>å‡ºç°å‰ç¼€å’Œçš„ä½ç½®ï¼Œç¬¬äºŒæ¬¡éå†é“¾è¡¨è®¾ç½®ç›¸åº”çš„æŒ‡é’ˆåˆ°æœ€åä¸€æ¬¡å‰ç¼€å’Œçš„ä½ç½®ï¼Œè¿™æ ·å³ä½¿ç¬¬ä¸€æ¬¡å‰ç¼€å’Œä½ç½®è¢«åˆ é™¤ï¼ŒæŒ‡é’ˆä¹Ÿä¼šç›¸åº”åœ°è·³è¿‡ï¼š</p>
<ol type="1">
<li>ç¬¬ä¸€æ¬¡éå†åï¼š<code>hash=&#123;0:dummy,1:p(-2),4:p(3),6:p(-5),3:p(-3),11:p(5),7:p(1)&#125;</code></li>
<li>ç¬¬äºŒæ¬¡éå†ï¼š<code>dummy.next=hash[0].next,p(1).next=hash[1].next=p(5),p(5).next=hash[6].next=p(1),p(1).next=hash[7].next=null</code></li>
</ol>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># Definition for singly-linked list.</span></span><br><span class="line"><span class="comment"># class ListNode:</span></span><br><span class="line"><span class="comment">#     def __init__(self, val=0, next=None):</span></span><br><span class="line"><span class="comment">#         self.val = val</span></span><br><span class="line"><span class="comment">#         self.next = next</span></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">Solution</span>:</span></span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">removeZeroSumSublists</span>(<span class="params">self, head: ListNode</span>) -&gt; ListNode:</span></span><br><span class="line">        dummy = ListNode(<span class="number">0</span>, head)</span><br><span class="line">        prefix_sum = <span class="number">0</span></span><br><span class="line">        hashtable = &#123;<span class="number">0</span>:dummy&#125;</span><br><span class="line">        <span class="keyword">while</span> head:</span><br><span class="line">            prefix_sum += head.val</span><br><span class="line">            hashtable[prefix_sum] = head</span><br><span class="line">            head = head.<span class="built_in">next</span></span><br><span class="line">            </span><br><span class="line">        prefix_sum = <span class="number">0</span></span><br><span class="line">        head = dummy</span><br><span class="line">        <span class="keyword">while</span> head:</span><br><span class="line">            prefix_sum += head.val</span><br><span class="line">            head.<span class="built_in">next</span> = hashtable[prefix_sum].<span class="built_in">next</span></span><br><span class="line">            head = head.<span class="built_in">next</span></span><br><span class="line">        <span class="keyword">return</span> dummy.<span class="built_in">next</span></span><br></pre></td></tr></table></figure>
<p>æ—¶é—´å¤æ‚åº¦<span class="math inline">\(O(n)\)</span>ï¼Œç©ºé—´å¤æ‚åº¦<span class="math inline">\(O(n)\)</span>ã€‚</p>

      
    </div>

    
    
    
      <footer class="post-footer">
        <div class="post-eof"></div>
      </footer>
  </article>
  
  
  

      
  
  
  <article itemscope itemtype="http://schema.org/Article" class="post-block" lang="en">
    <link itemprop="mainEntityOfPage" href="https://eimadrigal.github.io/2021/07/15/Research%20Proposal/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="image" content="/images/favicon.png">
      <meta itemprop="name" content="EIMadrigal">
      <meta itemprop="description" content="Hello World">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="EI Madrigal's Space">
    </span>
      <header class="post-header">
        <h2 class="post-title" itemprop="name headline">
          
            <a href="/2021/07/15/Research%20Proposal/" class="post-title-link" itemprop="url">Research Proposal</a>
        </h2>

        <div class="post-meta">

		  
            <span class="post-meta-item">
              <span class="post-meta-item-icon">
                <i class="far fa-calendar"></i>
              </span>
              <span class="post-meta-item-text">Posted on</span>

              <time title="Created: 2021-07-15 02:35:00" itemprop="dateCreated datePublished" datetime="2021-07-15T02:35:00+08:00">2021-07-15</time>
            </span>

          

        </div>
      </header>

    
    
    
    <div class="post-body" itemprop="articleBody">

      
          <h2 id="æ—¶é—´èŠ‚ç‚¹">æ—¶é—´èŠ‚ç‚¹</h2>
<ol type="1">
<li>å¼€é¢˜ç­”è¾©ï¼š11æœˆ20ç¬¬ä¸€æ‰¹ï¼Œ1.1ç¬¬äºŒæ‰¹</li>
<li>å®ä¹ ï¼š1.1ç¬¬ä¸€æ‰¹ï¼Œ3.1ç¬¬äºŒæ‰¹</li>
<li>è‡ªèº«å®‰æ’ï¼šç¬¬ä¸€æ‰¹å¼€é¢˜å¹¶ä¸”ç¬¬ä¸€æ‰¹å‡ºå»ã€‚ ä»9.25~12.31å…¨åŠ›ç§‘ç ”ï¼Œå®Œæˆåˆ›æ–°ç‚¹2ï¼Œå¹¶ä¸”å†™æˆæ¯•ä¸šè®ºæ–‡çš„æ ¼å¼ï¼›é›¶ç¢æ—¶é—´è‡ªå­¦æå‡ã€‚ 2022.1.1~2022.7.1å…¨éƒ¨ç”¨æ¥å®ä¹ ã€‚</li>
</ol>
<h2 id="åˆ›æ–°ç‚¹1">åˆ›æ–°ç‚¹1</h2>
<ol type="1">
<li>åŠ å…¥äº†é‡‡æ ·æ–¹æ³•çš„è‡ªåŠ¨é€‰æ‹©</li>
<li>ä»£ç†æ¨¡å‹å¯¹äºé«˜ç»´ç¨€ç–æ•°æ®çš„å¤„ç†XGBoost</li>
<li>Playouté˜¶æ®µçš„æ”¹è¿›</li>
</ol>
<ul class="task-list">
<li><input type="checkbox" disabled="" />
ä»£ç†æ¨¡å‹é‡‡ç”¨äºŒåˆ†ç±»å™¨ï¼Œç±»ä¼¼äºFBçš„paper</li>
<li><input type="checkbox" disabled="" />
pipelineï¼šé»˜è®¤configç»„æˆçš„pipelineçš„å½±å“ï¼ˆç»“åˆmeta-learningï¼‰ï¼›componentsåœ¨Treeä¸­çš„å±‚æ¬¡æœç´¢é¡ºåºï¼šåˆå§‹æ•°æ®é›†å‡åŒ€éšæœºé‡‡3ä¸ªï¼ŒåµŒå…¥å…ˆéªŒåˆ†å¸ƒï¼Œå¦‚<code>score_each_cl</code>é€šè¿‡å…ˆéªŒè¿›è¡Œä¿®æ­£</li>
</ul>
<h2 id="åˆ›æ–°ç‚¹2">åˆ›æ–°ç‚¹2</h2>
<ol type="1">
<li>æœç´¢è¿‡ç¨‹äº§ç”Ÿçš„configæŒ‰æŸç§ç­–ç•¥ï¼ˆåŠ¨æ€æ¨èï¼‰åšensemble</li>
<li>è¯„ä»·æŒ‡æ ‡æ¢ç”¨å…¶å®ƒç»¼åˆæŒ‡æ ‡ï¼Œé¿å…recall/precisionç­‰ç®€å•æŒ‡æ ‡ï¼ˆæ¥è¿‘æé™äº†ï¼‰ã€‚æ¢æŒ‡æ ‡çš„è¯å°±å¯ä»¥ç”¨KEELå’ŒImblearnçš„å¤§éƒ¨åˆ†æ•°æ®é›†ï¼Œä¸ç”¨å»æ‰¾å…¶ä»–çš„æˆ–è€…ç”¨å°‘æ•°ç±»æ•°ç›®ç­›é€‰</li>
</ol>
<ul class="task-list">
<li><input type="checkbox" disabled="" />
å»ºç«‹ä¸å¹³è¡¡æ•°æ®é›†çš„meta databaseä½œä¸ºwarm-startï¼ŒåŠ é€Ÿæœç´¢è¿‡ç¨‹</li>
<li><input type="checkbox" disabled="" />
ä½¿ç”¨banditç­‰ç­–ç•¥æ¥å¯¹æ—¶é—´åˆ†é…ç­–ç•¥è°ƒæ•´</li>
<li><input type="checkbox" disabled="" />
è€ƒè™‘ä»é»‘ç›’ä¼˜åŒ–è½¬ä¸ºç°ç›’ä¼˜åŒ–ï¼ˆMulti-fidelityä¼˜åŒ–ï¼‰ï¼Œå¦‚è®­ç»ƒé›†å­é›†ã€è§‚å¯Ÿå­¦ä¹ æ›²çº¿ç­‰</li>
<li><input type="checkbox" disabled="" />
æœ±è€å¸ˆè¯´çš„æŒ‰ç…§å…ƒç‰¹å¾å»æŒ‡å¯¼MCTSçš„æœç´¢æ–¹å‘ï¼Œæå‰å‰ªæç­‰</li>
<li><input type="checkbox" disabled="" />
å¤šåˆ†ç±»ä¸å¹³è¡¡æ•°æ®</li>
</ul>
<h2 id="æ¢ç´¢">æ¢ç´¢</h2>
<ul class="task-list">
<li><input type="checkbox" disabled="" />
AdaBoost/AdaBoost-MH/GBDT/XGBoost/LightGBMï¼ˆå·¥ä¸šç•Œç”¨çš„å¤šï¼‰ç­‰é›†æˆå­¦ä¹ ç”¨æ¥å¯¹åˆ†é”™çš„æ•°æ®é›†è¿›è¡Œæå‡</li>
<li><input type="checkbox" disabled="" />
æ¦‚ç‡å›¾æ¨¡å‹ï¼ˆæ¯ä¸ªæ•°æ®é›†å¯¹åº”çš„å¯èƒ½çš„ç®—æ³•æ˜¯ç”±æ¦‚ç‡å½¢å¼è¡¨ç°çš„ï¼‰ï¼š<span class="math inline">\(P(A_i|D)=\cfrac{P(D|A_i)P(A_i)}{P(D)}\)</span></li>
<li><input type="checkbox" disabled="" />
BO/CBO/SOO (ç»¼è¿°paper)</li>
<li><input type="checkbox" disabled="" />
é™¤äº†åŸºäºç²¾ç¡®åº¦å’Œæ—¶é—´çš„å¯¹æ¯”ï¼Œä½†æ˜¯å¾ˆå¤šæ—¶å€™æœç´¢é˜¶æ®µè¡¨ç°æœ€å¥½çš„ï¼Œåœ¨è¯„ä¼°é˜¶æ®µå¹¶ä¸æ˜¯æœ€å¥½çš„ï¼Œç”šè‡³å¯èƒ½è¡¨ç°å¾ˆå·®ã€‚ å› æ­¤ä¸€ç§ç”¨çš„æ¯”è¾ƒå¤šçš„å°±æ˜¯Kendall Tau metricï¼Œå®ƒä¼šè¯„ä¼°ä¸¤ä¸ªé˜¶æ®µæ¨¡å‹æ€§èƒ½çš„ç›¸å…³æ€§ï¼Œç›¸å…³æ€§è¶Šé«˜åˆ™è¡¨ç¤ºç®—æ³•è¶Šæœ‰æ•ˆ</li>
<li><input type="checkbox" disabled="" />
<strong>å¤šæ ·æœ¬</strong>ï¼šå›¾ç¥ç»ç½‘ç»œ==æ·±åº¦å­¦ä¹ é“¾æ¥é¢„æµ‹</li>
</ul>
<p>å¯èƒ½ç”±äºæ ·æœ¬é‡å¤ªå°‘ï¼Œç‰¹å¾å¤ªå¤šï¼Œå¯¼è‡´æ•°æ®ç¨€ç–ï¼Œç”¨ä½ç»´ç‰¹å¾å»åšåˆ†ç±»ï¼Œå…ƒç‰¹å¾é€‰æ‹©/é™ç»´</p>
<p>è‡´å‘½ç¼ºç‚¹ï¼šç®—æ³•æ€§èƒ½çš„å·®åˆ«å¯èƒ½æ˜¯ç”±äºæ•°æ®é›†è´¨é‡å†³å®šçš„ï¼Œè€Œä¸æ˜¯å…ƒç‰¹å¾çš„è´¨é‡ï¼Ÿï¼Ÿæ‰€ä»¥å…ƒç‰¹å¾è¿˜åº”æœ‰ä¸€ä¸ªè¡¡é‡æ•°æ®é›†è´¨é‡çš„ç‰¹å¾ï¼Ÿï¼Ÿ</p>
<h2 id="advice">Advice</h2>
<ul>
<li>ç°æœ‰æ–¹æ³•è½¯è‚‹ï¼Œé’ˆå¯¹æ€§ideaç¨³å¦¥ã€‚è®ºæ–‡è¦å¤šé—®<strong>ä¸ºä»€ä¹ˆ</strong>ï¼Œä¸ºä»€ä¹ˆç”¨è¿™ä¸ªæ¨¡å‹ï¼Œä¸ºä»€ä¹ˆåœ¨è¿™ç§æ•°æ®ä¸Šè¡¨ç°å¥½...</li>
<li>è¯»AutoML</li>
</ul>
<ol type="1">
<li>æˆ‘è¦è§£å†³çš„é—®é¢˜æ˜¯ä»€ä¹ˆï¼Ÿ</li>
<li>è¿™ä¸ªé—®é¢˜çš„éš¾ç‚¹åœ¨å“ªï¼Ÿ</li>
<li>åˆ«äººæ˜¯æ€ä¹ˆå¹²çš„ï¼Ÿä¸ºä»€ä¹ˆè¿™ä¹ˆå¹²ï¼Ÿæ•ˆæœæ€ä¹ˆæ ·ï¼Ÿè¿™ä¹ˆå¹²æœ‰ä»€ä¹ˆç¼ºé™·ï¼Ÿ</li>
<li>æˆ‘æ‰“ç®—æ€ä¹ˆå¹²ï¼Ÿä¸ºä»€ä¹ˆè¿™æ ·å¹²æ˜¯å¯¹çš„ï¼Ÿ</li>
<li>å®éªŒéªŒè¯ ## Next</li>
<li>å°æ•°æ®é›†ã€GNN(Graphsage/pinsage/gatï¼ŒGCN/Deepwalkä¸èƒ½ç”¨)ã€æ–°ç‰¹å¾è¡¨ç¤ºã€KNN æ¯æ¬¡æ¥ä¸€ä¸ªæ–°çš„æµ‹è¯•æ•°æ®é›†ï¼Œå°±åŠ å…¥å›¾ä¸­ï¼ŒåŠ¨æ€å¢é•¿å˜åŒ–çš„æ¨¡å‹</li>
<li>å¤§æ•°æ®é›†ã€GraphSage/DNNå˜ä¸ºå¤šæ ‡ç­¾åˆ†ç±»{A1 A2...}</li>
<li>DRL</li>
</ol>
<h2 id="tricks">Tricks</h2>
<ul>
<li>æ›´æ”¹UCIé—®é¢˜æ•°æ®é›†</li>
<li>çœ‹çœ‹æœ€ç»ˆçš„å…ƒæ¨¡å‹åœ¨å“ªäº›æ•°æ®é›†è¡¨ç°ä¸ä½³ï¼Œé€‚å½“æ›¿æ¢æ•°æ®é›†</li>
</ul>
<h2 id="now">Now</h2>
<ol type="1">
<li>å¯¹äºä¸å¹³è¡¡æ•°æ®é›†ï¼Œéœ€è¦é‡‡æ ·è¿›è¡Œé¢„å¤„ç†ï¼Œæ¨èåˆé€‚çš„é‡‡æ ·çš„ç®—æ³•åŠå…¶è¶…å‚æ•°ï¼ˆé‡‡æ ·æ¯”ä¾‹ç­‰ï¼‰</li>
<li>GNNå¯¹åŸå§‹æ•°æ®é›†æç‰¹å¾ï¼Œè¦æ±‚æ•°æ®é›†ç‰¹å¾æ•°ç›®ç›¸åŒï¼Œå¯èƒ½è¦é™ç»´ç­‰</li>
</ol>
<h2 id="å›¾ç¥ç»ç½‘ç»œ">å›¾ç¥ç»ç½‘ç»œ</h2>
<p>å›¾ç¥ç»ç½‘ç»œå•†å“æ¨èéå¸¸å‡†ç¡®ï¼šç”¨æˆ·å’Œäº§å“é—´çš„äº¤äº’ <img src="https://img-blog.csdnimg.cn/20210117170914563.png" alt="åœ¨è¿™é‡Œæ’å…¥å›¾ç‰‡æè¿°" /></p>
<ul>
<li>å›¾å·ç§¯ç½‘ç»œGCN</li>
<li>å›¾æ³¨æ„åŠ›ç½‘ç»œGAN</li>
<li>å›¾è‡ªç¼–ç å™¨</li>
<li>å›¾ç”Ÿæˆç½‘ç»œ</li>
<li>å›¾æ—¶ç©ºç½‘ç»œ</li>
</ul>
<p>å›¾ç»“æ„ä¿¡æ¯ï¼šç»å…¸çš„DNNã€RNNã€CNNå¤„ç†æ•ˆæœä¸å¥½</p>
<p>ç¤¾äº¤ç½‘ç»œï¼ˆç”¨æˆ·ã€å…³ç³»ï¼‰ ç”µå­è´­ç‰©ï¼ˆç”¨æˆ·ã€å•†å“ï¼‰ åŒ–å­¦åˆ†å­ï¼ˆåŸå­ã€åŒ–å­¦é”®ï¼‰</p>
<p>å¤šæ ‡ç­¾çš„GNNï¼Ÿå¼‚æ„å›¾çš„GNNï¼Ÿ</p>
<p>æ•°æ®ï¼šMultiKNNé‚£ç¯‡æ–‡ç« ç”Ÿæˆæ•°æ®é›†çš„æ–¹æ³•</p>
<p>æ¬§å‡ é‡Œå¾—æ•°æ®ï¼šå›¾åƒã€æ–‡æœ¬ã€è§†é¢‘</p>
<p>MLå‡è®¾æ ·æœ¬ç‹¬ç«‹ï¼Œå›¾æ•°æ®ä¸æ»¡è¶³ <img src="https://img-blog.csdnimg.cn/20210118155146919.png" alt="åœ¨è¿™é‡Œæ’å…¥å›¾ç‰‡æè¿°" /> ç½‘ç»œåµŒå…¥ï¼šä¿ç•™ç½‘ç»œæ‹“æ‰‘æ¶æ„å’Œç»“ç‚¹å†…å®¹ä¿¡æ¯ï¼Œå°†ç½‘ç»œé¡¶ç‚¹è¡¨ç¤ºåˆ°ä½ç»´å‘é‡ç©ºé—´ï¼Œä½¿å¾—åç»­çš„åˆ†ç±»ã€èšç±»ã€æ¨èä½¿ç”¨ç®€å•çš„ç®—æ³•å³å¯å®Œæˆï¼š</p>
<ul>
<li>çŸ©é˜µåˆ†è§£</li>
<li>éšæœºæ¸¸èµ°</li>
<li>æ·±åº¦å­¦ä¹ ï¼šåŒæ—¶å±äºGNN</li>
</ul>
<figure>
<img src="https://img-blog.csdnimg.cn/20210118185948765.png" alt="" /><figcaption>åœ¨è¿™é‡Œæ’å…¥å›¾ç‰‡æè¿°</figcaption>
</figure>
<p>æŠ½ç‰¹å¾åï¼Œæ–°çš„æ•°æ®é›†å¯èƒ½å’Œå†å²æ•°æ®é›†æœ‰è”ç³»ï¼Œå³å’Œå›¾ä¸­çš„æŸäº›ç»“ç‚¹æœ‰å¸¦æƒè¾¹ï¼Œå¯ä»¥ç”¨GCNä»é‚»åŸŸèšåˆç‰¹å¾ä¿¡æ¯ã€‚</p>
<ul>
<li>GCNï¼š</li>
<li>å›¾æ³¨æ„åŠ›ç½‘ç»œï¼šé‡è¦çš„ç»“ç‚¹ä¼šæœ‰æ›´å¤§çš„æƒå€¼ï¼Œåœ¨èšåˆç‰¹å¾ä¿¡æ¯æ—¶å‘ä¸åŒè¿‘é‚»åˆ†é…æ³¨æ„åŠ›æƒé‡ã€æ ¹æ®æ³¨æ„åŠ›æƒé‡é›†æˆå¤šä¸ªæ¨¡å‹ï¼Œä»¥åŠä½¿ç”¨æ³¨æ„åŠ›æƒé‡å¼•å¯¼éšæœºæ¸¸èµ°</li>
</ul>
<p>ä¼ ç»Ÿæ·±åº¦å­¦ä¹ åŠ å±‚ä¼šå¸¦æ¥æ•ˆæœçš„æå‡ï¼Œä½†æ˜¯ç ”ç©¶è¡¨æ˜ï¼šå›¾ç½‘ç»œéšç€å±‚æ•°å¢åŠ ï¼Œæ€§èƒ½æ€¥å‰§ä¸‹é™ï¼› ä¸èƒ½æ‰©å±•åˆ°å¤§å‹å›¾ï¼›</p>
<h2 id="graph-embedding">Graph embedding</h2>
<p>å‘ç°é«˜ç»´å›¾çš„ä½ç»´å‘é‡è¡¨ç¤º <img src="https://img-blog.csdnimg.cn/20210119101906372.png" alt="åœ¨è¿™é‡Œæ’å…¥å›¾ç‰‡æè¿°" /></p>
<p>å¼‚æ„å›¾GNNï¼Œç®—æ³•ç»“ç‚¹çš„ç‰¹å¾ç©ºé—´å¯ä»¥è€ƒè™‘ç®—æ³•æœ¬èº«çš„æ€§è´¨ç­‰ï¼Ÿ</p>

      
    </div>

    
    
    
      <footer class="post-footer">
        <div class="post-eof"></div>
      </footer>
  </article>
  
  
  

      
  
  
  <article itemscope itemtype="http://schema.org/Article" class="post-block" lang="en">
    <link itemprop="mainEntityOfPage" href="https://eimadrigal.github.io/2021/07/14/%E5%85%B3%E4%BA%8E%E8%81%8C%E4%B8%9A%E5%8F%91%E5%B1%95%E7%9A%84%E8%80%83%E8%99%91/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="image" content="/images/favicon.png">
      <meta itemprop="name" content="EIMadrigal">
      <meta itemprop="description" content="Hello World">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="EI Madrigal's Space">
    </span>
      <header class="post-header">
        <h2 class="post-title" itemprop="name headline">
          
            <a href="/2021/07/14/%E5%85%B3%E4%BA%8E%E8%81%8C%E4%B8%9A%E5%8F%91%E5%B1%95%E7%9A%84%E8%80%83%E8%99%91/" class="post-title-link" itemprop="url">å…³äºèŒä¸šå‘å±•çš„è€ƒè™‘</a>
        </h2>

        <div class="post-meta">

		  
            <span class="post-meta-item">
              <span class="post-meta-item-icon">
                <i class="far fa-calendar"></i>
              </span>
              <span class="post-meta-item-text">Posted on</span>

              <time title="Created: 2021-07-14 03:22:00" itemprop="dateCreated datePublished" datetime="2021-07-14T03:22:00+08:00">2021-07-14</time>
            </span>

          

        </div>
      </header>

    
    
    
    <div class="post-body" itemprop="articleBody">

      
          <p>äº‹æƒ…ç¼˜ç”±æ˜¯è¿™æ ·çš„ï¼šè‡ªä»äºŒæˆ˜ä»¥åï¼Œæˆ‘ä¸ªäººå¯¹æœªæ¥èŒä¸šä¸Šçš„äº‹å°±æ·¡ç„¶å¤„ä¹‹äº†ï¼Œæ›´åŠ å…³æ³¨ç”Ÿæ´»æ–¹é¢çš„å¹¸ç¦æ„Ÿï¼Œè¿™å…¶å®ä¹Ÿæ²¡æœ‰å¤ªå¤§çš„è¿‡é”™ï¼Œè€Œä¸”æˆ‘è‡ªå·±æ„Ÿè§‰è¿™äº›æ—¶é—´æ€»ä½“ä¸Šè¿˜æ˜¯è¶Šæ¥è¶Šhappieräº†ã€‚</p>
<p>å‰æ®µæ—¶é—´æœ‰å¥½æœ‹å‹æ‹¿åˆ°Google Seattleçš„offerï¼Œåˆæœ‰æœ‹å‹è¦å»UCSDè¿½å¯»å­¦æœ¯æ¢¦æƒ³äº†ï¼Œå†æƒ³æƒ³è®¸å¤šæœ‹å‹éƒ½åœ¨å›½å¤–æ··å¾—é£ç”Ÿæ°´èµ·ï¼Œè§‰å¾—è‡ªå·±ä¹Ÿä¸èƒ½å¤ªå’¸é±¼å§ï¼Œæˆ‘è‡ªå·±æ¸…æ¥šè¿™å¹¶ä¸æ˜¯ä¸åˆ«äººæ¯”è¾ƒï¼Œè€Œæ˜¯åœ¨åŸºæœ¬ç‰©è´¨å¾—ä¸åˆ°æ»¡è¶³çš„æƒ…å†µä¸‹ï¼Œæœªæ¥çš„ç°å®ç”Ÿæ´»å¹¶æ²¡æœ‰æƒ³è±¡ä¸­çš„é‚£ä¹ˆidealï¼Œå°¤å…¶æ˜¯æˆ‘è¿™ç§æ¡ä»¶ã€‚</p>
<p>æ‰€ä»¥æˆ‘å¸Œæœ›æ›´åŠ ç»†åŒ–è‡ªå·±çš„èŒä¸šè§„åˆ’ï¼Œå¹¶ä¸”ç»“åˆå½“å‰çš„ç°å®æƒ…å†µåˆ¶å®šä¸‹ä¸€æ­¥çš„å…·ä½“æªæ–½ã€‚</p>
<ol type="1">
<li>é‡è§†æ€æƒ³è®¤è¯† ä¸€æ–¹é¢ï¼Œè¦è¶³å¤Ÿé‡è§†æ‰¾å·¥ä½œå¯¹æœªæ¥ç”Ÿæ´»çš„å½±å“ï¼Œå¯ä»¥é€‚å½“ç‰ºç‰²ä¸€äº›å½“å‰ç”Ÿæ´»çš„å¹¸ç¦æŒ‡æ•°ï¼›å¦ä¸€æ–¹é¢ï¼Œè¦æ·±åˆ»è®¤è¯†åˆ°æ—¶é—´å¹¶ä¸å……è£•ï¼Œæ»¡æ‰“æ»¡ç®—ä¹Ÿå°±ä¸€å¹´ï¼Œå°¤å…¶è‡ªå·±è¿˜æ˜¯æ²¡ä»€ä¹ˆå¤©èµ‹çš„éç§‘ç­é€‰æ‰‹ã€‚ High expectationå¹¶ä¸ä¼šå¸¦æ¥å¤ªå¤§çš„å¤±æœ›ï¼Œlearn to fail or fail to learnã€‚ åœ¨ä¸æŠŠè‡ªå·±é™åˆ¶æ­»çš„å‰æä¸‹ï¼Œç›®å‰å¤§çš„æ–¹å‘å°±æ˜¯å»äº’è”ç½‘ï¼ˆåŒ…æ‹¬é“¶è¡Œã€å›½ä¼ã€fin-techï¼‰æˆ–è€…å»é«˜ä¸­æ•™å¸ˆã€‚</li>
<li>åˆ†æç°å®æƒ…å†µ 2.1 å®éªŒå®¤ï¼šé¦–å…ˆå°±æ˜¯è®¤æ¸…ç›®å‰çš„å¢ƒé‡ï¼šåœ¨è¿™ä¸ªå­¦æ ¡çš„å½“å‰è¿™ä¸ªå®éªŒå®¤é å‘é¡¶ä¼šè®ºæ–‡æ‰¾åˆ°å¥½å·¥ä½œçš„å¯èƒ½å‡ ä¹æ²¡æœ‰ï¼Œå› æ­¤åªèƒ½é€šè¿‡è‡ªå­¦å’Œå®ä¹ æ¥å¢åŠ æ‰¾åˆ°å¥½å·¥ä½œçš„å‡ ç‡ï¼›è€å¸ˆçš„ç›®æ ‡å’Œè‡ªèº«ç›®æ ‡åœ¨æŸäº›æ–¹é¢æ˜¯ä¸€è‡´çš„ï¼ˆå¦‚æ¯•ä¸šï¼‰ï¼Œä½†æ˜¯åœ¨å¾ˆå¤šæ–¹é¢æ˜¯æœ‰å¾ˆå¤§å†²çªçš„ï¼ˆè€å¸ˆå¸Œæœ›å‘å¥½æ–‡ç« ä¿ä½é¥­ç¢—æˆ–è€…å¹²é¡¹ç›®ï¼Œæˆ‘å¸Œæœ›ç”¨æ›´å¤šæ—¶é—´å»å‡†å¤‡å·¥ä½œï¼‰ï¼Œæ‰€ä»¥ä¸èƒ½ä¸€å‘³å¬ä»è€å¸ˆçš„å¿½æ‚ ï¼Œä¸è¦æŠŠæ³¨æ„åŠ›è¿‡äºæ”¾åœ¨è€å¸ˆèº«ä¸Šï¼Œè¦æœ‰è‡ªå·±æ¸…é†’çš„åˆ¤æ–­ï¼šä½ æœ€ç»ˆæ‰¾åˆ°ä»€ä¹ˆæ ·çš„å·¥ä½œè€å¸ˆå‹æ ¹ä¸ä¼šå…³å¿ƒï¼Œä»–ä»¬åªä¼šæŠ¢ä½ çš„ä¸€ä½œã€‚å¦å¤–ï¼Œä¸å¿…å¤ªè¿‡æ‹…å¿ƒæ¯•ä¸šçš„äº‹æƒ…ï¼ŒæŒ‰ç…§è‡ªèº«çš„æ°´å¹³å’ŒXJTUçš„å°¿æ€§ï¼Œæ­£å¸¸æ¯•ä¸šåº”è¯¥é—®é¢˜ä¸å¤ªå¤§ã€‚ 2.2 åšå£«ï¼šä¸è¦è¢«å‘¨å›´çš„åšå£«è’™è”½ï¼Œæˆ‘è‡ªå·±æš‚æ—¶ç»æ²¡æœ‰è¯»åšçš„æ‰“ç®—ï¼Œå› æ­¤åœ¨ç§‘ç ”é—®é¢˜ä¸Šæ²¡å¿…è¦è¾ƒçœŸï¼Œå¹³æ—¶çš„è®¨è®ºä¹Ÿè¦æ³¨æ„è‡ªå·±çš„å®šä½ã€‚è€Œä¸”ä»ç›®å‰æ¥çœ‹ï¼šå‘¨å›´ç¯å¢ƒä¸‹çš„åšå£«åšçš„ä¹ŸåŸºæœ¬æ˜¯åƒåœ¾ã€‚å½“ç„¶å¹¶ä¸æ’é™¤å·¥ä½œå‡ å¹´åå‡ºå›½è¯»åš/å›½å†…ä¼˜ç§€å¯¼å¸ˆè¯»åšçš„å¯èƒ½æ€§ï¼Œè™½ç„¶ç›®å‰æ¥çœ‹è¿™ç§å¯èƒ½æ€§å¹¶ä¸å¤§ã€‚ 2.3 å·¥ä½œï¼ˆåŠªåŠ›ï¼‰æ–¹å‘ï¼šé«˜ä¸­æ•™å¸ˆåŒ…æ‹¬æ•°å­¦å’Œè®¡ç®—æœºçš„å¯èƒ½æ€§ï¼Œè®¡ç®—æœºçš„æ•™èµ„è¦å°½å¿«æ‹¿åˆ°ï¼Œåˆ°æ—¶å€™æ‰¾å·¥ä½œå¯ä»¥ç›´æ¥å»é¢è¯•ï¼Œè¿™ä¸€ç‚¹å¯ä»¥ä½œä¸ºå¤‡é€‰æ–¹æ¡ˆï¼Œå±Šæ—¶è¿›è¡Œofferæ¯”è¾ƒï¼› äº’è”ç½‘çš„æ–¹å‘å°±æ˜¯ç®—æ³•å’Œå¼€å‘ï¼šé¦–å…ˆè‡ªèº«æš‚æ—¶å€¾å‘äºç®—æ³•å²—ï¼Œæ‰¾å®ä¹ /å·¥ä½œæ—¶å¦‚æœè¿‡äºå›°éš¾å°±è½¬å¼€å‘ã€‚å¼€å‘è¿™è¾¹ç›®å‰å·²ç»ç§¯ç´¯äº†ä¸€äº›é¡¹ç›®ï¼Œä½†ä»æœ‰å¾ˆå¤šè–„å¼±ç‚¹ï¼ˆå¦‚javaï¼‰ï¼›ç®—æ³•ç›®å‰æ²¡æœ‰é¡¹ç›®ï¼Œè¦è¿…é€Ÿæ‰¾ä¸€äº›<strong>è¾ƒå¤§</strong>çš„é¡¹ç›®/æ¯”èµ›å®Œæˆï¼ŒåŒæ—¶è¿˜è¦æ‰“ç£¨è‡ªå·±å¼€å‘ä¸Šçš„ç§¯ç´¯ï¼Œ<strong>å¦‚æ­¤çœ‹æ¥æ—¶é—´æ›´åŠ ç´§è¿«</strong>ã€‚ ç›®æ ‡å°±æ˜¯èƒ½æ‹¿åˆ°å¾®è½¯æˆ–è€…å›½å†…å¤§å‚spè¿™ä¸€æ¡£çš„offerã€‚</li>
<li>å…·ä½“æªæ–½ 3.1 hard workï¼šä¸è®ºæ˜¯å„ä½å‰è¾ˆè¿˜æ˜¯å“ˆä½›çš„è¯¾éƒ½åœ¨å¼ºè°ƒè¿™ç‚¹ï¼Œè¿™åŒæ—¶ä¹Ÿæ„å‘³ç€è¦å‡å°‘ä¸å¿…è¦çš„å¨±ä¹æ—¶é—´ï¼ˆçœ‹bç«™ã€å¤§é‡å¤–å‡ºåƒé¥­å”±æ­Œç­‰ï¼‰ï¼Œå½“ç„¶è¿™å¹¶ä¸æ„å‘³ç€ä¸é”»ç‚¼æˆ–è€…ä½æ•ˆå­¦ä¹ ï¼Œè€Œæ˜¯è¦å¢åŠ é«˜æ•ˆå­¦ä¹ çš„æ—¶é—´ã€‚ 3.2 ç§‘ç ”ä¸è‡ªå­¦çš„å¹³è¡¡ï¼šç§‘ç ”åªè¦è¾¾åˆ°å¤–å‡ºå®ä¹ å’Œæ¯•ä¸šçš„æœ€ä½è¦æ±‚å°±è¡Œï¼Œä¸è¦å¤ªè¾ƒçœŸï¼ŒæŠ±ç€å·®ä¸å¤šå°±è¡Œäº†çš„æ€åº¦ï¼Œä¸è¦æƒ³ç€åšå‡ºé¡¶ä¼šçº§çš„æˆæœï¼Œ<strong>ä½†æ˜¯é¦–å…ˆè¦é›†ä¸­ç²¾åŠ›æ°´å‡ºä¸€ç¯‡åƒåœ¾ä»¥è·å¾—å¤–å‡ºå®ä¹ çš„æœºä¼š</strong>ï¼›è‡ªå­¦ä¸€å®šè¦è¶³å¤Ÿæ•¬ç•å’Œè®¤çœŸï¼Œæ‰æ‰å®å®æ¨è¿›ã€‚ 3.3 è‡ªå­¦ï¼šè¿™æ–¹é¢çš„å…·ä½“æªæ–½å·²ç»å†™åœ¨åšå®¢é‡Œï¼Œä¸å†èµ˜è¿°ã€‚</li>
</ol>

      
    </div>

    
    
    
      <footer class="post-footer">
        <div class="post-eof"></div>
      </footer>
  </article>
  
  
  

      
  
  
  <article itemscope itemtype="http://schema.org/Article" class="post-block" lang="en">
    <link itemprop="mainEntityOfPage" href="https://eimadrigal.github.io/2021/07/10/Optimization%20Methods%20in%20Deep%20Learning/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="image" content="/images/favicon.png">
      <meta itemprop="name" content="EIMadrigal">
      <meta itemprop="description" content="Hello World">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="EI Madrigal's Space">
    </span>
      <header class="post-header">
        <h2 class="post-title" itemprop="name headline">
          
            <a href="/2021/07/10/Optimization%20Methods%20in%20Deep%20Learning/" class="post-title-link" itemprop="url">Optimization Methods in Deep Learning</a>
        </h2>

        <div class="post-meta">

		  
            <span class="post-meta-item">
              <span class="post-meta-item-icon">
                <i class="far fa-calendar"></i>
              </span>
              <span class="post-meta-item-text">Posted on</span>

              <time title="Created: 2021-07-10 11:47:00" itemprop="dateCreated datePublished" datetime="2021-07-10T11:47:00+08:00">2021-07-10</time>
            </span>

          

        </div>
      </header>

    
    
    
    <div class="post-body" itemprop="articleBody">

      
          <h2 id="background">Background</h2>
<p>æ·±åº¦ç¥ç»ç½‘ç»œçš„è®­ç»ƒè¿‡ç¨‹ä¸»è¦é€šè¿‡æ±‚è§£ä¸€ä¸ªç‰¹å®šçš„ä¼˜åŒ–é—®é¢˜æ¥å®ç°ï¼Œç„¶è€Œç”±äºè¯¥é—®é¢˜æ˜¯ä¸€ä¸ªå¤æ‚çš„é«˜ç»´éçº¿æ€§ä¼˜åŒ–é—®é¢˜ï¼Œå¹¶ä¸”ä¸åŒçš„ç½‘ç»œç»“æ„å·®å¼‚å¾ˆå¤§ï¼Œä¸èƒ½å°†ä¼ ç»Ÿçš„ä¼˜åŒ–æ–¹æ³•ç›´æ¥ä½¿ç”¨ã€‚å³ä½¿æ•°æ®é›†å’Œç½‘ç»œç»“æ„å®Œå…¨ç›¸åŒï¼Œä¸åŒçš„ä¼˜åŒ–ç®—æ³•ä¹Ÿå¯èƒ½å¯¼è‡´å®Œå…¨ä¸åŒçš„æ”¶æ•›æ•ˆæœã€‚å®é™…åº”ç”¨çš„ä¸€äº›ç®€å•æ–¹æ³•è™½ç„¶è¡Œä¹‹æœ‰æ•ˆï¼Œä½†ç°æœ‰ç†è®ºæ— æ³•å……åˆ†è§£é‡Šå…¶æœ‰æ•ˆæ€§ï¼Œè¶…å‚æ•°çš„ä¸æ–­å¢åŠ ä¹Ÿç»™ä¼˜åŒ–å¢åŠ äº†ä¸å°‘éš¾åº¦ã€‚å¦‚ä½•ç¡®ä¿ç®—æ³•æ”¶æ•›ã€å¦‚ä½•å°½å¿«æ”¶æ•›ä»¥åŠèƒ½å¦æ”¶æ•›åˆ°å…¨å±€æœ€ä¼˜ä¸€ç›´æ˜¯å›°æ‰°å­¦æœ¯ç•Œå’Œå·¥ä¸šç•Œçš„é—®é¢˜ã€‚å¦‚æœèƒ½å¤Ÿç”¨ä¼˜åŒ–ç†è®ºå»è§£é‡Šç¥ç»ç½‘ç»œçš„è®­ç»ƒè¡Œä¸ºï¼Œå¯¹äºæ·±åº¦å­¦ä¹ çš„æ¨å¹¿åº”ç”¨å°†ä¼šèµ·åˆ°å·¨å¤§çš„æ¨åŠ¨ä½œç”¨ã€‚</p>
<p>å¯¹äºæœ‰ç›‘ç£å­¦ä¹ ï¼Œç»™å®šåŒ…å«nä¸ªæ ·æœ¬çš„è®­ç»ƒé›†<span class="math inline">\(\{(\mathbf{x}_1, y_1), \ldots, (\mathbf{x}_n, y_n)\}\)</span>ï¼Œ<span class="math inline">\(\mathbf{x}\)</span>è¡¨ç¤ºæ ·æœ¬çš„ç‰¹å¾å‘é‡ï¼Œ<span class="math inline">\(y\)</span>è¡¨ç¤ºè¯¥æ ·æœ¬å¯¹åº”çš„æ ‡ç­¾ã€‚æˆ‘ä»¬çš„ä»»åŠ¡æ˜¯åˆ©ç”¨æ ·æœ¬ä¿¡æ¯æ¥é¢„æµ‹ç›¸åº”çš„æ ‡ç­¾ï¼Œä½¿é¢„æµ‹å€¼å°½å¯èƒ½æ¥è¿‘çœŸå®æ ‡ç­¾ã€‚å¦‚æœç”¨æ·±åº¦å­¦ä¹ æ¥å®Œæˆè¿™ä¸ªä»»åŠ¡ï¼Œå°±éœ€è¦é€šè¿‡è°ƒæ•´ç¥ç»ç½‘ç»œçš„å‚æ•°ï¼ˆæƒé‡Wå’Œåå·®bï¼‰æ¥è¿‘ä¼¼æ•°æ®èƒŒåçš„å‡½æ•°æ˜ å°„å…³ç³»ï¼Œè¿™ä¸ªå…³ç³»å¾€å¾€æ˜¯é«˜åº¦éçº¿æ€§çš„ï¼Œç½‘ç»œè¶Šæ·±è¡¨è¾¾èƒ½åŠ›ä¹Ÿå°±è¶Šå¼ºï¼Œé€¼è¿‘æ•ˆæœçš„ç²¾åº¦ä¹Ÿå°±æ›´é«˜ï¼Œå› æ­¤ç½‘ç»œç»“æ„å¾ˆå¯èƒ½æ˜¯æå…¶å¤æ‚çš„ã€‚</p>
<p>ä¸ºäº†è¡¡é‡é¢„æµ‹å€¼å’ŒçœŸå®å€¼ä¹‹é—´çš„æ¥è¿‘ç¨‹åº¦ï¼Œé€šå¸¸éœ€è¦é‡‡ç”¨æŸç§è·ç¦»åº¦é‡æ–¹å¼<span class="math inline">\(l\)</span>ï¼Œ<span class="math inline">\(l\)</span>ä¸€èˆ¬è®¾è®¡ä¸º<strong>å¯å¾®</strong>çš„ï¼Œæ¥ç€ç”¨ä¸€äº›ä¼˜åŒ–ç®—æ³•å»æœ€å°åŒ–è¯¥ç›®æ ‡å‡½æ•°ã€‚å› æ­¤ä¼˜åŒ–é—®é¢˜å˜ä¸ºå¯»æ‰¾æœ€ä½³çš„å‚æ•°ä½¿å¾—<span class="math inline">\(l\)</span>æœ€å°ï¼Œåœ¨ä¸è€ƒè™‘æ­£åˆ™é¡¹çš„æƒ…å†µä¸‹æœ‰ï¼š <span class="math display">\[
\mathop{\mathrm{min}}_f \frac{1}{n} \sum_{i=1}^n l(f(\mathbf{x}_i), y_i)
\]</span> <span class="math inline">\(f\)</span>å°±æ˜¯æˆ‘ä»¬ä»è¾“å…¥åˆ°è¾“å‡ºçš„æ˜ å°„å‡½æ•°ï¼Œ<span class="math inline">\(l\)</span>é€šå¸¸ä¹Ÿå«æŸå¤±å‡½æ•°ï¼Œè¡¡é‡é¢„æµ‹å€¼<span class="math inline">\(f(x_i)\)</span>å’ŒçœŸå®æ ‡ç­¾<span class="math inline">\(y_i\)</span>çš„å·®è·ï¼Œæ¯”å¦‚å›å½’é—®é¢˜ä¸­ç»å¸¸ä½¿ç”¨çš„å¹³æ–¹æŸå¤±å‡½æ•°<span class="math inline">\(l=||f(x_i)-y_i||^2\)</span>ã€‚</p>
<p>éœ€è¦æ³¨æ„çš„æ˜¯ï¼šæ·±åº¦å­¦ä¹ ä¸­çš„ä¼˜åŒ–é—®é¢˜ä¸ä¼ ç»Ÿæ„ä¹‰ä¸Šçš„ä¼˜åŒ–é—®é¢˜æœ‰æ‰€å·®åˆ«ã€‚ä¼ ç»Ÿçš„ä¼˜åŒ–é—®é¢˜éœ€è¦å°½å¯èƒ½æ‰¾åˆ°ç›®æ ‡å‡½æ•°çš„æœ€å€¼ï¼Œè€Œæ·±åº¦å­¦ä¹ çš„æœ€ç»ˆç›®çš„æ˜¯ä¸ºäº†<strong>é¢„æµ‹æœªçŸ¥</strong>çš„æ•°æ®ï¼Œè€Œä¸æ˜¯å°†è®­ç»ƒæ•°æ®ä¸Šçš„æŸå¤±é™åˆ°æœ€ä½ã€‚æˆ‘ä»¬å®šä¹‰çš„æŸå¤±å‡½æ•°<span class="math inline">\(J(\Theta)\)</span>è¡¡é‡çš„æ˜¯å½“å‰æ¨¡å‹å‚æ•°<span class="math inline">\(\Theta\)</span>åœ¨<strong>è®­ç»ƒé›†</strong>ä¸Šçš„ä¼˜åŠ£ï¼Œç„¶è€Œï¼Œæœ€å°åŒ–è®­ç»ƒè¯¯å·®å¹¶ä¸æ„å‘³ç€æ¨¡å‹çš„æ³›åŒ–è¯¯å·®ä¹Ÿä¼šæœ€å°ï¼Œä¸ºäº†é™ä½æ³›åŒ–è¯¯å·®æˆ‘ä»¬è¿˜éœ€è¦å…³æ³¨è¿‡æ‹Ÿåˆé—®é¢˜ï¼Œå› æ­¤æŸå¤±å‡½æ•°å¾€å¾€è¦åŠ ä¸Š<strong>æ­£åˆ™é¡¹</strong>ã€‚ç»Ÿè®¡å­¦ä¸Šç§°ä¸ºç»éªŒé£é™©æœ€å°åŒ–ï¼Œå³ç”±äºæ— æ³•è·å¾—å…¨éƒ¨æ•°æ®ï¼Œæ‰€ä»¥åªèƒ½ç”¨ç»éªŒé£é™©ä½œä¸ºå®é™…é£é™©çš„è¿‘ä¼¼ã€‚éå¸¸æœ‰æ„æ€çš„æ˜¯ï¼šå°½ç®¡å¤§å¤šæ•°ç¥ç»ç½‘ç»œéƒ½æ˜¯ä¸¥é‡è¿‡å‚æ•°åŒ–çš„ï¼Œä½†æ˜¯åè€Œæœ‰ç€æ¯”è¾ƒä¸é”™çš„æ³›åŒ–èƒ½åŠ›ï¼Œè¿™ä¸ä¼ ç»Ÿçš„æœºå™¨å­¦ä¹ è§‚ç‚¹æ˜¯çŸ›ç›¾çš„ï¼Œæ³›åŒ–ç†è®ºä¹Ÿéœ€è¦æ›´åŠ æ·±å…¥çš„ç ”ç©¶ã€‚</p>
<p>æ·±åº¦å­¦ä¹ ä¸­çš„<span class="math inline">\(f\)</span>é€šå¸¸æ˜¯å¤šå±‚çš„å¤åˆå‡½æ•°ï¼Œç”±äºå¤ªå¤æ‚è€Œæ— æ³•æ±‚å‡ºè§£æè§£ï¼Œæ‰€ä»¥è¦ç”¨æ•°å€¼ä¼˜åŒ–ç®—æ³•å»æ±‚è§£ã€‚å®é™…ä¸­ä¸»æµçš„æ·±åº¦å­¦ä¹ ä¼˜åŒ–ç®—æ³•éƒ½åˆ©ç”¨æ¢¯åº¦ä¸‹é™æ¥æ±‚è§£ï¼Œæ¢¯åº¦ä¸‹é™æ˜¯æ·±åº¦å­¦ä¹ ä¼˜åŒ–ç®—æ³•çš„åŸºç¡€ï¼Œå°½ç®¡ç›®å‰å·²ç»å¾ˆå°‘ç›´æ¥ä½¿ç”¨ï¼Œä½†å®ƒå´æ˜¯å…¶ä»–é«˜çº§ä¼˜åŒ–ç®—æ³•çš„åŸºçŸ³ï¼š å‡è®¾ç½‘ç»œçš„å‚æ•°ä¸º<span class="math inline">\(x=(x_1,x_2,...,x_d)^T\)</span>ï¼Œä¼˜åŒ–çš„ç›®æ ‡å‡½æ•°ä¸º<span class="math inline">\(f\)</span>ï¼Œé‚£ä¹ˆ<span class="math inline">\(f\)</span>çš„æ¢¯åº¦ä¸ºï¼š <span class="math display">\[
\nabla f(\mathbf{x}) = \bigg[\frac{\partial f(\mathbf{x})}{\partial x_1}, \frac{\partial f(\mathbf{x})}{\partial x_2}, \ldots, \frac{\partial f(\mathbf{x})}{\partial x_d}\bigg]^\top
\]</span> æ¯ä¸ªå…ƒç´ å¯¹åº”ç€ç›®æ ‡å‡½æ•°åœ¨è¯¥æ–¹å‘ä¸Šçš„å˜åŒ–ç‡ï¼Œå› æ­¤åªè¦æ²¿ç€æ¢¯åº¦çš„åæ–¹å‘å°±å¯ä»¥ä½¿ç›®æ ‡å‡½æ•°å‡å°å¾—æœ€å¿«ï¼š<span class="math inline">\(\mathbf{x} \leftarrow \mathbf{x} - \eta \nabla f(\mathbf{x})\)</span>ï¼Œ<span class="math inline">\(\eta\)</span>æ˜¯ä¸€ä¸ªè¢«ç§°ä¸ºå­¦ä¹ ç‡çš„è¶…å‚æ•°ï¼Œç”¨æ¥æ§åˆ¶æ¯ä¸€æ­¥çš„å¤§å°ã€‚<span class="math inline">\(\eta\)</span>è¿‡å°ï¼Œæ”¶æ•›è¿‡ç¨‹æåº¦ç¼“æ…¢ï¼›<span class="math inline">\(\eta\)</span>è¿‡å¤§ï¼Œå¯èƒ½é€ æˆæŸå¤±å‡½æ•°åœ¨æœ€å°ç‚¹é™„è¿‘æ³¢åŠ¨ç”šè‡³å‘æ•£ã€‚å­¦ä¹ ç‡çš„è°ƒæ•´æ˜¯ç¥ç»ç½‘ç»œè®­ç»ƒè¿‡ç¨‹ä¸­ä¸€ä¸ªé‡è¦çš„è°ƒæ•´å‚æ•°ï¼Œå¸¸å¸¸ä½¿äººå¤´ç—›ä¸å·²ï¼Œå› æ­¤ä¹Ÿå‡ºç°äº†å¾ˆå¤šå­¦ä¹ ç‡è‡ªé€‚åº”è°ƒæ•´çš„ç®—æ³•ï¼Œå°†åœ¨ä¸‹é¢æ·±å…¥åˆ†æè¿™äº›ç®—æ³•çš„ä¼˜åŠ£ã€‚</p>
<p>æœ‰äº†ä¼˜åŒ–æ¨¡å‹åŠæœ€åŸºç¡€çš„æ±‚è§£æ–¹æ³•åï¼Œæˆ‘ä»¬éœ€è¦å¯¹å…¶æ€§è´¨å’Œä¼˜ç¼ºç‚¹è¿›è¡Œåˆ†æï¼Œä»¥ä¾¿äºåç»­çš„æ”¹è¿›ã€‚æ·±åº¦å­¦ä¹ çš„ä¼˜åŒ–é—®é¢˜å¤§å¤šæ˜¯éå‡¸çš„ï¼Œå› æ­¤å­˜åœ¨å¾ˆå¤šæŒ‘æˆ˜ï¼š</p>
<ol type="1">
<li>å±€éƒ¨æœ€ä¼˜ï¼šå¯¹äºå‡¸ä¼˜åŒ–é—®é¢˜ï¼Œå±€éƒ¨æœ€ä¼˜å³æ˜¯å…¨å±€æœ€ä¼˜ã€‚ç„¶è€Œå¯¹äºéå‡¸é—®é¢˜ï¼Œå½“æŸå¤±å‡½æ•°åˆ°è¾¾å±€éƒ¨æœ€ä¼˜ç‚¹æ—¶ï¼Œ<span class="math inline">\(J(\Theta)\)</span>çš„æ¢¯åº¦ä¸º0ï¼Œ<span class="math inline">\(\Theta\)</span>æ— æ³•ç»§ç»­æ›´æ–°ï¼ŒæŸå¤±å‡½æ•°æ— æ³•ç»§ç»­ä¸‹é™ï¼›</li>
<li>éç‚¹ï¼šè¯¥ç‚¹æ—¢ä¸æ˜¯å±€éƒ¨æœ€å°ä¹Ÿä¸æ˜¯å…¨å±€æœ€å°ï¼Œä½†æ˜¯è¯¥ç‚¹çš„æ¢¯åº¦æ¶ˆå¤±ï¼Œæ— æ³•ç»§ç»­æ›´æ–°ï¼›</li>
<li>æ¢¯åº¦æ¶ˆå¤±/çˆ†ç‚¸ï¼šç”±äºåˆå§‹å€¼å’Œæ¿€æ´»å‡½æ•°é€‰æ‹©ä¸å½“ (å¦‚sigmoid)ï¼Œå½“æ¢¯åº¦åå‘å›ä¼ æ—¶ï¼Œå¯èƒ½åœ¨æŸä¸€å±‚æ±‚å¯¼åæ¢¯åº¦å€¼å¾ˆå°/å¾ˆå¤§ï¼Œå¯¼è‡´è®­ç»ƒé€Ÿåº¦æå…¶ç¼“æ…¢ã€‚å› æ­¤åˆå§‹å€¼çš„é€‰æ‹©é€šå¸¸é‡‡ç”¨å¾ˆå°çš„éšæœºæ•°ï¼Œé¿å…æ”¶æ•›åˆ°æ¯”è¾ƒå·®çš„åŒºåŸŸï¼Œæ¿€æ´»å‡½æ•°é€šå¸¸ä¹Ÿä¼šé€‰æ‹©ReLUï¼Œé¿å…æ¢¯åº¦æ¶ˆå¤±é—®é¢˜ã€‚</li>
</ol>
<p>å±€éƒ¨æœ€å°å’Œéç‚¹ç¤ºæ„å›¾å¦‚ä¸‹ï¼š <img src="https://img-blog.csdnimg.cn/20210710191530881.png" alt="åœ¨è¿™é‡Œæ’å…¥å›¾ç‰‡æè¿°" /> å°¤å…¶åœ¨é«˜ç»´ç©ºé—´ä¸­ï¼Œéç‚¹çš„é—®é¢˜å˜å¾—æ›´åŠ ä¸¥é‡ï¼šå‡è®¾<span class="math inline">\(\Theta\)</span>æ˜¯ä¸€ä¸ªkç»´å‘é‡ï¼Œ<span class="math inline">\(J(\Theta)\)</span>çš„æµ·æ£®çŸ©é˜µå°±æœ‰kä¸ªç‰¹å¾å€¼ï¼Œå…¶æ¢¯åº¦ä¸º0çš„ç‚¹æœ‰å¯èƒ½æ˜¯å±€éƒ¨æœ€å°ï¼ˆç‰¹å¾å€¼å‡ä¸ºæ­£ï¼‰ã€å±€éƒ¨æœ€å¤§ï¼ˆç‰¹å¾å€¼å‡ä¸ºè´Ÿï¼‰æˆ–è€…æ˜¯éç‚¹ï¼ˆç‰¹å¾å€¼æœ‰æ­£æœ‰è´Ÿï¼‰ã€‚é«˜ç»´ç©ºé—´ä¸­ç‰¹å¾å€¼æœ‰æ­£æœ‰è´Ÿçš„æ¦‚ç‡å¾ˆå¤§ï¼Œå› æ­¤éç‚¹å‡ºç°çš„å¯èƒ½æ€§è¿œå¤§äºå±€éƒ¨æœ€ä¼˜ç‚¹å‡ºç°çš„å¯èƒ½æ€§ï¼Œå¹¶ä¸”éç‚¹å‘¨å›´çš„å¹³å¦åŒºåŸŸå¯èƒ½å¾ˆå¤§ï¼Œéœ€è¦å¢åŠ å™ªå£°æ‰°åŠ¨æ¥é€ƒç¦»éç‚¹ã€‚</p>
<p>ç”±äºä¸Šè¿°é—®é¢˜çš„å­˜åœ¨ï¼Œé€šå¸¸å¾ˆéš¾æ‰¾åˆ°<span class="math inline">\(J(\Theta)\)</span>çš„å…¨å±€æœ€ä¼˜è§£ï¼Œä½†å®é™…ä¸Šä¸ºäº†å‡å°‘è¿‡æ‹Ÿåˆçš„é£é™©æˆ‘ä»¬å¹¶ä¸éœ€è¦è®­ç»ƒé›†ä¸Šçš„å…¨å±€æœ€ä¼˜ï¼Œç»å…¸çš„æ¢¯åº¦ä¸‹é™å°±å¯ä»¥å¸¦æ¥è¶³å¤Ÿçš„å±€éƒ¨æœ€ä¼˜ã€‚</p>
<p>åˆ†æå®Œä¼˜åŒ–æ¨¡å‹æœ¬èº«çš„é—®é¢˜ï¼Œå†æ¥çœ‹çœ‹æœ€åŸºç¡€çš„GDçš„é—®é¢˜ï¼šç›®æ ‡å‡½æ•°é€šå¸¸æ˜¯è®­ç»ƒé›†ä¸­æ‰€æœ‰æ ·æœ¬çš„æŸå¤±çš„å¹³å‡å€¼ï¼Œæ•…ç›®æ ‡å‡½æ•°çš„æ¢¯åº¦ä¸ºï¼š <span class="math display">\[
\nabla f(\mathbf{x}) = \frac{1}{n} \sum_{i = 1}^n \nabla f_i(\mathbf{x})
\]</span> å¦‚æœç”¨Full-batch GDï¼Œé‚£ä¹ˆæ¯æ¬¡è¿­ä»£æ¯ä¸ªå‚æ•°çš„æ¢¯åº¦è®¡ç®—çš„æ—¶é—´å¤æ‚åº¦ä¸º<span class="math inline">\(O(n)\)</span>ï¼Œå¯¹äºå¤§è§„æ¨¡æ•°æ®ï¼Œè¿™æ ·çš„æ›´æ–°é€Ÿåº¦æ˜¾ç„¶æ— æ³•ä»¤äººå¿å—ã€‚</p>
<p>å­¦ä¹ ç‡çš„é€‰æ‹©æ˜¯ä¸€é¡¹é‡è¦çš„è°ƒå‚å·¥ä½œï¼Œå› æ­¤å­¦ä¹ ç‡çš„è‡ªé€‚åº”å˜åŒ–å°±æˆä¸ºäº†ç ”ç©¶çƒ­ç‚¹ä¹‹ä¸€ï¼Œä¸€äº›äºŒé˜¶æ–¹æ³•åº”è¿è€Œç”Ÿï¼Œæˆ‘ä»¬é¦–å…ˆæ¥çœ‹çœ‹ç‰›é¡¿æ³•è¯¥å¦‚ä½•è§£å†³è¿™ä¸ªé—®é¢˜ã€‚</p>
<p>å¯¹äºæŸå¤±å‡½æ•°<span class="math inline">\(f\)</span>ï¼Œåˆ©ç”¨æ³°å‹’å±•å¼€å¼æœ‰ï¼š <span class="math display">\[
f(\mathbf{x} + \boldsymbol{\epsilon}) = f(\mathbf{x}) + \boldsymbol{\epsilon}^\top \nabla f(\mathbf{x}) + \frac{1}{2} \boldsymbol{\epsilon}^\top \nabla^2 f(\mathbf{x}) \boldsymbol{\epsilon} + \mathcal{O}(\|\boldsymbol{\epsilon}\|^3)
\]</span> å¼ä¸­çš„<span class="math inline">\(\nabla^2 f(\mathbf{x})\)</span>å³<span class="math inline">\(d*d\)</span>æµ·æ£®çŸ©é˜µï¼Œå­˜å‚¨äº†å‡½æ•°çš„äºŒé˜¶åå¯¼æ•°ã€‚ä¸ºäº†æ±‚å¾—<span class="math inline">\(f\)</span>çš„æœ€å°å€¼ï¼Œä»¤ä¸Šå¼å¯¹<span class="math inline">\(\epsilon\)</span>æ±‚å¯¼å¾—0ï¼Œæœ‰ï¼š<span class="math inline">\(\boldsymbol{\epsilon}=-\nabla f(\mathbf{x})H^{-1}\)</span>ï¼Œå³æ¯æ¬¡çš„å‚æ•°æ›´æ–°ä¸º<span class="math inline">\(\mathbf{x} \leftarrow \mathbf{x} - \nabla f(\mathbf{x})H^{-1}\)</span>ã€‚äºŒé˜¶è¿‘ä¼¼åˆ©ç”¨äº†æŸå¤±å‡½æ•°çš„æ›²ç‡ä¿¡æ¯ï¼Œå³å¦‚æœæ›²ç‡æ¯”è¾ƒå°ï¼Œé‚£ä¹ˆè¿™æ­¥æ›´æ–°å°±ä¼šæ¯”è¾ƒå¤§ï¼Œåä¹‹åˆ™æ›´æ–°è¾ƒå°ã€‚è¿™é‡Œæ²¡æœ‰äº†å­¦ä¹ ç‡ï¼Œè€Œæ˜¯é€šè¿‡â€œæ¢¯åº¦çš„æ¢¯åº¦â€è‡ªåŠ¨è°ƒæ•´æ­¥å¹…ï¼Œçœ‹èµ·æ¥æ¯”ä¸€é˜¶çš„æ¢¯åº¦ä¸‹é™è¦å¥½ä¸€äº›ã€‚</p>
<p>ç„¶è€Œæ·±åº¦å­¦ä¹ çš„å‚æ•°ç©ºé—´å¾€å¾€ååˆ†å·¨å¤§ï¼Œå› æ­¤å­˜å‚¨å’Œè®¡ç®—æµ·æ£®çŸ©é˜µçš„é€†æ˜¯ä¸ç°å®çš„ï¼Œè¿™ä¹Ÿæ˜¯ç‰›é¡¿æ³•æ— æ³•åœ¨DNNä¸­ä½¿ç”¨çš„é‡è¦åŸå› ã€‚ä¸ºäº†ç¼“è§£è¿™ä¸ªé—®é¢˜ï¼Œå­¦æœ¯ç•Œæå‡ºäº†ä¸€äº›æ‹Ÿç‰›é¡¿æ³•å¦‚L-BFGSç­‰è¯•å›¾å»é™ä½å­˜å‚¨æ¶ˆè€—ï¼Œä½†æ˜¯è®¡ç®—ä»£ä»·ä»ç„¶å¾ˆé«˜ã€‚</p>
<p>ä»ä»¥ä¸Šçš„åˆ†æå¯ä»¥çœ‹åˆ°ï¼šæ— è®ºæ˜¯Full-batch GDè¿˜æ˜¯ç‰›é¡¿æ³•ï¼Œéƒ½å­˜åœ¨è®¡ç®—æ¶ˆè€—å¤§ç­‰é—®é¢˜ï¼Œä¸é€‚ç”¨äºæ·±åº¦å­¦ä¹ ä»»åŠ¡çš„å¤§è§„æ¨¡æ•°æ®é›†è®­ç»ƒï¼Œå› æ­¤å·²ç»å¾ˆå°‘è¢«ç›´æ¥ç”¨åœ¨æ·±åº¦å­¦ä¹ æ¨¡å‹ä¸­ã€‚ä¸ºäº†å¤„ç†è¿™äº›é—®é¢˜ï¼Œå­¦æœ¯ç•Œæå‡ºäº†å¾ˆå¤šæ›¿ä»£çš„ä¼˜åŒ–ç®—æ³•ï¼Œå› æ­¤æ¥ä¸‹æ¥æˆ‘å°†è°ƒç ”åˆ†æå½“å‰å¸¸ç”¨çš„æ·±åº¦å­¦ä¹ ä¼˜åŒ–ç®—æ³• (SGD/Adam...)çš„ä¼˜ç¼ºç‚¹ï¼Œå¹¶ç»“åˆå®ä¾‹åŠå‰æ²¿ç ”ç©¶è¿›è¡Œç›¸å…³è®¨è®ºã€‚ ## Popular Algorithms ä¼˜åŒ–ç®—æ³•åœ¨ç¥ç»ç½‘ç»œçš„è®­ç»ƒä¸­æœ‰ç€ä¸¾è¶³è½»é‡çš„ä½œç”¨ï¼Œé€‰æ‹©åˆé€‚çš„ä¼˜åŒ–ç®—æ³•å¯ä»¥ä½¿å¾—æŸå¤±å‡½æ•°æ”¶æ•›åœ°æ›´å¿«ï¼ŒåŒæ—¶æ”¶æ•›åˆ°æ›´å¥½çš„åŒºåŸŸã€‚ç›®å‰æ¯”è¾ƒæµè¡Œçš„ç®—æ³•æœ‰ä¸‹é¢å‡ ç§ï¼š ### 1 SGD å°è¯•ç”¨mini-batchçš„æ¢¯åº¦å¹³å‡å€¼ä½œä¸ºæ•´ä½“æ¢¯åº¦çš„æ— åä¼°è®¡ï¼Œå‚æ•°çš„æ›´æ–°éå¸¸ç®€å•ï¼Œæ²¿ç€æ¢¯åº¦çš„åæ–¹å‘å³æ˜¯lossä¸‹é™æœ€å¿«çš„æ–¹å‘ï¼š <span class="math display">\[
x_{t+1}=x_t-\alpha\nabla f(x_t)
\]</span> å¦‚æœæ˜¯Batch GDå¹¶ä¸”å­¦ä¹ ç‡è¶³å¤Ÿå°æ—¶å¯ä»¥ä¿è¯æŸå¤±å‡½æ•°å•è°ƒä¸å¢ã€‚å®é™…ä½¿ç”¨æ—¶ä¸€èˆ¬ä¼šé‡‡ç”¨å­¦ä¹ ç‡é€’å‡ç­–ç•¥ä¿è¯æ¨¡å‹æ”¶æ•›ã€‚</p>
<p>å®ç°ä¹Ÿéå¸¸ç®€å•ï¼š</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">x -= lr * grads</span><br></pre></td></tr></table></figure>
<p>SGDå­˜åœ¨å‡ ä¸ªé—®é¢˜ï¼š</p>
<p>é¦–å…ˆï¼Œå¦‚æœlosså¯¹äºä¸åŒå‚æ•°çš„æ•æ„Ÿç¨‹åº¦ä¸åŒï¼Œé‚£ä¹ˆæ”¶æ•›è¿‡ç¨‹ä¼šåœ¨æ•æ„Ÿå‚æ•°æ–¹å‘ä¸ŠæŠ–åŠ¨ï¼š <img src="https://img-blog.csdnimg.cn/20210710192205509.png" /> å¯¹äºéå¸¸å¤§çš„å‚æ•°ç©ºé—´ï¼Œå¯èƒ½ä¼šæ”¶æ•›åˆ°ä¸åŒçš„åŒºåŸŸã€‚ å…¶æ¬¡ï¼Œå¦‚æœlosså‡½æ•°æœ‰å±€éƒ¨æœ€ä¼˜æˆ–è€…éç‚¹ï¼Œè¿™äº›ç‚¹ä¸Šæ¢¯åº¦ä¸º0ï¼Œæ— æ³•æ”¶æ•›åˆ°å…¨å±€æœ€ä¼˜ï¼› æœ€åï¼Œå¦‚æœé‡‡ç”¨mini-batchï¼Œé‚£ä¹ˆè®¡ç®—å‡ºçš„æ¢¯åº¦å€¼æ˜¯æœ‰å™ªå£°çš„ï¼Œæ„å‘³ç€æ”¶æ•›è¿‡ç¨‹å¯èƒ½ä¼šæ˜¯éå¸¸æ›²æŠ˜çš„ï¼Œä¹Ÿå³éœ€è¦æ›´å¤šæ—¶é—´ã€‚ ### 2 SGD+Momentum ä¸ºäº†è§£å†³SGDçš„é—®é¢˜ï¼Œæœ‰å­¦è€…æå‡ºäº†å¸¦æœ‰åŠ¨é‡çš„SGDï¼Œå…¶æ€æƒ³ä¹Ÿå¾ˆç®€å•ï¼šæ›´æ–°å‚æ•°æ—¶ä¸ä»…è€ƒè™‘å½“å‰çš„æ¢¯åº¦æ–¹å‘ï¼Œè¿˜è¦è€ƒè™‘å†å²ç´¯ç§¯æ¢¯åº¦æ–¹å‘ï¼Œå¦‚æœä¸¤è€…æ–¹å‘ä¸€è‡´ï¼Œé‚£ä¹ˆè¿™ä¸€æ­¥æ›´æ–°å¹…åº¦å°±ä¼šå¢å¤§ï¼›å¦‚æœä¸ä¸€è‡´ï¼Œå°±ä¼šå‡å¼±æ²¿å½“å‰æ¢¯åº¦çš„ä¸‹é™å¹…åº¦ã€‚ <span class="math display">\[
v_{t+1}=\rho v_t+\nabla f(x_t) \\
x_{t+1}=x_t-\alpha v_{t+1}
\]</span> <span class="math inline">\(\rho\)</span>å¯ä»¥çœ‹ä½œæ˜¯å¯¹å†å²æ¢¯åº¦çš„è¡°å‡ï¼Œä¸€èˆ¬å–0.9ã€‚</p>
<p>å¸¦æœ‰åŠ¨é‡çš„SGDå®ç°ï¼š <figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">v = rho * v + grads</span><br><span class="line">x -= lr * v</span><br></pre></td></tr></table></figure> è¿™æ ·å°±è§£å†³äº†SGDçš„ä¸‰ä¸ªé—®é¢˜ï¼š é¦–å…ˆï¼Œç”±äºå†å²æ¢¯åº¦çš„å­˜åœ¨ï¼Œæœæ•æ„Ÿæ–¹å‘æ­¥è¿›çš„æ•°é‡å°±ä¼šå‡å°‘ï¼Œä¼šæ›´åŠ å¹³æ»‘çš„å‘æœ€ä¼˜ç‚¹å‰è¿›ï¼Œå‡å°äº†éœ‡è¡ï¼ŒåŠ é€Ÿæ”¶æ•›ï¼› å…¶æ¬¡ï¼Œå¯¹äºå±€éƒ¨æœ€ä¼˜ç‚¹ï¼Œè™½ç„¶å½“å‰æ¢¯åº¦ä¸º0ï¼Œä½†æ˜¯ä¾é å†å²æ¢¯åº¦å¯ä»¥è¶Šè¿‡è¯¥ç‚¹ç»§ç»­ä¸‹é™ï¼› æœ€åï¼Œæ¢¯åº¦å™ªå£°å¼•èµ·çš„éœ‡è¡å¯ä»¥é€šè¿‡å†å²æ¢¯åº¦äº’ç›¸æŠµæ¶ˆã€‚ ### 3 Nesterov Momentum Nesterov Momentumç”±SGD+Momentumè¡ç”Ÿè€Œæ¥ï¼ŒSGD+Momentumæ˜¯å°†å½“å‰ç‚¹çš„æ¢¯åº¦å’Œé€Ÿåº¦ç»“åˆèµ·æ¥ï¼Œè€ŒNesterov Momentumåˆ™æ˜¯å°†å½“å‰ç‚¹çš„é€Ÿåº¦å’Œä¸‹ä¸€ä¸ªè¿‘ä¼¼ç‚¹çš„æ¢¯åº¦ç»“åˆèµ·æ¥ï¼Œæ„å‘³ç€æˆ‘ä»¬ä¸æ˜¯åœ¨å½“å‰ä½ç½®å»çœ‹æœªæ¥ï¼Œè€Œæ˜¯å¤šçœ‹äº†ä¸€æ­¥ï¼Œåœ¨ç¨è¿œä¸€äº›çš„ä¸‹ä¸€æ­¥çœ‹æœªæ¥ï¼Œå¯ä»¥æå‰è°ƒæ•´æ­¥è¿›å¤§å°ï¼š <img src="https://img-blog.csdnimg.cn/20210710192712932.png" alt="åœ¨è¿™é‡Œæ’å…¥å›¾ç‰‡æè¿°" /> æ‰€ä»¥Nesterov Momentumçš„æ›´æ–°è§„åˆ™ä¸ºï¼š <span class="math display">\[
v_{t+1}=\rho v_t-\alpha\nabla f(x_t+\rho v_t) \\
x_{t+1}=x_t+v_{t+1}
\]</span> é€šå¸¸æˆ‘ä»¬å¸Œæœ›é’ˆå¯¹<span class="math inline">\(x_t\)</span>è®¡ç®—æ¢¯åº¦ï¼Œé€šè¿‡ç®€å•çš„å˜é‡æ›¿æ¢ï¼Œå¾—åˆ°æ–°çš„æ›´æ–°è§„åˆ™ï¼š <span class="math display">\[
v_{t+1}=\rho v_t-\alpha\nabla f(x_t) \\
x_{t+1}=x_t+v_{t+1}+\rho(v_{t+1}-v_t)
\]</span> Nesterovçš„å®ç°ï¼š <figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">v_prev = v</span><br><span class="line">v = rho * v - lr * grads</span><br><span class="line">x += (1 + rho) * v - rho * v_prev</span><br></pre></td></tr></table></figure> ### 4 AdaGrad å‰é¢çš„å‡ ç§æ–¹æ³•éƒ½æ˜¯è®¾ç½®äº†ä¸€ä¸ªå…¨å±€çš„å­¦ä¹ ç‡ï¼ŒAdaGradåˆ™é€šè¿‡å¼•å…¥äºŒé˜¶åŠ¨é‡ä½¿å¾—å­¦ä¹ ç‡å¯ä»¥é’ˆå¯¹<strong>æ¯ä¸ªå‚æ•°</strong>è‡ªé€‚åº”åœ°å–å€¼ï¼šå¯¹äºæ›´æ–°é¢‘ç¹çš„å‚æ•°ï¼Œå·²ç»æœ‰äº†å¾ˆå¤šè®¤çŸ¥ï¼Œä¸å¸Œæœ›å› ä¸ºå•ä¸ªæ ·æœ¬å½±å“å¤ªå¤§ï¼Œæ‰€ä»¥å­¦ä¹ ç‡å¯ä»¥å°ä¸€äº›ï¼›å¯¹äºæ›´æ–°ç¨€ç–çš„å‚æ•°ï¼Œå¸Œæœ›ä»å¶å°”å‡ºç°çš„èƒ½æ›´æ–°è¯¥å‚æ•°çš„æ ·æœ¬ä¸­å¤šè·å¾—ä¸€äº›ä¿¡æ¯ï¼Œæ‰€ä»¥å­¦ä¹ ç‡å¯ä»¥è®¾ç½®åœ°å¤§ä¸€äº›ã€‚ä¸ºäº†äº†è§£å‚æ•°æ›´æ–°çš„é¢‘ç¹ç¨‹åº¦ï¼Œå¼•å…¥äºŒé˜¶åŠ¨é‡â€”â€”æ¯ä¸ªç»´åº¦ä¸Šå†å²æ¢¯åº¦å€¼çš„å¹³æ–¹å’Œï¼š <span class="math display">\[
grad\_squared +=\nabla^2 f(x_t) \\
x_{t+1}=x_t-\cfrac{\alpha\nabla f(x_t)}{\sqrt{grad\_squared+10^{-7}}}
\]</span> æ­¤æ—¶çš„å­¦ä¹ ç‡å®è´¨ä¸Šæ˜¯<span class="math inline">\(\cfrac{\alpha}{\sqrt{grad\_squared}}\)</span>ï¼Œä¸ºäº†é¿å…é™¤0ï¼Œä¸€èˆ¬åˆ†æ¯åŠ ä¸Šä¸€ä¸ªå¾ˆå°çš„å¹³æ»‘é¡¹ã€‚å¦‚æœæŸä¸ªå‚æ•°æ›´æ–°é¢‘ç¹ï¼Œé‚£ä¹ˆgrad_squaredå°±ä¼šå¢å¤§ï¼Œå­¦ä¹ ç‡ä¹Ÿå°±è¶Šå°ã€‚</p>
<p>AdaGradçš„å®ç°ï¼š <figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">grad_sq += grads**2</span><br><span class="line">x -= lr * grads / (numpy.sqrt(grad_sq) + eps)</span><br></pre></td></tr></table></figure> AdaGradçš„é—®é¢˜åœ¨äºéšç€grad_squaredå•è°ƒé€’å¢ï¼Œå­¦ä¹ ç‡æœ€ç»ˆä¼šå•è°ƒè¡°å‡åˆ°0ï¼Œæ„å‘³ç€å¾ˆå¯èƒ½ä¼šææ—©ç»ˆæ­¢è®­ç»ƒè¿‡ç¨‹ã€‚ ### 5 RMSProp/AdaDelta ä¸ºäº†ç¼“è§£AdaGradçš„å­¦ä¹ ç‡å˜åŒ–è¿‡äºæ¿€è¿›çš„é—®é¢˜ï¼ŒäºŒé˜¶åŠ¨é‡çš„è®¡ç®—ä¸ç´¯ç§¯å…¨éƒ¨çš„å†å²æ¢¯åº¦ï¼Œåªå…³æ³¨è¿‡å»æŸæ®µæ—¶é—´å†…çš„æ¢¯åº¦å˜åŒ–ï¼Œç”¨æŒ‡æ•°ç§»åŠ¨å¹³å‡å€¼æ¥è¡¨ç¤ºè¿‡å»æŸæ—¶é—´æ®µçš„äºŒé˜¶åŠ¨é‡çš„å‡å€¼ï¼š <span class="math display">\[
grad\_squared=decay\_rate*grad\_squared+(1-decay\_rate)\nabla^2 f(x_t) \\
x_{t+1}=x_t-\cfrac{\alpha\nabla f(x_t)}{\sqrt{grad\_squared+10^{-7}}}
\]</span> decay_rateæ˜¯ä¸€ä¸ªè¶…å‚æ•°ï¼Œä¸€èˆ¬å–å€¼0.9ã€‚</p>
<p>RMSPropçš„å®ç°ï¼š <figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">grad_sq = decay * grad_sq + (1 - decay) * grads**2</span><br><span class="line">x -= lr * grads / (numpy.sqrt(grad_sq) + eps)</span><br></pre></td></tr></table></figure> å› æ­¤ï¼ŒRMSPropä»ç„¶æ˜¯é€šè¿‡æ¢¯åº¦çš„å¤§å°æ¥è°ƒæ•´æ¯ä¸ªå‚æ•°çš„å­¦ä¹ ç‡ï¼Œä¸è¿‡ç°åœ¨å­¦ä¹ ç‡ä¸ä¼šå•è°ƒé€’å‡ã€‚</p>
<h3 id="adam">6 Adam</h3>
<p>Adamçš„å‡ºç°æ˜¯é›†æˆäº†ä¸€é˜¶åŠ¨é‡æ€æƒ³å’ŒAdaGradç­‰çš„äºŒé˜¶åŠ¨é‡æ€æƒ³ï¼Œå³Adaptive Momentumï¼š <span class="math display">\[
m_{t+1}=\beta_1m_t+(1-\beta_1)\nabla f(x_t)\\
V_{t+1}=\beta_2V_t+(1-\beta_2)\nabla^2 f(x_t)\\
x_{t+1}=x_t-\cfrac{\alpha m_{t+1}}{\sqrt{V_{t+1}+10^{-7}}}
\]</span> ç”±äºmå’ŒVåˆå§‹åŒ–ä¸º0ï¼Œæ‰€ä»¥å¼€å§‹çš„å‡ æ¬¡è¿­ä»£ä¼šåå‘å–å€¼0ï¼Œä¸ºäº†å¼¥è¡¥è¿™ä¸€ç¼ºç‚¹ï¼Œåˆå¼•å…¥äº†åå·®çº æ­£é¡¹ï¼Œå®Œæ•´çš„Adamç®—æ³•å¦‚ä¸‹ï¼š <span class="math display">\[
m=\beta_1m+(1-\beta_1)\nabla f(x_t)\\
m_t=\cfrac{m}{1-\beta_1^t}\\
V=\beta_2V+(1-\beta_2)\nabla^2 f(x_t)\\
V_t=\cfrac{V}{1-\beta_2^t}\\
x_{t}=x_{t-1}-\cfrac{\alpha m_{t}}{\sqrt{V_{t}+10^{-7}}}
\]</span> Adamçš„å®ç°ï¼š <figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">m = beta_1 * m + (1 - beta_1) * grads</span><br><span class="line">m_t = m / (1 - beta_1**t)</span><br><span class="line">v = beta_2 * v + (1 - beta_2) * grads**2</span><br><span class="line">v_t = v / (1 - beta_2**t)</span><br><span class="line">x -= lr * m_t / (numpy.sqrt(v_t) + eps)</span><br></pre></td></tr></table></figure> å¦‚æœAdamå†åŠ ä¸ŠNesterovçš„å‘åçœ‹ä¸€æ­¥çš„æ€æƒ³ï¼Œå°±æ˜¯Nadamç®—æ³•ã€‚ ## Experiment ä¸ºäº†å¯¹ä¸Šè¿°ç®—æ³•æœ‰æ›´åŠ ç›´è§‚çš„è®¤è¯†ï¼ŒåŒæ—¶åœ¨éƒ¨åˆ†ç¨‹åº¦ä¸Šæ¯”è¾ƒä¸åŒç®—æ³•çš„æ€§èƒ½ï¼Œæ„é€ ä¸€ç»´å‡½æ•°<span class="math inline">\(f(x)\)</span>ä½œä¸ºæŸå¤±å‡½æ•°ï¼Œå…¶è¡¨è¾¾å¼å¦‚ä¸‹ï¼š <span class="math display">\[
f(x)=0.01x^2+sin(x)+\frac{1}{3}cos(3x)+\frac{1}{5}sin(5x)+\frac{1}{7}cos(7x)
\]</span> è¿™ä¸ªæŸå¤±å‡½æ•°å«æœ‰å¤§é‡çš„å±€éƒ¨æœ€å°ç‚¹ä»¥åŠæ‚¬å´–ï¼Œå¦‚å›¾æ‰€ç¤ºï¼š <img src="https://img-blog.csdnimg.cn/2021071019313296.png" alt="åœ¨è¿™é‡Œæ’å…¥å›¾ç‰‡æè¿°" /> ä¸ºäº†å…¬å¹³èµ·è§ï¼Œæ¯”è¾ƒæ—¶å°†xçš„åˆå§‹å€¼è®¾ä¸º-29ï¼Œæ¯ç§ç®—æ³•çš„è¿­ä»£æ¬¡æ•°å‡è®¾ç½®ä¸º300æ¬¡ï¼Œå­¦ä¹ ç‡å‡è®¾ç½®ä¸º0.1ï¼Œè¿­ä»£è¿‡ç¨‹å¦‚ä¸‹å›¾æ‰€ç¤ºï¼š <img src="https://img-blog.csdnimg.cn/20210710193206336.png" alt="åœ¨è¿™é‡Œæ’å…¥å›¾ç‰‡æè¿°" /> æœ€ç»ˆçš„æ”¶æ•›ç»“æœå¦‚ä¸‹è¡¨æ‰€ç¤ºï¼š | ç®—æ³• | æœ€ç»ˆx | æœ€ç»ˆæŸå¤± | | -------- | ------ | -------- | | SGD | -27.98 | 7.19 | | Momentum | -24.00 | 6.21 | | Nesterov | -24.00 | 6.21 | | AdaGrad | -27.98 | 7.19 | | RMSProp | -28.95 | 9.10 | | Adam | -26.46 | 5.59 |</p>
<p>ä»ä¸Šå›¾å’Œä¸Šè¡¨å¯ä»¥çœ‹åˆ°ï¼šAdamç®—æ³•åœ¨å‰æœŸæ”¶æ•›å¾ˆå¿«ï¼Œå¹¶ä¸”æœ€ç»ˆæ•ˆæœæœ€å¥½ï¼Œæ˜¯ç»¼åˆæ€§èƒ½æœ€ä½³çš„ç®—æ³•ï¼›å¸¦åŠ¨é‡çš„SGDèƒ½å¤Ÿè¶Šè¿‡ä¸€äº›å±€éƒ¨æå°å€¼ï¼Œåœ¨æ²¡æœ‰ç²¾ç»†è°ƒå‚çš„æƒ…å†µä¸‹ä¸€åº¦è¾¾åˆ°äº†å’ŒAdamç±»ä¼¼çš„æ•ˆæœï¼›AdaGradå¼€å§‹æ—¶çš„æ¢¯åº¦å¾ˆå¤§ï¼Œä½†æ˜¯ç”±äºå­¦ä¹ ç‡è¿‡æ—©åœ°å‡å°ï¼Œæœ€ç»ˆæ•ˆæœå¹¶ä¸å‡ºä¼—ï¼›è¿™äº›ç»“æœè¿›ä¸€æ­¥ä½è¯äº†ä¹‹å‰å¯¹å„ç§ç®—æ³•çš„åˆ†æã€‚</p>
<p>å¦‚æœå°†å­¦ä¹ ç‡è®¾ç½®ä¸º0.01ï¼Œå¯¹æ¯”å¦‚ä¸‹ï¼š <img src="https://img-blog.csdnimg.cn/20210710193256448.png" alt="åœ¨è¿™é‡Œæ’å…¥å›¾ç‰‡æè¿°" /> å¯ä»¥çœ‹åˆ°ï¼šç²¾è°ƒåçš„Momentumã€Nesterovå’ŒAdamçš„æ•ˆæœå‡ ä¹ä¸ç›¸ä¸Šä¸‹ï¼Œè¿™åªæ˜¯åˆæ­¥è°ƒæ•´äº†å­¦ä¹ ç‡å‚æ•°ï¼Œå¦‚æœé€šè¿‡éªŒè¯é›†æ›´åŠ ç²¾ç»†åœ°è°ƒæ•´è¶…å‚æ•°çš„å€¼ï¼Œé‚£ä¹ˆSGD+Momentumå®Œå…¨å¯ä»¥è¾¾åˆ°ç”šè‡³è¶…è¶ŠAdamçš„è¡¨ç°ï¼Œå½“ç„¶è¿™ä¹Ÿéœ€è¦äººä¸ºä»˜å‡ºæ›´å¤šçš„åŠªåŠ›ï¼ŒAdamè¿™ä¸ªçƒ¦æ¼åˆ™å°å¾—å¤šã€‚</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># -*- coding: utf-8 -*-</span></span><br><span class="line"><span class="string">&quot;&quot;&quot;</span></span><br><span class="line"><span class="string">Created on Sun Apr 11 18:31:58 2021</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">@author: Jingtao Ren</span></span><br><span class="line"><span class="string">&quot;&quot;&quot;</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> numpy <span class="keyword">as</span> np</span><br><span class="line"><span class="keyword">import</span> tensorflow <span class="keyword">as</span> tf</span><br><span class="line"><span class="keyword">import</span> matplotlib.pyplot <span class="keyword">as</span> plt</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">a = tf.constant(<span class="number">3.0</span>)</span><br><span class="line">b = tf.constant(<span class="number">5.0</span>)</span><br><span class="line">c = tf.constant(<span class="number">7.0</span>)</span><br><span class="line">d = tf.constant(<span class="number">0.1</span>)</span><br><span class="line">x = tf.Variable(initial_value=-<span class="number">29.0</span>, name=<span class="string">&quot;x&quot;</span>, dtype=tf.float32)</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">plot_f</span>():</span></span><br><span class="line">    x = np.linspace(-<span class="number">30</span>, <span class="number">30</span>, <span class="number">1000</span>)</span><br><span class="line">    <span class="comment"># y = -20.0 * np.exp(b * np.abs(x)) - np.exp(np.cos(c * x)) + 20.0 + np.exp(1)</span></span><br><span class="line">    y = (<span class="number">0.1</span> * x) ** <span class="number">2</span> + np.sin(x) + np.cos(a * x) / a + np.sin(b * x) / b + np.cos(c * x) / c</span><br><span class="line">    plt.xlabel(<span class="string">&#x27;x&#x27;</span>)</span><br><span class="line">    plt.ylabel(<span class="string">&#x27;y&#x27;</span>)</span><br><span class="line">    plt.title(<span class="string">&#x27;Loss Function&#x27;</span>)</span><br><span class="line">    plt.plot(x, y)</span><br><span class="line">    plt.show()</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">plot_train</span>(<span class="params">y</span>):</span></span><br><span class="line">    x = np.arange(<span class="number">300</span>)</span><br><span class="line">    labels = [<span class="string">&#x27;SGD&#x27;</span>, <span class="string">&#x27;Momentum&#x27;</span>, <span class="string">&#x27;Nesterov&#x27;</span>, <span class="string">&#x27;AdaGrad&#x27;</span>, <span class="string">&#x27;RMSProp&#x27;</span>, <span class="string">&#x27;Adam&#x27;</span>]</span><br><span class="line">    plt.figure()</span><br><span class="line">    plt.xlabel(<span class="string">&#x27;Iteration&#x27;</span>)</span><br><span class="line">    plt.ylabel(<span class="string">&#x27;Loss&#x27;</span>)</span><br><span class="line">    plt.title(<span class="string">&#x27;Algorithm Comparison&#x27;</span>)</span><br><span class="line">    <span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">6</span>):    </span><br><span class="line">        plt.plot(x, y[i], label=labels[i])</span><br><span class="line">        plt.legend()</span><br><span class="line">    plt.show()</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">loss</span>():</span></span><br><span class="line">    <span class="comment"># y = a * tf.exp(b * tf.abs(x)) - tf.exp(tf.cos(c * x)) - a + tf.exp(tf.constant(1.0))</span></span><br><span class="line">    y = tf.<span class="built_in">pow</span>(d * x, <span class="number">2</span>) + tf.sin(x) + tf.cos(a * x) / a + tf.sin(b * x) / b + tf.cos(c * x) / c</span><br><span class="line">    <span class="keyword">return</span> (y)</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">minimize</span>(<span class="params">optimizer, iters = <span class="number">300</span></span>):</span></span><br><span class="line">    y = []</span><br><span class="line">    <span class="comment"># optimizer = tf.keras.optimizers.SGD(learning_rate=0.1)</span></span><br><span class="line">    <span class="keyword">for</span> i <span class="keyword">in</span> tf.<span class="built_in">range</span>(iters):</span><br><span class="line">        optimizer.minimize(loss, [x])</span><br><span class="line">        y.append(loss())</span><br><span class="line">    tf.<span class="built_in">print</span>(<span class="string">&quot;Final x = &quot;</span>, x)</span><br><span class="line">    tf.<span class="built_in">print</span>(<span class="string">&quot;Final Loss = &quot;</span>, loss())</span><br><span class="line">    <span class="keyword">return</span> y</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span> __name__ == <span class="string">&quot;__main__&quot;</span>:</span><br><span class="line">    <span class="comment"># plot_f()</span></span><br><span class="line">    ops = [tf.keras.optimizers.SGD(learning_rate=<span class="number">0.1</span>), tf.keras.optimizers.SGD(learning_rate=<span class="number">0.1</span>, momentum=<span class="number">0.9</span>),</span><br><span class="line">           tf.keras.optimizers.SGD(learning_rate=<span class="number">0.1</span>, momentum=<span class="number">0.9</span>, nesterov=<span class="literal">True</span>), tf.keras.optimizers.Adagrad(learning_rate=<span class="number">0.1</span>),</span><br><span class="line">           tf.keras.optimizers.Adadelta(learning_rate=<span class="number">0.1</span>, rho=<span class="number">0.9</span>), tf.keras.optimizers.Adam(learning_rate=<span class="number">0.1</span>)]</span><br><span class="line">    y = []</span><br><span class="line">    <span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">6</span>):</span><br><span class="line">        x.assign(-<span class="number">29.0</span>)</span><br><span class="line">        y.append(minimize(ops[i]))</span><br><span class="line">    plot_train(y)</span><br></pre></td></tr></table></figure>
<p>å½“ç„¶ï¼Œè¿™ä¸ªå®éªŒéå¸¸ç®€å•ï¼ŒæŸå¤±å‡½æ•°å½¢å¼æ˜¯ä¸€ç»´çš„ï¼Œå®é™…ä¸­çš„ç½‘ç»œæ¨¡å‹å‚æ•°çš„æ•°é‡å¯èƒ½è¾¾åˆ°ç™¾ä¸‡çº§åˆ«ï¼Œè¶…é«˜ç»´æƒ…å†µä¸‹ç®—æ³•çš„æ•ˆç‡ã€é²æ£’æ€§ä»¥åŠæ¨¡å‹æœ€ç»ˆçš„æ³›åŒ–èƒ½åŠ›æ‰æ˜¯æˆ‘ä»¬çœŸæ­£å…³å¿ƒçš„ã€‚</p>
<p>æœ€åè´´2å¼ ç¥å›¾æ€»ç»“ä¸‹ï¼š <img src="https://img-blog.csdnimg.cn/20210306203509952.gif#pic_center" alt="åœ¨è¿™é‡Œæ’å…¥å›¾ç‰‡æè¿°" /><img src="https://img-blog.csdnimg.cn/2021030620351970.gif#pic_center" alt="åœ¨è¿™é‡Œæ’å…¥å›¾ç‰‡æè¿°" /> ## Research Adamè™½ç„¶æ˜¯é›†å¤§æˆè€…ï¼Œè€Œä¸”ä¹Ÿè¢«æ¨èä¸ºèµ·å§‹çš„é»˜è®¤ä¼˜åŒ–ç®—æ³•ï¼Œä½†æ˜¯ä¸€äº›Paperæ­ç¤ºäº†Adamçš„ä¸€äº›é—®é¢˜ã€‚ ### 1 è¿‡æ‹Ÿåˆ Berkeleyåœ¨NIPS 2017çš„ä¸€ç¯‡æ–‡ç« æŒ‡å‡ºï¼šå¦‚æœä¸€ä¸ªé—®é¢˜æœ‰å¤šä¸ªå…¨å±€æä¼˜ï¼Œå³ä½¿ä»ç›¸åŒçš„åˆå§‹å€¼å‡ºå‘ï¼Œä¸åŒçš„ä¼˜åŒ–ç®—æ³•ä¹Ÿä¼šå¾—åˆ°å®Œå…¨ä¸åŒçš„ç»“æœã€‚æ–‡ç« æ„é€ äº†ä¸€ä¸ªç®€å•çš„çº¿æ€§å¯åˆ†çš„äºŒåˆ†ç±»é—®é¢˜ï¼Œè¯æ˜äº†SGDåœ¨è¿™ç§æƒ…å†µä¸‹æµ‹è¯•è¯¯å·®ä¸º0ï¼Œè€ŒAdaGradç­‰è‡ªé€‚åº”æ–¹æ³•ä¼šæŠŠæ‰€æœ‰çš„æµ‹è¯•æ ·ä¾‹åˆ†ä¸ºæ­£ç±»ï¼Œæ³›åŒ–èƒ½åŠ›æå·®ï¼Œä¹Ÿå°±æ˜¯æ ¹æœ¬ä¸èƒ½å·¥ä½œã€‚</p>
<p>éšåä½œè€…åˆç”¨VGG+BN+Dropoutçš„ç½‘ç»œç»“æ„åœ¨CIFAR-10æ•°æ®é›†ä¸Šè¿›è¡Œäº†å®éªŒï¼š <img src="https://img-blog.csdnimg.cn/20210710193712619.png" alt="åœ¨è¿™é‡Œæ’å…¥å›¾ç‰‡æè¿°" /> å¯ä»¥çœ‹åˆ°ï¼šå‰æœŸè®­ç»ƒä¸­Adamæœ‰ä¼˜åŠ¿ï¼Œä½†SGDçš„æ³›åŒ–èƒ½åŠ›ç¡®å®æ¯”Adamè¦å¥½ã€‚</p>
<p>æœ€åï¼Œä¸ºäº†å½»åº•é»‘åŒ–Adamï¼Œæ–‡ç« åˆç”¨äº†æ–‡æœ¬æ•°æ®é›†å’Œä¸€äº›NLPæ¨¡å‹åšäº†å®éªŒï¼š <img src="https://img-blog.csdnimg.cn/20210710193823396.png" alt="åœ¨è¿™é‡Œæ’å…¥å›¾ç‰‡æè¿°" /> å³ä¾¿æœ‰æ—¶å€™è‡ªé€‚åº”æ–¹æ³•çš„è®­ç»ƒlossä¼šæ›´ä½ï¼Œä½†SGDçš„æ³›åŒ–èƒ½åŠ›éƒ½æ— ä¸€ä¾‹å¤–åœ°èƒœè¿‡äº†è‡ªé€‚åº”çš„æ–¹æ³•ã€‚è‡ªé€‚åº”æ–¹æ³•åœ¨è®­ç»ƒåˆæœŸé€Ÿåº¦å¾ˆå¿«ï¼Œä½†æ˜¯åæœŸè¡¨ç°å¹³å¹³ã€‚</p>
<p>æ³›åŒ–èƒ½åŠ›å·®çš„åŸå› åœ¨äºï¼šè‡ªé€‚åº”æ–¹æ³•å€¾å‘äºå…³æ³¨ç¨€ç–çš„ç‰¹å¾ï¼Œå› ä¸ºè¿™äº›ç‰¹å¾å¯¹äºè®­ç»ƒæ ·ä¾‹çš„é‰´åˆ«æ˜¯å¾ˆæœ‰æ•ˆçš„ï¼Œå°¤å…¶åœ¨è®­ç»ƒæ ·ä¾‹æ•°å°‘è€Œç‰¹å¾è¾ƒå¤šçš„æ•°æ®é›†ä¸­ï¼Œä½†æ˜¯è¿™äº›ç‰¹å¾å…¶å®å¹¶éå…³é”®ç‰¹å¾ï¼Œè¿™æ ·è‡ªé€‚åº”å­¦ä¹ ç‡ç®—æ³•å‡ºç°è¿‡æ‹Ÿåˆçš„é£é™©å°±ä¼šå¢å¤§ï¼Œå¯¼è‡´æ³›åŒ–èƒ½åŠ›ä¸ä½³ï¼Œæœ€ç»ˆçš„æ”¶æ•›æ•ˆæœä¸å¦‚ä¼ ç»Ÿçš„SGDã€‚ ### 2 äºŒé˜¶åŠ¨é‡æ³¢åŠ¨ Googleçš„ä¸€ç¯‡æ–‡ç« ä»æ•°å­¦ä¸Šè¯æ˜äº†åœ¨æŸäº›ç‰¹å®šæƒ…å†µä¸‹Adamå¯èƒ½ä¸æ”¶æ•›ï¼Œå› ä¸ºäºŒé˜¶åŠ¨é‡å–çš„æ˜¯æŸä¸ªæ—¶é—´çª—å£çš„å˜åŒ–ï¼Œæ‰€ä»¥<span class="math inline">\(V_t\)</span>çš„å˜åŒ–å¯èƒ½ä¼šå‰§çƒˆéœ‡è¡ï¼Œå°¤å…¶åœ¨é«˜ç»´æƒ…å†µä¸‹ï¼Œæ¢¯åº¦çš„æ–¹å·®å¯èƒ½éšæ—¶é—´æ³¢åŠ¨å¾ˆå¤§ï¼Œå¯¼è‡´å­¦ä¹ ç‡éœ‡è¡ï¼Œæ¨¡å‹æ— æ³•æ”¶æ•›ã€‚è¿™ä¹Ÿæ˜¯ä¸ºä»€ä¹ˆä¸€èˆ¬<span class="math inline">\(\beta_2\)</span>è¦å–0.999è¿™ä¹ˆå¤§çš„å€¼ï¼Œé¿å…äºŒé˜¶åŠ¨é‡æœ‰å¤ªå¤§æ³¢åŠ¨ã€‚</p>
<p>ä¸€èˆ¬è®¤ä¸ºAdamé»˜è®¤çš„<span class="math inline">\(\beta_1\)</span>å’Œ<span class="math inline">\(\beta_2\)</span>ä¸éœ€è¦è°ƒæ•´ï¼Œé‡‡ç”¨é»˜è®¤çš„0.9å’Œ0.999å³å¯ã€‚ä½†æ˜¯è¿™ä¸¤ä¸ªè¶…å‚å¦‚æœä¸æŒ‰è¿™æ ·è®¾ç½®ï¼ŒAdamå¯èƒ½æ°¸è¿œä¸ä¼šæ”¶æ•›åˆ°æœ€ä¼˜å€¼ã€‚æ–‡ç« ä»æ•°å­¦ä¸Šè¯æ˜äº†å¯¹ä»»æ„çš„<span class="math inline">\(\beta_1,\beta_2\in[0,1),\beta_1&lt;\sqrt{\beta_2}\)</span>ï¼Œéƒ½å­˜åœ¨ä¸€ä¸ªéšæœºçš„å‡¸ä¼˜åŒ–é—®é¢˜ä½¿å¾—Adamä¸èƒ½æ”¶æ•›åˆ°æœ€ä¼˜è§£ã€‚</p>
<p>ä¸ºäº†é¿å…äºŒé˜¶åŠ¨é‡çš„å‰§çƒˆéœ‡è¡ï¼Œæ–‡ç« å¯¹å…¶è¿›è¡Œäº†æ§åˆ¶ï¼Œæå‡ºäº†ä¸€ä¸ªæ–°ç®—æ³•AMSGradç¡®ä¿æ¨¡å‹æ”¶æ•›ï¼Œ<span class="math inline">\(V_t=max(V_{t-1},\beta_2V_{t-1}+(1-\beta_2)\nabla^2 f(x_t))\)</span>ã€‚</p>
<p>ä½œè€…éšåé€šè¿‡äººé€ æ•°æ®å’ŒçœŸå®æ•°æ®è¿›è¡Œäº†å®éªŒï¼š</p>
<p>äººé€ æ•°æ®ä¸Šçš„ç»“æœï¼š <img src="https://img-blog.csdnimg.cn/20210710193934596.png" alt="åœ¨è¿™é‡Œæ’å…¥å›¾ç‰‡æè¿°" /> å¾ˆæ˜¾ç„¶åœ¨Adamæ²¡æœ‰æ‰¾åˆ°æœ€ä¼˜è§£çš„è¿™äº›æ•°æ®ä¸Šï¼Œæ”¹è¿›åçš„ç®—æ³•éƒ½è¡¨ç°è‰¯å¥½ã€‚</p>
<p>åœ¨MNISTä¸Šçš„æ•ˆæœï¼š <img src="https://img-blog.csdnimg.cn/20210710193956571.png" alt="åœ¨è¿™é‡Œæ’å…¥å›¾ç‰‡æè¿°" /> è¿™ç¯‡æ–‡ç« æœ€ç»ˆè·å¾—äº†2018å¹´ICLRæœ€ä½³è®ºæ–‡ï¼Œä½†æ˜¯å¼•èµ·äº†å¾ˆå¤§äº‰è®®ã€‚ä¸»è¦åŸå› åœ¨äºå…¶æ„é€ çš„ä»¤Adamå¤±æ•ˆçš„æ•°æ®åœ¨å®é™…æƒ…å†µä¸­å‡ºç°çš„æ¦‚ç‡æä½ï¼Œå³ä½¿å‡ºç°ä¹Ÿä¼šåœ¨æ•°æ®é¢„å¤„ç†æ—¶è¢«ç­›æ‰ï¼Œå› æ­¤å¹¶æ²¡æœ‰ç‰¹åˆ«å¹¿æ³›çš„å®é™…ç”¨å¤„ã€‚å¦å¤–ï¼Œæ–‡ç« è¿‡äºå¼ºè°ƒè®­ç»ƒé›†ä¸Šçš„æŸå¤±å‡½æ•°å€¼ï¼Œç”šè‡³æœ‰äººé€šè¿‡å¤ç°è¡¨æ˜æ–‡ç« æå‡ºçš„AMSGradç®—æ³•åœ¨æµ‹è¯•æ•°æ®ä¸Šè¡¨ç°å¾ˆå·®ï¼Œä¸åŸæ–‡ä¸­çš„æŸäº›ç»“è®ºç›¸äº’çŸ›ç›¾ã€‚ ### 3 å­¦ä¹ ç‡ä¸‹é™ arXivä¸Šçš„ä¸€ç¯‡æ–‡ç« é€šè¿‡åœ¨CIFAR-10ä¸Šçš„å®éªŒè¯æ˜Adamåœ¨ä¸€äº›æƒ…å†µä¸‹è™½ç„¶é€Ÿåº¦å¿«ï¼Œä½†æ”¶æ•›æ•ˆæœæ²¡æœ‰SGDå¥½ï¼š <img src="https://img-blog.csdnimg.cn/20210710194231292.png" alt="åœ¨è¿™é‡Œæ’å…¥å›¾ç‰‡æè¿°" /> æ–‡ç« é€šè¿‡å®éªŒå‘ç°ä¸»è¦åŸå› åœ¨äºåæœŸAdamçš„å­¦ä¹ ç‡è¿‡ä½ï¼Œå½±å“äº†æœ€ç»ˆæ•ˆæœã€‚æ–‡ç« å°è¯•é€šè¿‡æ§åˆ¶å­¦ä¹ ç‡ä¸‹ç•Œï¼Œæé«˜äº†æœ€ç»ˆæ”¶æ•›æ•ˆæœã€‚</p>
<p>æ—¢ç„¶AdamåæœŸæœ‰é—®é¢˜ï¼Œé‚£ä¹ˆä¸€ä¸ªè‡ªç„¶çš„æ”¹è¿›å°±æ˜¯å‰æœŸè®­ç»ƒä½¿ç”¨Adamï¼Œç”¨æ¥å¿«é€Ÿå‡å°lossï¼›åæœŸè®­ç»ƒè½¬æ¢ä¸ºSGDï¼Œç”¨ç¨æ…¢çš„é€Ÿåº¦å¯»æ‰¾æ›´ä½³çš„è§£ç”šè‡³æ˜¯æœ€ä¼˜è§£ã€‚ä½†æ˜¯è¿™æ ·ä¹Ÿä¼šå¼•å…¥æ–°çš„é—®é¢˜ï¼šåœ¨ä»€ä¹ˆæ—¶åˆ»åˆ‡æ¢ï¼Ÿåˆ‡æ¢ä¸ºSGDåçš„å­¦ä¹ ç‡åˆè¯¥å¦‚ä½•è®¾ç½®ï¼Ÿ</p>
<p>æ–‡ç« æå‡ºäº†SWATS(Switches from Adam to SGD)ç­–ç•¥æ¥è§£å†³ä¸Šé¢2ä¸ªé—®é¢˜ï¼Œåœ¨CIFAR-10å’ŒCIFAR-100æ•°æ®é›†ä¸Šå®éªŒæ•ˆæœçœ‹ç€è¿˜ä¸é”™ï¼š <img src="https://img-blog.csdnimg.cn/20210710194309531.png" alt="åœ¨è¿™é‡Œæ’å…¥å›¾ç‰‡æè¿°" /> <img src="https://img-blog.csdnimg.cn/20210710194329636.png" alt="åœ¨è¿™é‡Œæ’å…¥å›¾ç‰‡æè¿°" />è¿™äº›æ–‡ç« éƒ½é‡‡ç”¨äº†ä¸€äº›æ¯”è¾ƒæç«¯çš„æ•°æ®å»æ¢ç´¢Adamçš„ä¸é€‚æƒ…å†µï¼Œç„¶è€Œå®é™…ä¸­é‡åˆ°è¿™äº›æç«¯æƒ…å†µçš„æ¦‚ç‡å¹¶ä¸å¤§ï¼Œå› æ­¤Adamå¹¶ä¸å¤±ä¸ºé¦–é€‰å°è¯•ã€‚é€šè¿‡ä¸Šé¢çš„è®¨è®ºå¯ä»¥çœ‹åˆ°ï¼šSGDå’ŒAdamå„æœ‰ä¼˜åŠ£ï¼Œç²¾è°ƒåçš„SGDä¸€èˆ¬æœ€ç»ˆä¼šæ”¶æ•›åˆ°æ›´å¥½çš„æ•ˆæœï¼›Adamåœ¨è®­ç»ƒå‰æœŸæ”¶æ•›é€Ÿåº¦å¿«ï¼Œåœ¨ç¨€ç–æ•°æ®ä¸Šè¡¨ç°æ›´å¥½ï¼Œå¯¹è¶…å‚ä¸æ•æ„Ÿï¼Œä¸éœ€è¦ååˆ†ç²¾ç»†çš„è°ƒå‚ã€‚</p>
<p>å¦‚æœå¯¹ä¼˜åŒ–ç®—æ³•ä¸ç†Ÿæ‚‰ï¼Œå¯ä»¥å…ˆå°è¯•SGD+Nesterov Momentumæˆ–è€…Adamï¼›å¦‚æœå¯¹æŸä¸ªä¼˜åŒ–ç®—æ³•å¾ˆç²¾é€šï¼Œé‚£ä¹ˆè°ƒå‚å°±ä¼šç›¸å¯¹å®¹æ˜“äº›ã€‚å¦‚æœèµ„æºè¶³å¤Ÿï¼Œä¹Ÿå¯ä»¥å°è¯•L-BFGSç­‰äºŒé˜¶ä¼˜åŒ–æ–¹æ³•ã€‚å¦å¤–ï¼Œé€‰æ‹©ä¹‹å‰è¦å……åˆ†äº†è§£æ•°æ®çš„æ€§è´¨ï¼Œå¯¹äºæ¯”è¾ƒç¨€ç–çš„æ•°æ®å¯ä»¥ä¼˜å…ˆå°è¯•å­¦ä¹ ç‡è‡ªé€‚åº”è°ƒæ•´çš„ç®—æ³•ã€‚ ## Reference [1] CS231n: Convolutional Neural Networks for Visual Recognition. lecture 8, Stanford University. [2] The Marginal Value of Adaptive Gradient Methods in Machine Learning. NIPS'17 [3] On the Convergence of Adam and Beyond. ICLR'18 [4] Improving Generalization Performance by Switching from Adam to SGD. arXiv [5] Optimization methods for large-scale machine learning. SIAM Review, 2018. [6] Optimization for deep learning: theory and algorithms. arXiv, 2019. [7] Understanding Black-box Predictions via Influence Functions. ICML'17. [8] Understanding Deep Learning Requires Rethinking Generalization. ICLR'17.</p>

      
    </div>

    
    
    
      <footer class="post-footer">
        <div class="post-eof"></div>
      </footer>
  </article>
  
  
  

      
  
  
  <article itemscope itemtype="http://schema.org/Article" class="post-block" lang="en">
    <link itemprop="mainEntityOfPage" href="https://eimadrigal.github.io/2021/06/17/Gradient%20Boosting/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="image" content="/images/favicon.png">
      <meta itemprop="name" content="EIMadrigal">
      <meta itemprop="description" content="Hello World">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="EI Madrigal's Space">
    </span>
      <header class="post-header">
        <h2 class="post-title" itemprop="name headline">
          
            <a href="/2021/06/17/Gradient%20Boosting/" class="post-title-link" itemprop="url">Gradient Boosting</a>
        </h2>

        <div class="post-meta">

		  
            <span class="post-meta-item">
              <span class="post-meta-item-icon">
                <i class="far fa-calendar"></i>
              </span>
              <span class="post-meta-item-text">Posted on</span>

              <time title="Created: 2021-06-17 08:51:00" itemprop="dateCreated datePublished" datetime="2021-06-17T08:51:00+08:00">2021-06-17</time>
            </span>

          

        </div>
      </header>

    
    
    
    <div class="post-body" itemprop="articleBody">

      
          <h2 id="gradient-boosting-regression">Gradient Boosting Regression</h2>
<h2 id="gradient-boosting-classification">Gradient Boosting Classification</h2>
<h2 id="xgboost">XGBoost</h2>
<h2 id="å†³ç­–æ ‘é›†æˆ">å†³ç­–æ ‘é›†æˆ</h2>
<p>é›†æˆå­¦ä¹ å¯ä»¥ç»„åˆå¤šä¸ªåŸºå­¦ä¹ å™¨ï¼Œäº§ç”Ÿæ›´åŠ ä¼˜å¼‚çš„æ€§èƒ½ã€‚å°†å†³ç­–æ ‘ï¼ˆå¦‚CARTï¼‰ä½œä¸ºåŸºå­¦ä¹ å™¨ï¼Œç»“åˆæ¯ä¸ªåŸºå­¦ä¹ å™¨çš„é¢„æµ‹ç»“æœä½œä¸ºæœ€ç»ˆè¾“å‡ºï¼Œå°±åƒ<a target="_blank" rel="noopener" href="https://xgboost.readthedocs.io/en/latest/tutorials/model.html">ä¸‹å›¾</a>è¿™æ ·ï¼š <img src="https://img-blog.csdnimg.cn/2021061621501811.png" alt="åœ¨è¿™é‡Œæ’å…¥å›¾ç‰‡æè¿°" /> æ­£å¼ä¸€äº›çš„è¡¨ç¤ºï¼š <span class="math display">\[\hat{y}_i = \sum_{k=1}^K f_k(x_i), f_k \in \mathcal{F}\]</span> å…¶ä¸­ï¼Œ<span class="math inline">\(K\)</span>æ˜¯å†³ç­–æ ‘ä¸ªæ•°ï¼Œ<span class="math inline">\(f_k(x_i)\)</span>è¡¨ç¤ºç¬¬<span class="math inline">\(k\)</span>ä¸ªå†³ç­–æ ‘çš„é¢„æµ‹å€¼ã€‚</p>
<p>ä¸ºäº†å®šé‡æè¿°æ¨¡å‹å‚æ•°ä¸è®­ç»ƒæ•°æ®çš„åŒ¹é…ç¨‹åº¦ï¼Œæˆ‘ä»¬è¿˜è¦å®šä¹‰å¾…ä¼˜åŒ–çš„ç›®æ ‡å‡½æ•°ï¼š <span class="math display">\[\text{obj}(\theta) = \sum_i^n l(y_i, \hat{y}_i) + \sum_{k=1}^K \Omega(f_k)\]</span> ## Boosting Decision Tree é›†æˆå¤šæ£µæ ‘çš„æ–¹å¼å¯ä»¥æ˜¯Baggingï¼Œä¹Ÿå¯ä»¥æ˜¯Boostingã€‚Boostingçš„motivationæ˜¯ç”¨ä¸€æ£µæ–°æ ‘ä¸æ–­æ‹Ÿåˆå½“å‰çš„é›†æˆæ¨¡å‹ä¸çœŸå®å€¼çš„æ®‹å·®ï¼Œæ‹Ÿåˆåå°†è¯¥æ ‘ä¹ŸåŠ å…¥æ¨¡å‹ä¸­ï¼Œå³æ‰€è°“çš„Additive Trainingï¼š <span class="math display">\[\hat{y}_i^{(0)} = 0\\
\hat{y}_i^{(1)} = f_1(x_i) = \hat{y}_i^{(0)} + f_1(x_i)\\
\hat{y}_i^{(2)} = f_1(x_i) + f_2(x_i)= \hat{y}_i^{(1)} + f_2(x_i)\\
\dots\\
\hat{y}_i^{(t)} = \sum_{k=1}^t f_k(x_i)= \hat{y}_i^{(t-1)} + f_t(x_i)\]</span> å¥½äº†ï¼Œæ¥ä¸‹æ¥çš„é—®é¢˜å°±æ˜¯æ¯æ¬¡è¿­ä»£æ—¶çš„é‚£æ£µæ–°æ ‘<span class="math inline">\(f_t\)</span>è¦æ€ä¹ˆè®­ç»ƒå‘¢ï¼Ÿä¸€ä¸ªç›´è§‚çš„æƒ³æ³•å°±æ˜¯é€‰æ‹©é‚£æ£µä»¤ç›®æ ‡å‡½æ•°æœ€å°çš„æ ‘ï¼š <span class="math display">\[\text{obj}^{(t)} = \sum_{i=1}^n l(y_i, \hat{y}_i^{(t)}) + \sum_{i=1}^t\Omega(f_i) \\
          = \sum_{i=1}^n l(y_i, \hat{y}_i^{(t-1)} + f_t(x_i)) + \Omega(f_t) + \mathrm{constant}\]</span> æˆ‘ä»¬å…ˆé€‰æ‹©MSEä½œä¸ºæŸå¤±å‡½æ•°ï¼Œçœ‹çœ‹ä¼šå‘ç”Ÿä»€ä¹ˆï¼š <span class="math display">\[{obj}^{(t)} = \sum_{i=1}^n (y_i - (\hat{y}_i^{(t-1)} + f_t(x_i)))^2 + \sum_{i=1}^t\Omega(f_i) \\
          = \sum_{i=1}^n [2(\hat{y}_i^{(t-1)} - y_i)f_t(x_i) + f_t(x_i)^2] + \Omega(f_t) + \mathrm{constant}\]</span> è™½ç„¶MSEçš„å½¢å¼æ¯”è¾ƒå‹å¥½ï¼Œä½†æ˜¯å¦‚æœé€‰æ‹©å…¶å®ƒæŸå¤±å‡½æ•°å°±å¾ˆéš¾æœ‰ä¸Šå¼é‚£èˆ¬äººæ€§äº†ï¼Œåƒå¾—å¤ªé¥±çš„åŒå­¦å¯ä»¥è¯•è¯•logistic lossï¼š <span class="math display">\[L(\theta) = \sum_i[ y_i\ln (1+e^{-\hat{y}_i}) + (1-y_i)\ln (1+e^{\hat{y}_i})]\]</span> ä¸ºäº†å¢å¼ºå¯æ‰©å±•æ€§ã€ä¾¿äºè®¡ç®—ï¼Œä¸€èˆ¬é‡‡ç”¨æŸå¤±å‡½æ•°çš„äºŒé˜¶æ³°å‹’å±•å¼€å»åšä¸€ä¸ªè¿‘ä¼¼ï¼š <span class="math display">\[\text{obj}^{(t)} = \sum_{i=1}^n [l(y_i, \hat{y}_i^{(t-1)}) + g_i f_t(x_i) + \frac{1}{2} h_i f_t^2(x_i)] + \Omega(f_t) + \mathrm{constant}\]</span> å…¶ä¸­ï¼Œ<span class="math inline">\(g_i = \partial_{\hat{y}_i^{(t-1)}} l(y_i, \hat{y}_i^{(t-1)}),h_i = \partial_{\hat{y}_i^{(t-1)}}^2 l(y_i, \hat{y}_i^{(t-1)})\)</span>ã€‚ æ‰”æ‰æ‰€æœ‰å¸¸æ•°é¡¹ï¼Œå°±å¾—åˆ°äº†ç¬¬<span class="math inline">\(t\)</span>æ­¥çš„ç›®æ ‡å‡½æ•°ï¼š <span class="math display">\[\sum_{i=1}^n [g_i f_t(x_i) + \frac{1}{2} h_i f_t^2(x_i)] + \Omega(f_t)\]</span></p>
<p>å¼„å®Œäº†training lossï¼Œæ¥ç€è¿˜å¾—ç ”ç©¶ä¸‹æ­£åˆ™é¡¹<span class="math inline">\(\Omega(f_t)\)</span>ï¼Œé¦–å…ˆå¾—ç»™<span class="math inline">\(f(x)\)</span>æ¥ä¸€ä¸ªæ­£å¼ç‚¹çš„å®šä¹‰ï¼š <span class="math display">\[f_t(x) = w_{q(x)}, w \in R^T, q:R^d\rightarrow \{1,2,\cdots,T\} .\]</span> å…¶ä¸­ï¼Œ<span class="math inline">\(w\)</span>æ˜¯å¶å­ç»“ç‚¹çš„å¾—åˆ†å‘é‡ï¼Œ<span class="math inline">\(q\)</span>æ˜¯å°†æ ·æœ¬ç‚¹æ˜ å°„åˆ°å¯¹åº”å¶å­çš„å‡½æ•°ï¼Œ<span class="math inline">\(T\)</span>æ˜¯å¶å­æ•°ç›®ã€‚ å¦‚æœæœ‰ç‚¹æŠ½è±¡ï¼Œå°±çœ‹çœ‹ä¸Šå›¾ä¸­çš„å·¦å­å›¾å§ï¼š<span class="math inline">\(w=[2,-1],f(ç”·å­©)=w_{q(ç”·å­©)}=w_0=2\)</span>ã€‚</p>
<p>æ¨¡å‹å¤æ‚åº¦çš„å…·ä½“å®šä¹‰éšä½ äº†ï¼ŒXGBoostæ˜¯è¿™ä¹ˆå®šä¹‰çš„ï¼š <span class="math display">\[\Omega(f) = \gamma T + \frac{1}{2}\lambda \sum_{j=1}^T w_j^2\]</span> å°±ç”¨ä¸Šå¼é‡æ–°å†™å‡ºæˆ‘ä»¬ç¬¬<span class="math inline">\(t\)</span>æ­¥çš„ç›®æ ‡å‡½æ•°ï¼š <span class="math display">\[\text{obj}^{(t)} \approx \sum_{i=1}^n [g_i w_{q(x_i)} + \frac{1}{2} h_i w_{q(x_i)}^2] + \gamma T + \frac{1}{2}\lambda \sum_{j=1}^T w_j^2\\
= \sum^T_{j=1} [(\sum_{i\in I_j} g_i) w_j + \frac{1}{2} (\sum_{i\in I_j} h_i + \lambda) w_j^2 ] + \gamma T\]</span> å…¶ä¸­ï¼Œ<span class="math inline">\(I_j = \{i|q(x_i)=j\}\)</span>è¡¨ç¤ºç¬¬<span class="math inline">\(j\)</span>ä¸ªå¶å­ä¸­æ ·æœ¬ç‚¹çš„ç´¢å¼•é›†åˆï¼Œç”±äºä»»æ„ä¸€ä¸ªå¶å­ä¸­æ ·æœ¬ç‚¹å¾—åˆ†ç›¸åŒï¼Œå› æ­¤ä¸Šå¼å†™æˆäº†å¯¹<span class="math inline">\(T\)</span>ä¸ªå¶å­çš„æ±‚å’Œã€‚</p>
<p>ä»¤<span class="math inline">\(G_j = \sum_{i\in I_j} g_i\)</span>åŠ<span class="math inline">\(H_j = \sum_{i\in I_j} h_i\)</span>ï¼Œå°±æœ‰äº†ä¸€ä¸ªç›¸å¯¹ç®€æ´çš„è¡¨ç¤ºï¼š <span class="math display">\[\text{obj}^{(t)} = \sum^T_{j=1} [G_jw_j + \frac{1}{2} (H_j+\lambda) w_j^2] +\gamma T\]</span> å› ä¸ºå¶å­ä¹‹é—´ç›¸äº’ç‹¬ç«‹ï¼Œæ‰€ä»¥ä»¤ç›®æ ‡å‡½æ•°æœ€ä¼˜çš„å¾—åˆ†å‘é‡<span class="math inline">\(w\)</span>ä¸ºï¼š <span class="math display">\[w_j^\ast = -\frac{G_j}{H_j+\lambda}\\
\text{obj}^\ast = -\frac{1}{2} \sum_{j=1}^T \frac{G_j^2}{H_j+\lambda} + \gamma T\]</span> ç›®æ ‡å‡½æ•°<span class="math inline">\(obj^*\)</span>çš„å€¼è¡¡é‡ç€æœ¬æ¬¡è¿­ä»£æ ‘ç»“æ„<span class="math inline">\(q(x)\)</span>å¯¹è®­ç»ƒæ•°æ®çš„æ‹Ÿåˆç¨‹åº¦ã€‚</p>
<p>äº‘é‡Œé›¾é‡Œä¸€å¤§å †ï¼Œæˆ‘éƒ½çƒ¦äº†ï¼Œæ¥çœ‹ä¸ªä¾‹å­ï¼š <img src="https://img-blog.csdnimg.cn/2021061716123725.png" alt="åœ¨è¿™é‡Œæ’å…¥å›¾ç‰‡æè¿°" /> å‡è®¾åœ¨ç¬¬<span class="math inline">\(t\)</span>æ¬¡è¿­ä»£é€‰äº†è¿™ä¹ˆä¸€æ£µæ ‘ï¼ŒæŒ‰ç…§if-thenè§„åˆ™å°†è®­ç»ƒæ ·æœ¬åˆ†åˆ°ç›¸åº”çš„å¶å­ï¼Œå°†æ¢¯åº¦ä¿¡æ¯ç›¸åŠ å¾—åˆ°æ¯ä¸ªå¶å­å¯¹åº”çš„<span class="math inline">\(G,H\)</span>ï¼Œæ¥ç€ç”¨<span class="math inline">\(obj^*\)</span>è®¡ç®—è¿™æ£µæ ‘æœ€å°çš„æŸå¤±ï¼Œä¸è¡Œå°±æ¢ä¸€ç§æ ‘ç»“æ„ï¼Œä»¥æ±‚å‡å°<span class="math inline">\(obj^*\)</span>ã€‚</p>
<p>å¿™æ´»äº†å¤§åŠå¤©ï¼Œç»ˆäºçŸ¥é“äº†æ€ä¹ˆåº¦é‡ä¸€æ£µæ ‘çš„å¥½åã€‚é‚£ä¹ˆåªè¦æšä¸¾æ‰€æœ‰å¯èƒ½çš„æ ‘ç»“æ„ï¼Œé€‰é‚£ä¸ªä»¤<span class="math inline">\(obj^*\)</span>æœ€å°çš„å°±å¥½äº†ã€‚å‚»å­éƒ½çŸ¥é“è¿™æ˜¯ä¸è¡Œæ»´ï¼Œæ‰€ä»¥åªèƒ½è´ªå¿ƒåœ°ä¸€å±‚ä¸€å±‚åœ°å‰¥å¼€ä½ çš„å¿ƒ...å“¦ä¸å¯¹ï¼Œä¸€å±‚ä¸€å±‚åœ°ä¼˜åŒ–ï¼šå°†ç»“ç‚¹åˆ†ç±»ä¸ºå·¦å­©å­å’Œå³å­©å­çš„å¾—åˆ†å¢ç›Šä¸ºï¼š <span class="math display">\[Gain = \frac{1}{2} \left[\frac{G_L^2}{H_L+\lambda}+\frac{G_R^2}{H_R+\lambda}-\frac{(G_L+G_R)^2}{H_L+H_R+\lambda}\right] - \gamma\]</span> å…¶ä¸­ï¼Œç¬¬ä¸€/äºŒé¡¹åˆ†åˆ«è¡¨ç¤ºå·¦/å³å­©å­çš„åˆ†æ•°ï¼Œç¬¬ä¸‰é¡¹è¡¨ç¤ºåŸå§‹èŠ‚ç‚¹çš„åˆ†æ•°ï¼Œæœ€åä¸€é¡¹è¡¨ç¤ºå¢åŠ å¶å­çš„æƒ©ç½šã€‚å¯ä»¥çœ‹åˆ°ï¼šå¦‚æœåˆ†è£‚åçš„å¾—åˆ†å¢ç›Šå°äº<span class="math inline">\(\gamma\)</span>ï¼Œå°±ä¸è¦ç»§ç»­åˆ†äº†ï¼Œå‡‘åˆè¿‡å§...</p>
<p>ä¸ºäº†åœ¨æ¯å±‚è·å–åˆ°æœ€ä½³çš„åˆ†è£‚ç‚¹ï¼Œé€šå¸¸å…ˆå°†è®­ç»ƒæ•°æ®æ’ä¸ªåºï¼š <img src="https://img-blog.csdnimg.cn/20210617164041605.png" alt="åœ¨è¿™é‡Œæ’å…¥å›¾ç‰‡æè¿°" /> æš´åŠ›æšä¸¾ä¸€éåˆ†è£‚ç‚¹æ‰¾æœ€ä¼˜å°±å¯ä»¥å•¦ï¼</p>
<ul>
<li><span class="math inline">\(f_0(x)=0\)</span></li>
<li>å¯¹äºç¬¬mæ£µæ ‘çš„è®­ç»ƒï¼š
<ul>
<li>é¦–å…ˆè®¡ç®—æ¯æ¡è®­ç»ƒæ•°æ®çš„æ®‹å·®ï¼š<span class="math inline">\(r_{mi}=y_i-f_{m-1}(x_i),i=1,2...,N\)</span></li>
<li>æ¥ç€é€šè¿‡æ‹Ÿåˆä¸Šé¢å¾—åˆ°çš„æ®‹å·®æ•°æ®ï¼Œè®­ç»ƒå‡ºå›å½’æ ‘<span class="math inline">\(T_m(x)\)</span></li>
<li>æ­¤æ—¶ç¬¬mæ£µæ ‘çš„è¾“å‡ºå³ä¸º<span class="math inline">\(f_m(x)=f_{m-1}(x)+T_m(x)\)</span></li>
</ul></li>
<li>è¿›è¡ŒMæ¬¡è®­ç»ƒåå¾—åˆ°æœ€ç»ˆçš„æ¨¡å‹</li>
</ul>
<p>å¯ä»¥çœ‹åˆ°ï¼šBoosting Decision Treeæ¯æ¬¡è¿­ä»£éƒ½å°†ä¸Šä¸€è½®é¢„æµ‹ç»“æœçš„æ®‹å·®ä½œä¸ºå½“å‰çš„è®­ç»ƒé›†ï¼Œå¯¹äºå¹³æ–¹æŸå¤±å®¹æ˜“æ±‚å¾—æŸå¤±å‡½æ•°æœ€å°å€¼çš„ç‚¹ï¼Œä½†æ˜¯å¯¹äºç¨å¤æ‚çš„æŸå¤±å‡½æ•°ï¼Œæ®‹å·®çš„è·å¾—å°±åªèƒ½é€šè¿‡è´Ÿæ¢¯åº¦<span class="math inline">\(\frac{\partial L(y_i,f(x_i))}{f(x_i)}\)</span>å»é€¼è¿‘ï¼Œè¿™å°±æ˜¯GBDTçš„æ ¸å¿ƒæ€æƒ³ã€‚ GBDTçš„è®­ç»ƒä¸Boosting Decision Treeå¾ˆç›¸ä¼¼ï¼š</p>
<ul>
<li>åˆå§‹åŒ–å¼±å­¦ä¹ å™¨<span class="math inline">\(f_0(x)=\underset{c}{arg\ min}\sum_{i=1}^{N}L(y_i,c)\)</span>ï¼Œå¦‚æœæŸå¤±å‡½æ•°æ˜¯MSEï¼Œé‚£ä¹ˆ<span class="math inline">\(f_0(x)=\frac{1}{N}\sum_{i=1}^{N}y_i\)</span></li>
<li>å¯¹äºç¬¬mæ£µæ ‘çš„è®­ç»ƒï¼š
<ul>
<li>è®¡ç®—è´Ÿæ¢¯åº¦ï¼š<span class="math inline">\(r_{mi}=-\frac{\partial L(y_i,f(x_i))}{\partial f(x_i)},f(x)=f_{m-1}(x)\)</span></li>
<li>å¾—åˆ°æ–°çš„è®­ç»ƒé›†<span class="math inline">\((x_i,r_{mi})\)</span>ï¼Œè®­ç»ƒäº§ç”Ÿä¸€æ£µæ–°çš„å›å½’æ ‘ï¼Œå¯¹åº”çš„å¶å­ç»“ç‚¹åŸŸä¸º<span class="math inline">\(R_{mj},j=1,...,J\)</span>ï¼Œ<span class="math inline">\(J\)</span>ä¸ºå¶å­ç»“ç‚¹ä¸ªæ•°</li>
<li>å¯¹ç¬¬jä¸ªå¶å­ç»“ç‚¹ï¼Œè®¡ç®—æœ€ä½³æ‹Ÿåˆå€¼ï¼š<span class="math inline">\(c_{mj}=\underset{c}{arg\ min}\sum_{x_i\in R_{mj}}L(y_i,f_{m-1}(x_i)+c)\)</span></li>
<li>æ›´æ–°å¼ºå­¦ä¹ å™¨ï¼š<span class="math inline">\(f_m(x)=f_{m-1}(x)+\sum_{i=1}^{J}c_{mj}I(x\in R_{mj})\)</span></li>
</ul></li>
<li>æœ€ç»ˆçš„å­¦ä¹ å™¨ä¸ºï¼š<span class="math inline">\(\hat f(x)=f_M(x)=f_0(x)+\sum_{m=1}^{M}\sum_{j=1}^{J}c_{mj}I(x\in R_{mj})\)</span></li>
</ul>
<h2 id="implementation">Implementation</h2>
<h2 id="properties">Properties</h2>
<ol type="1">
<li>extrapolateé—®é¢˜ ä¼—æ‰€å‘¨çŸ¥éšæœºæ£®æ—å›å½’æ˜¯ä¸å…·å¤‡æ¨ç†èƒ½åŠ›çš„ï¼Œé‚£ä¹ˆXGBoostå¯ä»¥å—ï¼Ÿ ç­”æ¡ˆæ˜¯å¯ä»¥ï¼Œå› ä¸ºæ¢¯åº¦æå‡æ¨¡å‹å¹¶ä¸ç›´æ¥æ ¹æ®è®­ç»ƒé›†çš„ç»“æœåšé¢„æµ‹ï¼Œè€Œæ˜¯é€šè¿‡ä¸€ç³»åˆ—æ ‘çš„åŠ å’Œå¾—åˆ°ï¼ŒåŠ å’Œç»“æœå–å†³äºæ¯æ£µæ ‘çš„æƒé‡ï¼Œæƒé‡åˆ™æ˜¯ç”±æŸå¤±å‡½æ•°çš„ä¸€äºŒé˜¶æ¢¯åº¦ä¼˜åŒ–å¾—æ¥ï¼Œå¹¶ä¸ä¾èµ–äºè®­ç»ƒé›†çš„ä¸Šä¸‹é™ã€‚</li>
<li>ç¼ºå¤±å€¼é—®é¢˜ GBDT/GBRTè‡ªèº«ä¸æ”¯æŒç¼ºå¤±å€¼çš„è‡ªåŠ¨å¡«å……ï¼Œä¾‹å¦‚ä½¿ç”¨sklearnä¸­çš„GradientBoostingRegressoråœ¨è®­ç»ƒæ•°æ®åŒ…å«ç¼ºå¤±å€¼æ—¶å°†æ— æ³•è®­ç»ƒï¼Œäººå·¥å¡«å……å¯èƒ½ä¼šå¼•å…¥åå·®ï¼Œä½†æ˜¯XGBoostå´å¯ä»¥è‡ªåŠ¨åœ°å¤„ç†ç¼ºå¤±å€¼ï¼ˆä½†å¹¶ä¸æ˜¯å¡«å……ï¼‰ã€‚ æ ¹æ®é™ˆå¤©å¥‡å¤§ä½¬çš„è¯´æ³•ï¼š &gt; Internally, XGBoost will automatically learn what is the best direction to go when a value is missing. Equivalently, this can be viewed as automatically "learn" what is the best imputation value for missing values based on reduction on training loss.</li>
</ol>
<p>é‚£ä¹ˆç©¶ç«Ÿæ˜¯å¦‚ä½•è‡ªåŠ¨å­¦ä¹ æœ€ä½³çš„åˆ†è£‚æ–¹å‘å‘¢ï¼Ÿ å‡è®¾åœ¨ç»“ç‚¹Aæœ‰50æ¡è®­ç»ƒæ ·æœ¬ï¼Œå¹¶ä¸”è¯¥ç»“ç‚¹åªæœ‰ä¸€ä¸ªå¯èƒ½çš„åˆ†å‰²ç‚¹ï¼šæ¯”å¦‚åªæœ‰ä¸€ä¸ªäºŒå…ƒç‰¹å¾xï¼Œé‚£ä¹ˆåˆ†å‰²ç‚¹å°±åªæœ‰è¯¥ç‰¹å¾å–å€¼ä¸º0æˆ–1ï¼Œè¿™æ ·è®­ç»ƒæ•°æ®å¯ä»¥è¢«åˆ†ä¸º3ç»„ï¼š 1. xå–å€¼ä¸ºBçš„20æ¡æ ·ä¾‹ 2. xå–å€¼ä¸ºCçš„20æ¡æ ·ä¾‹ 3. xç¼ºå¤±çš„10æ¡æ ·ä¾‹ï¼Œå«åšMç»„</p>
<p>é‚£ä¹ˆMç»„çš„æ ·ä¾‹ä¼šè¢«åˆ†åˆ«èµ‹åˆ°Bå’ŒCï¼Œæ¥ç€è®¡ç®—<span class="math inline">\(\{(B,M),C\}\)</span>å’Œ<span class="math inline">\(\{B,(C,M)\}\)</span>çš„å¾—åˆ†åŠæŸå¤±å‡½æ•°è¡°å‡ï¼Œä¸¤è€…ä¸­é€‰æ‹©æŸå¤±å‡½æ•°è¡°å‡å¤§çš„ã€‚ å¦‚æœä½¿ç”¨MSEä½œä¸ºæŸå¤±å‡½æ•°ï¼Œå¹¶ä¸”Bçš„æ ‡ç­¾å‡å€¼ä¸º5ï¼ŒCçš„æ ‡ç­¾å‡å€¼ä¸º10ï¼ŒMçš„æ ‡ç­¾å‡å€¼ä¸º0ã€‚ å¦‚æœä½¿ç”¨<span class="math inline">\(\{(B,M),C\}\)</span>ï¼š<span class="math inline">\(\frac{|M|}{|B| + |M|}\text{mean}(M) + \frac{|B|}{|M|+|B|}\text{mean}(B) = \frac{10}{30}0 + \frac{20}{30}5 = 3.\overline{3}\)</span> å¦‚æœä½¿ç”¨<span class="math inline">\(\{B,(C,M)\}\)</span>ï¼š<span class="math inline">\(\frac{|M|}{|C| + |M|}\text{mean}(M) + \frac{|C|}{|M|+|C|}\text{mean}(C) = \frac{10}{30}0 + \frac{20}{30}10 = 6.\overline{3}\)</span> æœ€åè®¡ç®—ä¸¤è€…çš„MSEä¸åˆ’åˆ†å‰MSEçš„å·®ï¼Œé€‰æ‹©ä½¿å¾—MSEä¸‹é™æ›´å¿«çš„ä½œä¸ºåˆ†è£‚æ–¹å‘ï¼ˆä¹Ÿå°±æ˜¯å¾—åˆ†gainæ›´å¤§çš„æ–¹å‘ï¼‰ã€‚</p>
<p>åœ¨å¯»æ‰¾æœ€ä¼˜ç‰¹å¾åˆ†è£‚ç‚¹ï¼ˆå¦‚å¹´é¾„ï¼œ20è¿˜æ˜¯å¹´é¾„ï¼œ30ï¼‰æ—¶ï¼Œåªè®¿é—®è¯¥ç‰¹å¾ä¸å«ç¼ºå¤±å€¼çš„è®­ç»ƒæ ·ä¾‹ï¼Œå³å¦‚æœå¹´é¾„ç¼ºå¤±ï¼Œå°±ä¸å‚ä¸20å’Œ30çš„å†³ç­–ï¼Œè¿™æ ·è®¡ç®—å¤æ‚åº¦ä¹Ÿå°±é™ä½äº†ï¼Œå°¤å…¶æ˜¯å¯¹äºç¨€ç–æ•°æ®ã€‚</p>
<p>é¢„æµ‹æ—¶çš„ç¼ºå¤±å€¼æœ‰ï¼’ç§æƒ…å†µï¼š 1.ã€€è®­ç»ƒé˜¶æ®µå·²ç»è§è¯†è¿‡è¯¥ç¼ºå¤±å€¼äº†ï¼šæŒ‰ç…§è®­ç»ƒæ—¶é€‰å®šçš„æ–¹å‘å¾€ä¸‹èµ°å°±è¡Œ 2.ã€€è®­ç»ƒé˜¶æ®µè¯¥ç‰¹å¾æ²¡æœ‰ç¼ºå¤±ï¼šé»˜è®¤èµ°å‘å³å­æ ‘ã€‚</p>
<p>Refé‡Œè¿˜æœ‰ä¸€ä¸ªæ›´åŠ å…¨é¢çš„ä¾‹å­ï¼Œè®­ç»ƒé›†æœ‰6ä¸ªå°å­©ï¼Œåªæœ‰ä¸€ä¸ªç‰¹å¾å¹´é¾„ï¼ˆå…¶ä¸­æœ‰2ä¸ªæ ·ä¾‹å¹´é¾„ç¼ºå¤±ï¼‰ï¼Œæ ‡ç­¾æ˜¯èº«é«˜ï¼Œåˆå§‹é¢„æµ‹å€¼ä¸º0.5ï¼Œæ¥ä¸‹æ¥æ¯æ£µæ ‘éƒ½è¦æ‹Ÿåˆæ®‹å·®ã€‚ | Age | Height | Res | | ------------ | ------------ | ------------ | | 7 | 130 | ï¼129.5 | | 9 | 148 | ï¼147.5 | | 6 | 115 | ï¼114.5 | | 15 | 164 | ï¼163.5 | | ï¼Ÿ | 125 | ï¼124.5 | | ï¼Ÿ | 140 | ï¼139.5 |</p>
<p>æ¥ç€è¦æ ¹æ®å¹´é¾„ç‰¹å¾å¯»æ‰¾æœ€ä¼˜çš„åˆ†è£‚ç‚¹ï¼Œå°†å¹´é¾„æ’åºå¹¶é€‰æ‹©ä¸­ç‚¹ï¼ˆ<strong>æ³¨æ„ï¼šè¿™é‡Œå°±ä¸è€ƒè™‘ç¼ºå¤±å€¼æ ·ä¾‹äº†</strong>ï¼‰ï¼Œå› æ­¤å€™é€‰åˆ†è£‚ç‚¹æœ‰6.5ï¼Œ8ï¼Œ12ï¼Œå¯¹äºæ¯ä¸ªå€™é€‰ç‚¹ï¼Œåˆ†åˆ«è®¡ç®—å°†ç¼ºå¤±æ ·ä¾‹åˆ’åˆ°å·¦å­æ ‘å’Œå³å­æ ‘çš„Quality/Similarity Scoreï¼š</p>
<p><span class="math display">\[
Quality\ Score=\frac{(\sum residuals)^2}{\#residuals + \lambda}
\]</span></p>
<p>æ¯”å¦‚ï¼Œå¯¹äºåˆ†è£‚ç‚¹6.5ï¼š å¦‚æœåˆ’åˆ°å·¦å­æ ‘ï¼š<span class="math inline">\(Gainï¼åˆ’åˆ†åçš„Quality\ Scoreï¼åˆ’åˆ†å‰çš„Quality\ Scoreï¼\frac{(-114.5-124.5-139.5)^2}{3} + \frac{(-129.5-147.5-163.5)^2}{3} - \frac{(-129.5-147.5-114.5-163.5-124.5-139.5)^2}{6}=640.7\)</span> å¦‚æœåˆ’åˆ°å³å­æ ‘ï¼š<span class="math inline">\(Gainï¼åˆ’åˆ†åçš„Quality\ Scoreï¼åˆ’åˆ†å‰çš„Quality\ Scoreï¼580.8\)</span></p>
<p>æ¥ç€å¯¹äº8ï¼š1083ï¼›630.8 å¯¹äº12ï¼š874.8ï¼›216 ä»ä¸­é€‰æ‹©gainæœ€å¤§çš„ï¼ˆä¹Ÿå°±æ˜¯ä½¿å¾—æŸå¤±å‡½æ•°æœ€å°çš„ï¼‰ï¼Œåˆ†è£‚ç‚¹é€‰8ï¼Œç¼ºå¤±å€¼åˆ’åˆ°å·¦å­æ ‘ã€‚ ## Bug <a target="_blank" rel="noopener" href="https://www.lycecho.com/archives/2364">PYTHON XGBOOST æŠ¥é”™ KEYERROR: â€˜BASE_SCOREâ€™</a></p>
<h2 id="references">References</h2>
<p><a target="_blank" rel="noopener" href="https://www.youtube.com/watch?v=3CC4N4z3GJc"><strong>Gradient Boost</strong></a> <a target="_blank" rel="noopener" href="https://xgboost.readthedocs.io/en/latest/tutorials/model.html">Introduction to Boosted Trees</a> <a target="_blank" rel="noopener" href="https://datascience.stackexchange.com/questions/15305/how-does-xgboost-learn-what-are-the-inputs-for-missing-values">Missing values in XGBoost</a> <a target="_blank" rel="noopener" href="https://stats.stackexchange.com/questions/304962/is-is-possible-for-a-gradient-boosting-regression-to-predict-values-outside-of-t">Is is possible for a gradient boosting regression to predict values outside of the range seen in its training data?</a> <a target="_blank" rel="noopener" href="https://datascience.stackexchange.com/questions/77234/can-boosted-trees-predict-below-the-minimum-value-of-the-training-label">Can Boosted Trees predict below the minimum value of the training label?</a> <a target="_blank" rel="noopener" href="https://github.com/dmlc/xgboost/issues/1581#issuecomment-249853718">Why does XGBoost regression predict completely unseen values?</a> <a target="_blank" rel="noopener" href="https://medium.com/hypatai/how-xgboost-handles-sparsities-arising-from-of-missing-data-with-an-example-90ce8e4ba9ca">How XGBoost Handles Sparsities Arising From of Missing Data? (With an Example)</a> <a target="_blank" rel="noopener" href="https://www.youtube.com/watch?v=OtD8wVaFm6E"><strong>XGBoost Regression</strong></a></p>

      
    </div>

    
    
    
      <footer class="post-footer">
        <div class="post-eof"></div>
      </footer>
  </article>
  
  
  


  
  <nav class="pagination">
    <a class="extend prev" rel="prev" href="/"><i class="fa fa-angle-left" aria-label="Previous page"></i></a><a class="page-number" href="/">1</a><span class="page-number current">2</span><a class="page-number" href="/page/3/">3</a><span class="space">&hellip;</span><a class="page-number" href="/page/17/">17</a><a class="extend next" rel="next" href="/page/3/"><i class="fa fa-angle-right" aria-label="Next page"></i></a>
  </nav>



          </div>
          

<script>
  window.addEventListener('tabs:register', () => {
    let { activeClass } = CONFIG.comments;
    if (CONFIG.comments.storage) {
      activeClass = localStorage.getItem('comments_active') || activeClass;
    }
    if (activeClass) {
      let activeTab = document.querySelector(`a[href="#comment-${activeClass}"]`);
      if (activeTab) {
        activeTab.click();
      }
    }
  });
  if (CONFIG.comments.storage) {
    window.addEventListener('tabs:click', event => {
      if (!event.target.matches('.tabs-comment .tab-content .tab-pane')) return;
      let commentClass = event.target.classList[1];
      localStorage.setItem('comments_active', commentClass);
    });
  }
</script>

        </div>
          
  
  <div class="toggle sidebar-toggle">
    <span class="toggle-line toggle-line-first"></span>
    <span class="toggle-line toggle-line-middle"></span>
    <span class="toggle-line toggle-line-last"></span>
  </div>

  <aside class="sidebar">
    <div class="sidebar-inner">

      <ul class="sidebar-nav motion-element">
        <li class="sidebar-nav-toc">
          Table of Contents
        </li>
        <li class="sidebar-nav-overview">
          Overview
        </li>
      </ul>

      <!--noindex-->
      <div class="post-toc-wrap sidebar-panel">
      </div>
      <!--/noindex-->

      <div class="site-overview-wrap sidebar-panel">
        <div class="site-author motion-element" itemprop="author" itemscope itemtype="http://schema.org/Person">
    <img class="site-author-image" itemprop="image" alt="EIMadrigal"
      src="/images/favicon.png">
  <p class="site-author-name" itemprop="name">EIMadrigal</p>
  <div class="site-description" itemprop="description">Hello World</div>
</div>
<div class="site-state-wrap motion-element">
  <nav class="site-state">
      <div class="site-state-item site-state-posts">
          <a href="/archives/">
        
          <span class="site-state-item-count">166</span>
          <span class="site-state-item-name">posts</span>
        </a>
      </div>
      <div class="site-state-item site-state-categories">
            <a href="/categories/">
          
        <span class="site-state-item-count">2</span>
        <span class="site-state-item-name">categories</span></a>
      </div>
      <div class="site-state-item site-state-tags">
            <a href="/tags/">
          
        <span class="site-state-item-count">4</span>
        <span class="site-state-item-name">tags</span></a>
      </div>
  </nav>
</div>
  <div class="links-of-author motion-element">
      <span class="links-of-author-item">
        <a href="https://github.com/EIMadrigal" title="GitHub â†’ https:&#x2F;&#x2F;github.com&#x2F;EIMadrigal" rel="noopener" target="_blank"><i class="fab fa-github fa-fw"></i>GitHub</a>
      </span>
      <span class="links-of-author-item">
        <a href="mailto:andrew.renj@gmail.com" title="E-Mail â†’ mailto:andrew.renj@gmail.com" rel="noopener" target="_blank"><i class="fa fa-envelope fa-fw"></i>E-Mail</a>
      </span>
      <span class="links-of-author-item">
        <a href="https://www.cnblogs.com/EIMadrigal" title="cnblogs â†’ https:&#x2F;&#x2F;www.cnblogs.com&#x2F;EIMadrigal" rel="noopener" target="_blank"><i class="fab fa-codiepie fa-fw"></i>cnblogs</a>
      </span>
      <span class="links-of-author-item">
        <a href="https://weibo.com/EIMadrigal" title="Weibo â†’ https:&#x2F;&#x2F;weibo.com&#x2F;EIMadrigal" rel="noopener" target="_blank"><i class="fab fa-weibo fa-fw"></i>Weibo</a>
      </span>
  </div>



      </div>

    </div>
  </aside>
  <div id="sidebar-dimmer"></div>


      </div>
    </main>

    <footer class="footer">
      <div class="footer-inner">
        

        

<div class="copyright">
  
  &copy; 2018-02 â€“ 
  <span itemprop="copyrightYear">2022</span>
  <span class="with-love">
    <i class="fa fa-heart"></i>
  </span>
  <span class="author" itemprop="copyrightHolder">EIMadrigal</span>
</div>
  <div class="powered-by">Powered by <a href="https://hexo.io/" class="theme-link" rel="noopener" target="_blank">Hexo</a> & <a href="https://theme-next.org/" class="theme-link" rel="noopener" target="_blank">NexT.Gemini</a>
  </div>


    <script async src="//dn-lbstatics.qbox.me/busuanzi/2.3/busuanzi.pure.mini.js"></script>

    <span id="busuanzi_container_site_pv">Total views: <span id="busuanzi_value_site_pv"></span></span>
    <span class="post-meta-divider">|</span>
    <span id="busuanzi_container_site_uv">Total visitors: <span id="busuanzi_value_site_uv"></span></span>
    <span class="post-meta-divider">|</span>

<script>
$(document).ready(function() {

    var int = setInterval(fixCount, 50);
    var countOffset = 20000;

    function fixCount() {            
       if (document.getElementById("busuanzi_container_site_pv").style.display != "none")
        {
            $("#busuanzi_value_site_pv").html(parseInt($("#busuanzi_value_site_pv").html()) + countOffset); 
            clearInterval(int);
        }                  
        if ($("#busuanzi_container_site_pv").css("display") != "none")
        {
            $("#busuanzi_value_site_uv").html(parseInt($("#busuanzi_value_site_uv").html()) + countOffset);
            clearInterval(int);
        }  
    }
       	
});
</script> 

        
<div class="busuanzi-count">
  <script async src="https://busuanzi.ibruce.info/busuanzi/2.3/busuanzi.pure.mini.js"></script>
    <span class="post-meta-item" id="busuanzi_container_site_uv" style="display: none;">
      <span class="post-meta-item-icon">
        <i class="fa fa-user"></i>
      </span>
      <span class="site-uv" title="Total Visitors">
        <span id="busuanzi_value_site_uv"></span>
      </span>
    </span>
</div>








      </div>
    </footer>
  </div>

  
  <script src="/lib/anime.min.js"></script>
  <script src="/lib/velocity/velocity.min.js"></script>
  <script src="/lib/velocity/velocity.ui.min.js"></script>

<script src="/js/utils.js"></script>

<script src="/js/motion.js"></script>


<script src="/js/schemes/pisces.js"></script>


<script src="/js/next-boot.js"></script>




  




  
<script src="/js/local-search.js"></script>













  

  
      

<script>
  if (typeof MathJax === 'undefined') {
    window.MathJax = {
      loader: {
        source: {
          '[tex]/amsCd': '[tex]/amscd',
          '[tex]/AMScd': '[tex]/amscd'
        }
      },
      tex: {
        inlineMath: {'[+]': [['$', '$']]},
        tags: 'ams'
      },
      options: {
        renderActions: {
          findScript: [10, doc => {
            document.querySelectorAll('script[type^="math/tex"]').forEach(node => {
              const display = !!node.type.match(/; *mode=display/);
              const math = new doc.options.MathItem(node.textContent, doc.inputJax[0], display);
              const text = document.createTextNode('');
              node.parentNode.replaceChild(text, node);
              math.start = {node: text, delim: '', n: 0};
              math.end = {node: text, delim: '', n: 0};
              doc.math.push(math);
            });
          }, '', false],
          insertedScript: [200, () => {
            document.querySelectorAll('mjx-container').forEach(node => {
              let target = node.parentNode;
              if (target.nodeName.toLowerCase() === 'li') {
                target.parentNode.classList.add('has-jax');
              }
            });
          }, '', false]
        }
      }
    };
    (function () {
      var script = document.createElement('script');
      script.src = '//cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.1/MathJax.js?config=TeX-AMS-MML_HTMLorMML';
      script.defer = true;
      document.head.appendChild(script);
    })();
  } else {
    MathJax.startup.document.state(0);
    MathJax.texReset();
    MathJax.typeset();
  }
</script>

    

  


</body>
</html>
